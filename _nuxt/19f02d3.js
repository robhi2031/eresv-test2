/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{579:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return D}));var r=n(727),o=n(2);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){v(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function C(e,p){return C=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},C(e,p)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k(this,n)}}var R=Symbol("unassigned"),E=null;function T(source){var e=r.a.hooks.getRegistered(),t={};for(var n in Object.assign(t,r.a.DefaultSettings),t)t[n]={default:R};for(var i=0;i<e.length;i++)t[e[i]]={default:R};return t.settings={default:R},"HotTable"===source&&(t.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},t.wrapperRendererCacheSize={type:Number,default:3e3}),t}function A(e){var t={},n=e.settings;if(n!==R)for(var r in n)n.hasOwnProperty(r)&&n[r]!==R&&(t[r]=n[r]);for(var o in e)e.hasOwnProperty(o)&&"settings"!==o&&e[o]!==R&&(t[o]=e[o]);return t}function x(e,t){var n=A(e),r=e.settings?e.settings:n,o=e.settings?n:null,l={};for(var c in r)!r.hasOwnProperty(c)||void 0===r[c]||t&&"data"!==c&&_(t[c],r[c])||(l[c]=r[c]);for(var h in o)!o.hasOwnProperty(h)||"id"===h||"settings"===h||"wrapperRendererCacheSize"===h||void 0===o[h]||t&&"data"!==h&&_(t[h],o[h])||(l[h]=o[h]);return l}function M(e,t){var n=null;return e.every((function(slot,e){return!slot.data||!slot.data.attrs||void 0===slot.data.attrs[t]||(n=slot,!1)})),n}function P(e,t,n,data){var r=t.$el?t.$el.ownerDocument:document,o={propsData:n,parent:t,data:data};E||((E=r.createElement("DIV")).id="vueHotComponents",r.body.appendChild(E));var l=r.createElement("DIV");return E.appendChild(l),new e.componentOptions.Ctor(o).$mount(l)}function _(e,t){return JSON.stringify(e)===JSON.stringify(t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self;var I=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){!function(e){var t=Symbol("newer"),n=Symbol("older");function r(e,t){"number"!=typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}function o(e,r){this.key=e,this.value=r,this[t]=void 0,this[n]=void 0}e.LRUMap=r,r.prototype._markEntryAsUsed=function(e){e!==this.newest&&(e[t]&&(e===this.oldest&&(this.oldest=e[t]),e[t][n]=e[n]),e[n]&&(e[n][t]=e[t]),e[t]=void 0,e[n]=this.newest,this.newest&&(this.newest[t]=e),this.newest=e)},r.prototype.assign=function(e){var r,l=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var c=e[Symbol.iterator](),h=c.next();!h.done;h=c.next()){var f=new o(h.value[0],h.value[1]);if(this._keymap.set(f.key,f),r?(r[t]=f,f[n]=r):this.oldest=f,r=f,0==l--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(e){var t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value},r.prototype.set=function(e,r){var l=this._keymap.get(e);return l?(l.value=r,this._markEntryAsUsed(l),this):(this._keymap.set(e,l=new o(e,r)),this.newest?(this.newest[t]=l,l[n]=this.newest):this.oldest=l,this.newest=l,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var e=this.oldest;if(e)return this.oldest[t]?(this.oldest=this.oldest[t],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),e[t]=e[n]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]},r.prototype.has=function(e){return this._keymap.has(e)}}(t)})),H=I.LRUMap;function j(template,style,script,e,t,n,r,o,l,c){"boolean"!=typeof r&&(l=o,o=r,r=!1);const h="function"==typeof script?script.options:script;let f;if(template&&template.render&&(h.render=template.render,h.staticRenderFns=template.staticRenderFns,h._compiled=!0,t&&(h.functional=!0)),e&&(h._scopeId=e),n?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),style&&style.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},h._ssrRegister=f):style&&(f=r?function(e){style.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){style.call(this,o(e))}),f)if(h.functional){const e=h.render;h.render=function(t,n){return f.call(n),e(t,n)}}else{const e=h.beforeCreate;h.beforeCreate=e?[].concat(e,f):[f]}return script}var D=j({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{attrs:{id:e.id}},[e._t("default")],2)},staticRenderFns:[]},undefined,{name:"HotTable",props:T("HotTable"),watch:{mergedHotSettings:function(e){this.hotInstance&&void 0!==e&&(e.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete e.data),Object.keys(e).length?this.hotInstance.updateSettings(e):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var e=this,t=new H(this.wrapperRendererCacheSize);return t.shift=function(){var e=H.prototype.shift.call(this);return e[1].component.$destroy(),e},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:t,editorCache:new Map,get hotInstance(){return!e.__hotInstance||e.__hotInstance&&!e.__hotInstance.isDestroyed?e.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(t){e.__hotInstance=t}}},computed:{mergedHotSettings:function(){return x(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var component,e=this.getGlobalRendererVNode(),t=this.getGlobalEditorVNode(),n=x(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,t&&(n.editor=this.getEditorClass(t,this),t.child.$destroy()),e&&(n.renderer=this.getRendererWrapper(e,this),e.child.$destroy()),this.hotInstance=new r.a.Core(this.$el,n),this.hotInstance.init(),(component=this).hotInstance&&(component.hotInstance.addHook("beforeChange",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeCreateCol",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveRow",(function(){component.__internalEdit=!0})),component.hotInstance.addHook("beforeRemoveCol",(function(){component.__internalEdit=!0}))),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t,data=this.hotInstance.getSourceData(),n=[],r=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),l=this.hotInstance.isColumnModificationAllowed(),c=0;if(data&&data.length!==o&&data.length<o)for(var h=data.length;h<o;h++)n.push(h);if(l)if(c=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),data&&data[0]&&(null===(t=data[0])||void 0===t?void 0:t.length)!==c&&data[0].length<c)for(var f=data[0].length;f<c;f++)r.push(f);this.hotInstance.batch((function(){n.length>0?e.hotInstance.rowIndexMapper.removeIndexes(n):e.hotInstance.rowIndexMapper.insertIndexes(o-1,data.length-o),l&&0!==data.length&&(r.length>0?e.hotInstance.columnIndexMapper.removeIndexes(r):e.hotInstance.columnIndexMapper.insertIndexes(c-1,data[0].length-c))}))}},getGlobalRendererVNode:function(){return M(this.$slots.default||[],"hot-renderer")},getGlobalEditorVNode:function(){return M(this.$slots.default||[],"hot-editor")},getColumnSettings:function(){var e=this.$children.filter((function(e){return"HotColumn"===e.$options.name})),t=!1,n=e.map((function(e){return e.usesRendererComponent&&(t=!0),c({},e.columnSettings)}));return t&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(e,t){var n=this;return function(r,o,l,col,c,h,f){if(o&&!o.getAttribute("ghost-table")){var d=n.rendererCache,y={hotInstance:r,TD:o,row:l,col:col,prop:c,value:h,cellProperties:f,isRenderer:!0};if(d&&!d.has("".concat(l,"-").concat(col))){var v=P(e,t,e.componentOptions.propsData,y);d.set("".concat(l,"-").concat(col),{component:v,lastUsedTD:null})}var m=d.get("".concat(l,"-").concat(col)),w=m.component,C=m.lastUsedTD;if(Object.assign(w.$data,y),!w.$el.parentElement||C!==o){for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(w.$el),m.lastUsedTD=o}}return o}},getEditorClass:function(e,t){var n=e.key?e.key.toString():null,r=e.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,l=this.editorCache,c=null;return l.has(o)?c=l.get(o):(c=P(e,t,e.componentOptions.propsData,{isEditor:!0}),l.set(o,c)),c.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:"10.0.0"},undefined,false,undefined,!1,void 0,void 0,void 0);T("HotColumn");function N(e){return N="function"==typeof Symbol&&"symbol"===h(Symbol.iterator)?function(e){return h(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":h(e)},N(e)}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){return function(e){if(Array.isArray(e)){for(var i=0,t=new Array(e.length);i<e.length;i++)t[i]=e[i];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function V(){return"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function F(e,t){W(e,t),Object.getOwnPropertyNames(t.prototype).forEach((function(n){W(e.prototype,t.prototype,n)})),Object.getOwnPropertyNames(t).forEach((function(n){W(e,t,n)}))}function W(e,t,n){(n?Reflect.getOwnMetadataKeys(t,n):Reflect.getOwnMetadataKeys(t)).forEach((function(r){var o=n?Reflect.getOwnMetadata(r,t,n):Reflect.getOwnMetadata(r,t);n?Reflect.defineMetadata(r,o,e,n):Reflect.defineMetadata(r,o,e)}))}var U={__proto__:[]}instanceof Array;function z(e,t){var n=t.prototype._init;t.prototype._init=function(){var t=this,n=Object.getOwnPropertyNames(e);if(e.$options.props)for(var r in e.$options.props)e.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){e[n]=t},configurable:!0})}))};var data=new t;t.prototype._init=n;var r={};return Object.keys(data).forEach((function(e){void 0!==data[e]&&(r[e]=data[e])})),r}var G=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.name=t.name||e._componentTag||e.name;var n=e.prototype;Object.getOwnPropertyNames(n).forEach((function(e){if("constructor"!==e)if(G.indexOf(e)>-1)t[e]=n[e];else{var r=Object.getOwnPropertyDescriptor(n,e);void 0!==r.value?"function"==typeof r.value?(t.methods||(t.methods={}))[e]=r.value:(t.mixins||(t.mixins=[])).push({data:function(){return L({},e,r.value)}}):(r.get||r.set)&&((t.computed||(t.computed={}))[e]={get:r.get,set:r.set})}})),(t.mixins||(t.mixins=[])).push({data:function(){return z(this,e)}});var r=e.__decorators__;r&&(r.forEach((function(e){return e(t)})),delete e.__decorators__);var l=Object.getPrototypeOf(e.prototype),c=l instanceof o.a?l.constructor:o.a,h=c.extend(t);return X(h,e,c),V()&&F(h,e),h}var K={prototype:!0,arguments:!0,callee:!0,caller:!0};function X(e,t,n){Object.getOwnPropertyNames(t).forEach((function(r){if(!K[r]){var o=Object.getOwnPropertyDescriptor(e,r);if(!o||o.configurable){var l,c,h=Object.getOwnPropertyDescriptor(t,r);if(!U){if("cid"===r)return;var f=Object.getOwnPropertyDescriptor(n,r);if(l=h.value,c=N(l),null!=l&&("object"===c||"function"===c)&&f&&f.value===h.value)return}Object.defineProperty(e,r,h)}}}))}function $(e){return"function"==typeof e?Y(e):function(t){return Y(t,e)}}$.registerHooks=function(e){G.push.apply(G,B(e))};var Q=function(e){m(n,e);var t=O(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).name="BaseEditorComponent",e.instance=null,e.row=null,e.col=null,e.prop=null,e.TD=null,e.originalValue=null,e.cellProperties=null,e.state=null,e.hot=null,e}return y(n,[{key:"mounted",value:function(){var e,t=this;this.$data.hotCustomEditorClass=(e=function(e){m(r,e);var n=O(r);function r(e,o,col,l,c,h){var d;return f(this,r),d=n.call(this,e,o,col,l,c,h),t.$data.hotCustomEditorInstance=S(d),d}return y(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(r.a.editors.BaseEditor),Object.getOwnPropertyNames(r.a.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(e.prototype[n]=function(){for(var e,r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t[n]).call.apply(e,[this].concat(o))})})),e)}},{key:"_fireCallbacks",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];(e=r.a.editors.BaseEditor.prototype._fireCallbacks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.beginEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.cancelChanges).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.checkEditorSection).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.close).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.discardEditor).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.enableFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.extend).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.finishEditing).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.focus).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.init).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.isInFullEditMode).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.isOpened).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.isWaiting).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.open).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(e,col,t,n,o,l){return this.$data.hotInstance=l.instance,this.$data.row=e,this.$data.col=col,this.$data.prop=t,this.$data.TD=n,this.$data.originalValue=o,this.$data.cellProperties=l,r.a.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,e,col,t,n,o,l)}},{key:"saveValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.saveValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.setValue).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.addHook).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.removeHooksByKey).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.clearHooks).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getEditedCell).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.a.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(e,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(o.a);Q=function(e,t,n,desc){var r,o=arguments.length,l=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,n,l):r(t,n))||l);return o>3&&l&&Object.defineProperty(t,n,l),l}([$({})],Q)}).call(this,n(77))},582:function(e,t,n){var content=n(912);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(17).default)("73309d30",content,!0,{sourceMap:!1})},727:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"requestAnimationFrame",(function(){return H})),n.d(r,"isClassListSupported",(function(){return j})),n.d(r,"isTextContentSupported",(function(){return D})),n.d(r,"isGetComputedStyleSupported",(function(){return N})),n.d(r,"cancelAnimationFrame",(function(){return L})),n.d(r,"isTouchSupported",(function(){return B})),n.d(r,"hasCaptionProblem",(function(){return V})),n.d(r,"getComparisonFunction",(function(){return F})),n.d(r,"isPassiveEventSupported",(function(){return W}));var o={};n.r(o),n.d(o,"to2dArray",(function(){return U})),n.d(o,"extendArray",(function(){return z})),n.d(o,"pivot",(function(){return G})),n.d(o,"arrayReduce",(function(){return Y})),n.d(o,"arrayFilter",(function(){return K})),n.d(o,"arrayMap",(function(){return X})),n.d(o,"arrayEach",(function(){return $})),n.d(o,"arraySum",(function(){return Q})),n.d(o,"arrayMax",(function(){return J})),n.d(o,"arrayMin",(function(){return Z})),n.d(o,"arrayAvg",(function(){return ee})),n.d(o,"arrayFlatten",(function(){return te})),n.d(o,"arrayUnique",(function(){return ne})),n.d(o,"getDifferenceOfArrays",(function(){return re})),n.d(o,"getIntersectionOfArrays",(function(){return oe})),n.d(o,"getUnionOfArrays",(function(){return ie})),n.d(o,"stringToArray",(function(){return ae}));var l={};n.r(l),n.d(l,"duckSchema",(function(){return ue})),n.d(l,"inherit",(function(){return ce})),n.d(l,"extend",(function(){return he})),n.d(l,"deepExtend",(function(){return fe})),n.d(l,"deepClone",(function(){return de})),n.d(l,"clone",(function(){return pe})),n.d(l,"mixin",(function(){return ye})),n.d(l,"isObjectEqual",(function(){return ge})),n.d(l,"isObject",(function(){return ve})),n.d(l,"defineGetter",(function(){return me})),n.d(l,"objectEach",(function(){return be})),n.d(l,"getProperty",(function(){return we})),n.d(l,"setProperty",(function(){return Ce})),n.d(l,"deepObjectSize",(function(){return Se})),n.d(l,"createObjectPropListener",(function(){return ke})),n.d(l,"hasOwnProperty",(function(){return Oe}));var c={};n.r(c),n.d(c,"setBrowserMeta",(function(){return Ae})),n.d(c,"setPlatformMeta",(function(){return xe})),n.d(c,"isChrome",(function(){return Me})),n.d(c,"isChromeWebKit",(function(){return Pe})),n.d(c,"isFirefox",(function(){return _e})),n.d(c,"isFirefoxWebKit",(function(){return Ie})),n.d(c,"isSafari",(function(){return He})),n.d(c,"isEdge",(function(){return je})),n.d(c,"isEdgeWebKit",(function(){return De})),n.d(c,"isIE",(function(){return Ne})),n.d(c,"isIE9",(function(){return Le})),n.d(c,"isMSBrowser",(function(){return Be})),n.d(c,"isMobileBrowser",(function(){return Ve})),n.d(c,"isIOS",(function(){return Fe})),n.d(c,"isIpadOS",(function(){return We})),n.d(c,"isWindowsOS",(function(){return Ue})),n.d(c,"isMacOS",(function(){return ze})),n.d(c,"isLinuxOS",(function(){return Ge}));var h={};n.r(h),n.d(h,"stringify",(function(){return ot})),n.d(h,"isDefined",(function(){return it})),n.d(h,"isUndefined",(function(){return at})),n.d(h,"isEmpty",(function(){return lt})),n.d(h,"isRegExp",(function(){return st})),n.d(h,"_injectProductInfo",(function(){return St}));var f={};n.r(f),n.d(f,"toUpperCaseFirst",(function(){return kt})),n.d(f,"equalsIgnoreCase",(function(){return Ot})),n.d(f,"randomString",(function(){return Rt})),n.d(f,"isPercentValue",(function(){return Et})),n.d(f,"substitute",(function(){return Tt})),n.d(f,"stripTags",(function(){return At})),n.d(f,"sanitize",(function(){return xt}));var d={};n.r(d),n.d(d,"getParent",(function(){return _t})),n.d(d,"getFrameElement",(function(){return It})),n.d(d,"getParentWindow",(function(){return Ht})),n.d(d,"hasAccessToParentWindow",(function(){return jt})),n.d(d,"closest",(function(){return Dt})),n.d(d,"closestDown",(function(){return Nt})),n.d(d,"isChildOf",(function(){return Lt})),n.d(d,"index",(function(){return Bt})),n.d(d,"overlayContainsElement",(function(){return Vt})),n.d(d,"hasClass",(function(){return zt})),n.d(d,"addClass",(function(){return Gt})),n.d(d,"removeClass",(function(){return Yt})),n.d(d,"removeTextNodes",(function(){return Kt})),n.d(d,"empty",(function(){return Xt})),n.d(d,"HTML_CHARACTERS",(function(){return qt})),n.d(d,"fastInnerHTML",(function(){return Qt})),n.d(d,"fastInnerText",(function(){return Jt})),n.d(d,"isVisible",(function(){return Zt})),n.d(d,"offset",(function(){return en})),n.d(d,"getWindowScrollTop",(function(){return tn})),n.d(d,"getWindowScrollLeft",(function(){return nn})),n.d(d,"getScrollTop",(function(){return rn})),n.d(d,"getScrollLeft",(function(){return on})),n.d(d,"getScrollableElement",(function(){return an})),n.d(d,"getTrimmingContainer",(function(){return ln})),n.d(d,"getStyle",(function(){return sn})),n.d(d,"matchesCSSRules",(function(){return un})),n.d(d,"getComputedStyle",(function(){return cn})),n.d(d,"outerWidth",(function(){return hn})),n.d(d,"outerHeight",(function(){return fn})),n.d(d,"innerHeight",(function(){return dn})),n.d(d,"innerWidth",(function(){return pn})),n.d(d,"addEvent",(function(){return yn})),n.d(d,"removeEvent",(function(){return gn})),n.d(d,"getCaretPosition",(function(){return vn})),n.d(d,"getSelectionEndPosition",(function(){return mn})),n.d(d,"getSelectionText",(function(){return bn})),n.d(d,"clearTextSelection",(function(){return wn})),n.d(d,"setCaretPosition",(function(){return Cn})),n.d(d,"getScrollbarWidth",(function(){return kn})),n.d(d,"hasVerticalScrollbar",(function(){return On})),n.d(d,"hasHorizontalScrollbar",(function(){return Rn})),n.d(d,"setOverlayPosition",(function(){return En})),n.d(d,"getCssTransform",(function(){return Tn})),n.d(d,"resetCssTransform",(function(){return An})),n.d(d,"isInput",(function(){return xn})),n.d(d,"isOutsideInput",(function(){return Mn})),n.d(d,"selectElementIfAllowed",(function(){return Pn})),n.d(d,"isDetached",(function(){return _n}));var y={};n.r(y),n.d(y,"isFunction",(function(){return In})),n.d(y,"throttle",(function(){return Hn})),n.d(y,"throttleAfterHits",(function(){return jn})),n.d(y,"debounce",(function(){return Dn})),n.d(y,"pipe",(function(){return Nn})),n.d(y,"partial",(function(){return Ln})),n.d(y,"curry",(function(){return Bn})),n.d(y,"curryRight",(function(){return Vn})),n.d(y,"fastCall",(function(){return Fn}));var v={};n.r(v),n.d(v,"KEY_CODES",(function(){return Un})),n.d(v,"isPrintableChar",(function(){return Gn})),n.d(v,"isFunctionKey",(function(){return Yn})),n.d(v,"isCtrlKey",(function(){return Kn})),n.d(v,"isCtrlMetaKey",(function(){return Xn})),n.d(v,"isKey",(function(){return $n}));var m={};n.r(m),n.d(m,"stopImmediatePropagation",(function(){return qn})),n.d(m,"isImmediatePropagationStopped",(function(){return Qn})),n.d(m,"isRightClick",(function(){return Jn})),n.d(m,"isLeftClick",(function(){return Zn}));var w={};n.r(w),n.d(w,"instanceToHTML",(function(){return Xr})),n.d(w,"_dataToHTML",(function(){return $r})),n.d(w,"htmlToGridSettings",(function(){return qr}));var C={};n.r(C),n.d(C,"isNumeric",(function(){return eo})),n.d(C,"isNumericLike",(function(){return to})),n.d(C,"rangeEach",(function(){return no})),n.d(C,"rangeEachReverse",(function(){return ro})),n.d(C,"valueAccordingPercent",(function(){return oo}));var S={};n.r(S),n.d(S,"spreadsheetColumnLabel",(function(){return yc})),n.d(S,"spreadsheetColumnIndex",(function(){return gc})),n.d(S,"createSpreadsheetData",(function(){return vc})),n.d(S,"createSpreadsheetObjectData",(function(){return mc})),n.d(S,"createEmptySpreadsheetData",(function(){return bc})),n.d(S,"cellMethodLookupFactory",(function(){return wc})),n.d(S,"dataRowToChangesArray",(function(){return Cc})),n.d(S,"countFirstRowKeys",(function(){return Sc})),n.d(S,"isArrayOfArrays",(function(){return kc})),n.d(S,"isArrayOfObjects",(function(){return Oc}));var k={};n.r(k),n.d(k,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return Af})),n.d(k,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return xf})),n.d(k,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return Mf})),n.d(k,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return Pf})),n.d(k,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return _f})),n.d(k,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return If})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return Hf})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return jf})),n.d(k,"CONTEXTMENU_ITEMS_UNDO",(function(){return Df})),n.d(k,"CONTEXTMENU_ITEMS_REDO",(function(){return Nf})),n.d(k,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return Lf})),n.d(k,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return Bf})),n.d(k,"CONTEXTMENU_ITEMS_COPY",(function(){return Vf})),n.d(k,"CONTEXTMENU_ITEMS_CUT",(function(){return Ff})),n.d(k,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return Wf})),n.d(k,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return Uf})),n.d(k,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return zf})),n.d(k,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return Gf})),n.d(k,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return Yf})),n.d(k,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return Kf})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return Xf})),n.d(k,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return $f})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return qf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return Qf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return Jf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return Zf})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return ed})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return nd})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return rd})),n.d(k,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return od})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS",(function(){return id})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return ad})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return ld})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return sd})),n.d(k,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return ud})),n.d(k,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return cd})),n.d(k,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return hd})),n.d(k,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return fd})),n.d(k,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return pd})),n.d(k,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return yd})),n.d(k,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return gd})),n.d(k,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return vd})),n.d(k,"FILTERS_NAMESPACE",(function(){return md})),n.d(k,"FILTERS_CONDITIONS_NAMESPACE",(function(){return bd})),n.d(k,"FILTERS_CONDITIONS_NONE",(function(){return wd})),n.d(k,"FILTERS_CONDITIONS_EMPTY",(function(){return Cd})),n.d(k,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return Sd})),n.d(k,"FILTERS_CONDITIONS_EQUAL",(function(){return kd})),n.d(k,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return Od})),n.d(k,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return Rd})),n.d(k,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return Ed})),n.d(k,"FILTERS_CONDITIONS_CONTAINS",(function(){return Td})),n.d(k,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return Ad})),n.d(k,"FILTERS_CONDITIONS_BY_VALUE",(function(){return xd})),n.d(k,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return Md})),n.d(k,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return Pd})),n.d(k,"FILTERS_CONDITIONS_LESS_THAN",(function(){return _d})),n.d(k,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return Id})),n.d(k,"FILTERS_CONDITIONS_BETWEEN",(function(){return Hd})),n.d(k,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return jd})),n.d(k,"FILTERS_CONDITIONS_AFTER",(function(){return Dd})),n.d(k,"FILTERS_CONDITIONS_BEFORE",(function(){return Nd})),n.d(k,"FILTERS_CONDITIONS_TODAY",(function(){return Ld})),n.d(k,"FILTERS_CONDITIONS_TOMORROW",(function(){return Bd})),n.d(k,"FILTERS_CONDITIONS_YESTERDAY",(function(){return Vd})),n.d(k,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return Fd})),n.d(k,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return Wd})),n.d(k,"FILTERS_LABELS_CONJUNCTION",(function(){return Ud})),n.d(k,"FILTERS_LABELS_DISJUNCTION",(function(){return zd})),n.d(k,"FILTERS_VALUES_BLANK_CELLS",(function(){return Gd})),n.d(k,"FILTERS_BUTTONS_SELECT_ALL",(function(){return Yd})),n.d(k,"FILTERS_BUTTONS_CLEAR",(function(){return Kd})),n.d(k,"FILTERS_BUTTONS_OK",(function(){return Xd})),n.d(k,"FILTERS_BUTTONS_CANCEL",(function(){return $d})),n.d(k,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return qd})),n.d(k,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return Qd})),n.d(k,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return Jd}));var O={};n.r(O),n.d(O,"getNormalizedDate",(function(){return Gb}));n(853),n(513),n(572),n(525),n(548),n(549),n(493),n(505),n(645),n(541),n(492),n(553),n(497),n(483),n(502),n(676),n(481),n(514),n(539),n(899),n(482),n(520),n(484),n(485),n(486),n(487),n(498),n(494),n(519),n(517),n(547),n(614),n(569),n(554),n(613);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}for(var E,T,A,x=0,M=["ms","moz","webkit","o"],P=window.requestAnimationFrame,_=window.cancelAnimationFrame,I=0;I<M.length&&!P;++I)P=window["".concat(M[I],"RequestAnimationFrame")],_=window["".concat(M[I],"CancelAnimationFrame")]||window["".concat(M[I],"CancelRequestAnimationFrame")];function H(e){return P.call(window,e)}function j(){return!!document.documentElement.classList}function D(){return!!document.createTextNode("test").textContent}function N(){return!!window.getComputedStyle}function L(e){_.call(window,e)}function B(){return"ontouchstart"in window}function V(){return void 0===E&&function(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),E=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}(),E}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return T||(T="object"===("undefined"==typeof Intl?"undefined":R(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(a,b){return"".concat(a).localeCompare(b)}:function(a,b){return a===b?0:a>b?-1:1})}function W(){if(void 0!==A)return A;try{var e={get passive(){A=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){A=!1}return A}P||(P=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-x)),r=window.setTimeout((function(){e(t+n)}),n);return x=t+n,r}),_||(_=function(e){clearTimeout(e)});n(536);function U(e){for(var t=e.length,i=0;i<t;)e[i]=[e[i]],i+=1}function z(e,t){for(var n=t.length,i=0;i<n;)e.push(t[i]),i+=1}function G(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,i=0;i<n;i++)for(var o=0;o<r;o++)t[o]||(t[o]=[]),t[o][i]=e[i][o];return t}function Y(e,t,n,r){var o=-1,l=e,c=n;Array.isArray(e)||(l=Array.from(e));var h=l.length;for(r&&h&&(c=l[o+=1]),o+=1;o<h;)c=t(c,l[o],o,l),o+=1;return c}function K(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,l=[],c=-1;n<o;){var h=r[n];t(h,n,r)&&(l[c+=1]=h),n+=1}return l}function X(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,l=[],c=-1;n<o;){var h=r[n];l[c+=1]=t(h,n,r),n+=1}return l}function $(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length;n<o&&!1!==t(r[n],n,r);)n+=1;return e}function Q(e){return Y(e,(function(a,b){return a+b}),0)}function J(e){return Y(e,(function(a,b){return a>b?a:b}),Array.isArray(e)?e[0]:void 0)}function Z(e){return Y(e,(function(a,b){return a<b?a:b}),Array.isArray(e)?e[0]:void 0)}function ee(e){return e.length?Q(e)/e.length:0}function te(e){return Y(e,(function(e,t){return e.concat(Array.isArray(t)?te(t):t)}),[])}function ne(e){var t=[];return $(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function re(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],l=r.slice(1),c=o;return $(l,(function(e){c=c.filter((function(t){return!e.includes(t)}))})),c}function oe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],l=r.slice(1),c=o;return $(l,(function(e){c=c.filter((function(t){return e.includes(t)}))})),c}function ie(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],l=r.slice(1),c=new Set(o);return $(l,(function(e){$(e,(function(e){c.has(e)||c.add(e)}))})),Array.from(c)}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function ue(object){var e;return Array.isArray(object)?e=[]:(e={},be(object,(function(t,n){"__children"!==n&&(t&&"object"===se(t)&&!Array.isArray(t)?e[n]=ue(t):Array.isArray(t)?t.length&&"object"===se(t[0])&&!Array.isArray(t[0])?e[n]=[ue(t[0])]:e[n]=[]:e[n]=null)}))),e}function ce(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function he(e,t,n){var r=Array.isArray(n);return be(t,(function(t,o){(!1===r||n.includes(o))&&(e[o]=t)})),e}function fe(e,t){be(t,(function(n,r){t[r]&&"object"===se(t[r])?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),fe(e[r],t[r])):e[r]=t[r]}))}function de(e){return"object"===se(e)?JSON.parse(JSON.stringify(e)):e}function pe(object){var e={};return be(object,(function(t,n){e[n]=t})),e}function ye(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return $(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),be(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof t)e.prototype[n]=t;else{Object.defineProperty(e.prototype,n,{get:(r=n,o=t,l="_".concat(r),function(){var e;return void 0===this[l]&&(this[l]=(e=o,(Array.isArray(e)||ve(e))&&(e=de(e)),e)),this[l]}),set:function(e){var t="_".concat(e);return function(e){this[t]=e}}(n),configurable:!0})}var r,o,l}))})),e}function ge(e,t){return JSON.stringify(e)===JSON.stringify(t)}function ve(object){return"[object Object]"===Object.prototype.toString.call(object)}function me(object,e,t,n){n.value=t,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(object,e,n)}function be(object,e){for(var t in object)if((!object.hasOwnProperty||object.hasOwnProperty&&Object.prototype.hasOwnProperty.call(object,t))&&!1===e(object[t],t,object))break;return object}function we(object,e){var t=e.split("."),n=object;return be(t,(function(e){if(void 0===(n=n[e]))return n=void 0,!1})),n}function Ce(object,e,t){var n=e.split("."),r=object;n.forEach((function(e,o){o!==n.length-1?(Oe(r,e)||(r[e]={}),r=r[e]):r[e]=t}))}function Se(object){if(!ve(object))return 0;return function e(t){var n=0;return ve(t)?be(t,(function(t,r){"__children"!==r&&(n+=e(t))})):n+=1,n}(object)}function ke(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),o=(le(t={_touched:!1},r,e),le(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(o,n,{get:function(){return this[r]},set:function(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),o}function Oe(object,e){return Object.prototype.hasOwnProperty.call(object,e)}var Re=function(e){var t={value:!1,test:function(n,r){t.value=e(n,r)}};return t},Ee={chrome:Re((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),chromeWebKit:Re((function(e){return/CriOS/.test(e)})),edge:Re((function(e){return/Edge/.test(e)})),edgeWebKit:Re((function(e){return/EdgiOS/.test(e)})),firefox:Re((function(e){return/Firefox/.test(e)})),firefoxWebKit:Re((function(e){return/FxiOS/.test(e)})),ie:Re((function(e){return/Trident/.test(e)})),ie9:Re((function(){return!!document.documentMode})),mobile:Re((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:Re((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},Te={mac:Re((function(e){return/^Mac/.test(e)})),win:Re((function(e){return/^Win/.test(e)})),linux:Re((function(e){return/^Linux/.test(e)})),ios:Re((function(e){return/iPhone|iPad|iPod/i.test(e)}))};function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,r=e.vendor,o=void 0===r?navigator.vendor:r;be(Ee,(function(e){(0,e.test)(n,o)}))}function xe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;be(Te,(function(e){(0,e.test)(n)}))}function Me(){return Ee.chrome.value}function Pe(){return Ee.chromeWebKit.value}function _e(){return Ee.firefox.value}function Ie(){return Ee.firefoxWebKit.value}function He(){return Ee.safari.value}function je(){return Ee.edge.value}function De(){return Ee.edgeWebKit.value}function Ne(){return Ee.ie.value}function Le(){return Ee.ie9.value}function Be(){return Ee.ie.value||Ee.edge.value}function Ve(){return Ee.mobile.value}function Fe(){return Te.ios.value}function We(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,t=e.maxTouchPoints;return t>2&&Te.mac.value}function Ue(){return Te.win.value}function ze(){return Te.mac.value}function Ge(){return Te.linux.value}Ae(),xe();var Ye,Ke,Xe,$e,qe,Qe,Je=n(880),Ze=(n(538),n(877),n(780),n(185));function et(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Y(e,(function(e,t,r){return e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")}),"");return o.trim()}function tt(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function ot(e){var t;switch(nt(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function it(e){return void 0!==e}function at(e){return void 0===e}function lt(e){return null===e||""===e||at(e)}function st(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var ut,ct,ht,ft="length",pt=function(e){return parseInt(e,16)},yt=function(e){return parseInt(e,10)},gt=function(e,s,t){return e.substr(s,t)},vt=function(e){return e.codePointAt(0)-65},mt=function(e){return"".concat(e).replace(/\-/g,"")},bt=!1,wt={invalid:function(){return et(Ye||(Ye=tt(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return et(Ke||(Ke=tt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:function(){return et(Xe||(Xe=tt(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},Ct={invalid:function(){return et($e||($e=tt(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return et(qe||(qe=tt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:function(){return et(Qe||(Qe=tt(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function St(e,element){var t,n,r=!lt(e),o="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),l="12.0.1",c="invalid",h="invalid",f=function(e){var t=[][ft],p=t;if(e[ft]!==vt("Z"))return!1;for(var n="",i="B<H4P+".split(""),r=vt(i.shift());r;r=vt(i.shift()||"A"))--r<""[ft]?p|=(yt("".concat(yt(pt(n)+(pt(gt(e,Math.abs(r),2))+[]).padStart(2,"0"))))%97||2)>>1:n=gt(e,r,r?1===i[ft]?9:8:6);return p===t}(e=mt(e||""));if(r||o||f)if(f){var d=Ze("16/05/2022","DD/MM/YYYY"),y=Math.floor(d.toDate().getTime()/864e5),v=pt(gt(mt(n=e),pt("12"),vt("F")))/(pt(gt(mt(n),vt("B"),~~![][ft]))||9);if(t=Ze(864e5*(v+1),"x").format("MMMM DD, YYYY"),y>v){var m=Ze().diff(d,"days");c=m<=1?"valid":"expired",h=m<=15?"valid":"expired"}else c="valid",h="valid"}else o?(c="non_commercial",h="valid"):(c="invalid",h="invalid");else c="missing",h="missing";("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(c="valid",h="valid"),bt||"valid"===c)||(wt[c]({keyValidityDate:t,hotVersion:l})&&console["non_commercial"===c?"info":"warn"](wt[c]({keyValidityDate:t,hotVersion:l})),bt=!0);if("valid"!==h&&element.parentNode&&Ct[h]({keyValidityDate:t,hotVersion:l})){var w=document.createElement("div");w.id="hot-display-license-info",w.innerHTML=Ct[h]({keyValidityDate:t,hotVersion:l}),element.parentNode.insertBefore(w,element.nextSibling)}}function kt(e){return e[0].toUpperCase()+e.substr(1)}function Ot(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=n.length;o;){var l=ot(n[o-=1]).toLowerCase();-1===e.indexOf(l)&&e.push(l)}return 1===e.length}function Rt(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function Et(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function Tt(template){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(template).replace(/(?:\\)?\[([^[\]]+)]/g,(function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]}))}function At(e){return xt("".concat(e),{ALLOWED_TAGS:[]})}function xt(e,t){return Je.sanitize(e,t)}function Mt(e){return function(e){if(Array.isArray(e))return Pt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _t(element){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=-1,n=null,r=element;null!==r;){if(t===e){n=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(t+=1,r=r.parentNode)}return n}function It(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function Ht(e){return It(e)&&e.parent}function jt(e){return!!Object.getPrototypeOf(e.parent)}function Dt(element){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,n=Node,r=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,l=element;null!=l&&l!==t;){var c=l,h=c.nodeType,f=c.nodeName;if(h===r&&(e.includes(f)||e.includes(l)))return l;var d=l,y=d.host;l=y&&h===o?y:l.parentNode}return null}function Nt(element,e,t){for(var n=[],r=element;r&&(r=Dt(r,e,t))&&(!t||t.contains(r));)n.push(r),r=r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r.parentNode;var o=n.length;return o?n[o-1]:null}function Lt(e,t){var n=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Bt(element){var i=0,e=element;if(e.previousSibling)for(;e=e.previousSibling;)i+=1;return i}function Vt(e,element,t){var n=t.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(element):null}function Ft(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(j()){var Wt=function(e){var element=e.createElement("div");return element.classList.add("test","test2"),element.classList.contains("test2")};ut=function(element,e){return void 0!==element.classList&&"string"==typeof e&&""!==e&&element.classList.contains(e)},ct=function(element,e){var t,n=element.ownerDocument,r=e;if("string"==typeof r&&(r=r.split(" ")),(r=Ft(r)).length>0)if(Wt(n))(t=element.classList).add.apply(t,Mt(r));else for(var o=0;r[o];)element.classList.add(r[o]),o+=1},ht=function(element,e){var t,n=element.ownerDocument,r=e;if("string"==typeof r&&(r=r.split(" ")),(r=Ft(r)).length>0)if(Wt(n))(t=element.classList).remove.apply(t,Mt(r));else for(var o=0;r[o];)element.classList.remove(r[o]),o+=1}}else{var Ut=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};ut=function(element,e){return void 0!==element.className&&Ut(e).test(element.className)},ct=function(element,e){var t=element.className,n=e;if("string"==typeof n&&(n=n.split(" ")),n=Ft(n),""===t)t=n.join(" ");else for(var r=0;r<n.length;r++)n[r]&&!Ut(n[r]).test(t)&&(t+=" ".concat(n[r]));element.className=t},ht=function(element,e){var t=0,n=element.className,r=e;for("string"==typeof r&&(r=r.split(" ")),r=Ft(r);r[t];)n=n.replace(Ut(r[t])," ").trim(),t+=1;element.className!==n&&(element.className=n)}}function zt(element,e){return ut(element,e)}function Gt(element,e){ct(element,e)}function Yt(element,e){ht(element,e)}function Kt(element){if(3===element.nodeType)element.parentNode.removeChild(element);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(element.nodeName)>-1)for(var e=element.childNodes,i=e.length-1;i>=0;i--)Kt(e[i])}function Xt(element){for(var e;e=element.lastChild;)element.removeChild(e)}var $t,qt=/(<(.*)>|&(.*);)/;function Qt(element,content){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];qt.test(content)?element.innerHTML=e?xt(content):content:Jt(element,content)}function Jt(element,content){var e=element.firstChild;e&&3===e.nodeType&&null===e.nextSibling?D?e.textContent=content:e.data=content:(Xt(element),element.appendChild(element.ownerDocument.createTextNode(content)))}function Zt(element){for(var e=element.ownerDocument.documentElement,t=element;t!==e;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return Zt(t.host.impl);if(t.host)return Zt(t.host);throw new Error("Lost in Web Components world")}return!1}if(t.style&&"none"===t.style.display)return!1;t=t.parentNode}return!0}function en(element){var e,t,n,r,o=element.ownerDocument,l=o.defaultView,c=o.documentElement,h=element;if(V()&&h.firstChild&&"CAPTION"===h.firstChild.nodeName)return{top:(r=h.getBoundingClientRect()).top+(l.pageYOffset||c.scrollTop)-(c.clientTop||0),left:r.left+(l.pageXOffset||c.scrollLeft)-(c.clientLeft||0)};for(e=h.offsetLeft,t=h.offsetTop,n=h;(h=h.offsetParent)&&h!==o.body;)e+=h.offsetLeft,t+=h.offsetTop,n=h;return n&&"fixed"===n.style.position&&(e+=l.pageXOffset||c.scrollLeft,t+=l.pageYOffset||c.scrollTop),{left:e,top:t}}function tn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function nn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function rn(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===e?tn(e):element.scrollTop}function on(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element===e?nn(e):element.scrollLeft}function an(element){var e=element.ownerDocument,t=e?e.defaultView:void 0;e||(t=(e=element.document?element.document:element).defaultView);for(var n=["auto","scroll"],r=N(),o=element.parentNode;o&&o.style&&e.body!==o;){var l=o.style,c=l.overflow,h=l.overflowX,f=l.overflowY;if([c,h,f].includes("scroll"))return o;if(r){var d=t.getComputedStyle(o);if(c=d.overflow,h=d.overflowX,f=d.overflowY,n.includes(c)||n.includes(h)||n.includes(f))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(f)||n.includes(c)))return o;if(o.clientWidth<=o.scrollWidth+1&&(n.includes(h)||n.includes(c)))return o;o=o.parentNode}return t}function ln(base){for(var e=base.ownerDocument,t=e.defaultView,n=base.parentNode;n&&n.style&&e.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var r=cn(n,t),o=["scroll","hidden","auto"],l=r.getPropertyValue("overflow"),c=r.getPropertyValue("overflow-y"),h=r.getPropertyValue("overflow-x");if(o.includes(l)||o.includes(c)||o.includes(h))return n;n=n.parentNode}return t}function sn(element,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(element){if(element===t)return"width"===e?"".concat(t.innerWidth,"px"):"height"===e?"".concat(t.innerHeight,"px"):void 0;var n=element.style[e];if(""!==n&&void 0!==n)return n;var r=cn(element,t);return""!==r[e]&&void 0!==r[e]?r[e]:void 0}}function un(element,e){var t=e.selectorText,n=!1;return e.type===CSSRule.STYLE_RULE&&t&&(element.msMatchesSelector?n=element.msMatchesSelector(t):element.matches&&(n=element.matches(t))),n}function cn(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return element.currentStyle||e.getComputedStyle(element)}function hn(element){return element.offsetWidth}function fn(element){return V()&&element.firstChild&&"CAPTION"===element.firstChild.nodeName?element.offsetHeight+element.firstChild.offsetHeight:element.offsetHeight}function dn(element){return element.clientHeight||element.innerHeight}function pn(element){return element.clientWidth||element.innerWidth}function yn(element,e,t){element.addEventListener(e,t,!1)}function gn(element,e,t){element.removeEventListener(e,t,!1)}function vn(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function mn(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();return null===n?0:e.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function bn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,text="";return e.getSelection?text=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(text=t.selection.createRange().text),text}function wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function Cn(element,e,t){if(void 0===t&&(t=e),element.setSelectionRange){element.focus();try{element.setSelectionRange(e,t)}catch(o){var n=element.parentNode,r=n.style.display;n.style.display="block",element.setSelectionRange(e,t),n.style.display=r}}}function Sn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=t.offsetWidth;n.style.overflow="scroll";var o=t.offsetWidth;return r===o&&(o=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-o}function kn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===$t&&($t=Sn(e)),$t}function On(element){return element.offsetWidth!==element.clientWidth}function Rn(element){return element.offsetHeight!==element.clientHeight}function En(e,t,n){Le()?(e.style.top=n,e.style.left=t):He()?e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function Tn(element){var e;return element.style.transform&&""!==(e=element.style.transform)?["transform",e]:element.style["-webkit-transform"]&&""!==(e=element.style["-webkit-transform"])?["-webkit-transform",e]:-1}function An(element){element.style.transform&&""!==element.style.transform?element.style.transform="":element.style["-webkit-transform"]&&""!==element.style["-webkit-transform"]&&(element.style["-webkit-transform"]="")}function xn(element){return element&&(["INPUT","SELECT","TEXTAREA"].indexOf(element.nodeName)>-1||"true"===element.contentEditable)}function Mn(element){return xn(element)&&!1===element.hasAttribute("data-hot-input")}function Pn(element){Mn(element.ownerDocument.activeElement)||element.select()}function _n(element){return!element.parentNode}function In(e){return"function"==typeof e}function Hn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function l(){for(var l=this,c=arguments.length,h=new Array(c),f=0;f<c;f++)h[f]=arguments[f];var d=Date.now(),y=!1;r.lastCallThrottled=!0,n||(n=d,y=!0);var v=t-(d-n);return y?(r.lastCallThrottled=!1,e.apply(this,h)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,e.apply(l,h),n=0,o=void 0}),v)),r}return l}function jn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=Hn(e,t),o=n;function l(){o=n}function c(){for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return o?(o-=1,e.apply(this,n)):r.apply(this,n)}return c.clearHits=l,c}function Dn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return r&&clearTimeout(r),r=setTimeout((function(){t=e.apply(o,c)}),n),t}return o}function Nn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],o=t.slice(1);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Y(o,(function(e,t){return t(e)}),r.apply(this,t))}}function Ln(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function Bn(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var h=r.concat(l);return h.length>=t?e.apply(this,h):n(h)}}([])}function Vn(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var h=r.concat(l.reverse());return h.length>=t?e.apply(this,h):n(h)}}([])}function Fn(e,t,n,r,o,l,c,h){return it(h)?e.call(t,n,r,o,l,c,h):it(c)?e.call(t,n,r,o,l,c):it(l)?e.call(t,n,r,o,l):it(o)?e.call(t,n,r,o):it(r)?e.call(t,n,r):it(n)?e.call(t,n):e.call(t)}n(512);var Wn,Un={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:_e()?182:174,AUDIO_MUTE:_e()?181:173,AUDIO_UP:_e()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},zn=[Un.ALT,Un.ARROW_DOWN,Un.ARROW_LEFT,Un.ARROW_RIGHT,Un.ARROW_UP,Un.AUDIO_DOWN,Un.AUDIO_MUTE,Un.AUDIO_UP,Un.BACKSPACE,Un.CAPS_LOCK,Un.DELETE,Un.END,Un.ENTER,Un.ESCAPE,Un.F1,Un.F2,Un.F3,Un.F4,Un.F5,Un.F6,Un.F7,Un.F8,Un.F9,Un.F10,Un.F11,Un.F12,Un.F13,Un.F14,Un.F15,Un.F16,Un.F17,Un.F18,Un.F19,Un.HOME,Un.INSERT,Un.MEDIA_NEXT,Un.MEDIA_PLAY_PAUSE,Un.MEDIA_PREV,Un.MEDIA_STOP,Un.NULL,Un.NUM_LOCK,Un.PAGE_DOWN,Un.PAGE_UP,Un.PAUSE,Un.SCROLL_LOCK,Un.SHIFT,Un.TAB];function Gn(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function Yn(e){return zn.includes(e)}function Kn(e){var t=[];return ze()?t.push(Un.COMMAND_LEFT,Un.COMMAND_RIGHT,Un.COMMAND_FIREFOX):t.push(Un.CONTROL),t.includes(e)}function Xn(e){return[Un.CONTROL,Un.COMMAND_LEFT,Un.COMMAND_RIGHT,Un.COMMAND_FIREFOX].includes(e)}function $n(e,t){var n=t.split("|"),r=!1;return $(n,(function(t){if(e===Un[t])return r=!0,!1})),r}function qn(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Qn(e){return!1===e.isImmediatePropagationEnabled}function Jn(e){return 2===e.button}function Zn(e){return 0===e.button}function er(){var e;it(console)&&(e=console).warn.apply(e,arguments)}function nr(){var e;it(console)&&(e=console).error.apply(e,arguments)}function rr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var or,ir,ar=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],lr=et(Wn||(or=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],(ir=['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])||(ir=or.slice(0)),Wn=Object.freeze(Object.defineProperties(or,{raw:{value:Object.freeze(ir)}})))),sr=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),ur=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),cr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalBucket=this.createEmptyBucket()}var t,n,r;return t=e,n=[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return $(ar,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))$(t,(function(t){return n.add(e,t,r)}));else{sr.has(e)&&er(Tt(lr,{hookName:e,removedInVersion:sr.get(e)})),ur.has(e)&&er(ur.get(e));var o=this.getBucket(r);if(void 0===o[e]&&(this.register(e),o[e]=[]),t.skip=!1,-1===o[e].indexOf(t)){var l=!1;t.initialHook&&$(o[e],(function(n,i){if(n.initialHook)return o[e][i]=t,l=!0,!1})),l||o[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?$(t,(function(t){return n.once(e,t,r)})):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,o,l,c,h){var f=this.globalBucket[t],d=f?f.length:0,y=0;if(d)for(;y<d;)if(f[y]&&!f[y].skip){var v=Fn(f[y],e,n,r,o,l,c,h);void 0!==v&&(n=v),f[y]&&f[y].runOnce&&this.remove(t,f[y]),y+=1}else y+=1;var m=this.getBucket(e)[t],w=m?m.length:0,C=0;if(w)for(;C<w;)if(m[C]&&!m[C].skip){var S=Fn(m[C],e,n,r,o,l,c,h);void 0!==S&&(n=S),m[C]&&m[C].runOnce&&this.remove(t,m[C],e),C+=1}else C+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;be(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||ar.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&ar.splice(ar.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return ur.has(e)||sr.has(e)}},{key:"isRegistered",value:function(e){return ar.indexOf(e)>=0}},{key:"getRegistered",value:function(){return ar}}],r=[{key:"getSingleton",value:function(){return fr}}],n&&rr(t.prototype,n),r&&rr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),fr=new cr;var dr=cr;function pr(e){return function(e){if(Array.isArray(e))return yr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var gr=new Map;function vr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";gr.has(e)||gr.set(e,new Map);var t=gr.get(e);function n(e,n){t.set(e,n)}function r(e){return t.get(e)}function o(e){return t.has(e)}function l(){return pr(t.keys())}function c(){return pr(t.values())}return{register:n,getItem:r,hasItem:o,getNames:l,getValues:c}}var mr=new WeakMap,wr=vr("editors"),Cr=wr.register,Sr=wr.getItem,kr=wr.hasItem,Or=wr.getNames;wr.getValues;function Rr(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},dr.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function Er(e,t){var n;if("function"==typeof e)mr.get(e)||Ar(null,e),n=mr.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=Sr(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function Tr(e){if(!kr(e))throw Error('No registered editor found under "'.concat(e,'" name'));return Sr(e).getConstructor()}function Ar(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);var n=new Rr(t);"string"==typeof e&&Cr(e,n),mr.set(t,n)}function xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Pr=0,_r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;xr(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}var t,n,r;return t=e,n=[{key:"addEventListener",value:function(element,e,t){var n=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function o(e){t.call(this,Ir(e))}return"boolean"==typeof r||W()||(r=!1),this.context.eventListeners.push({element:element,event:e,callback:t,callbackProxy:o,options:r,eventManager:this}),element.addEventListener(e,o,r),Pr+=1,function(){n.removeEventListener(element,e,t)}}},{key:"removeEventListener",value:function(element,e,t){for(var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;o;)if(o-=1,(n=this.context.eventListeners[o]).event===e&&n.element===element){if(t&&t!==n.callback)continue;if(r&&n.eventManager!==this)continue;this.context.eventListeners.splice(o,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Pr-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Pr-=1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(element,e){var t=element.document,n=element;t||(n=(t=element.ownerDocument?element.ownerDocument:element).defaultView);var r,o={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};t.createEvent?(r=t.createEvent("MouseEvents")).initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||t.body.parentNode):r=t.createEventObject(),element.dispatchEvent?element.dispatchEvent(r):element.fireEvent("on".concat(e),r)}}],n&&Mr(t.prototype,n),r&&Mr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ir(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),qn(this)},e}var Hr=_r;function jr(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dr(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Nr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Lr="editorManager.navigation",Br="editorManager.handlingEditor",Vr=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.selection=r,this.eventManager=new Hr(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(e){return o.onAfterDocumentKeyDown(e)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",e)})),this.instance.view._wt.update("onCellDblClick",(function(e,t,n){return o.onCellDblClick(e,t,n)}))}var t,n,r;return t=e,(n=[{key:"registerShortcuts",value:function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=t.getContext("editor"),o={group:Br};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){e.closeEditorAndSaveChanges(t.isCtrlPressed()),e.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){e.closeEditorAndRestoreOriginalValue(t.isCtrlPressed()),e.activeEditor.focus()}}],o),n.addShortcuts([{keys:[["F2"]],callback:function(t){e.activeEditor&&e.activeEditor.enableFullEditMode(),e.openEditor(null,t)}},{keys:[["Backspace"],["Delete"]],callback:function(){e.instance.emptySelectedCells(),e.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(t,n){e.instance.getSettings().enterBeginsEditing?e.cellProperties.readOnly?e.moveSelectionAfterEnter():e.activeEditor&&(e.activeEditor.enableFullEditMode(),e.openEditor(null,t)):e.moveSelectionAfterEnter(n.includes("shift")),qn(t)}}],o)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.selection.selectedRange.current().highlight,n=t.row,col=t.col,r=this.instance.runHooks("modifyGetCellCoords",n,col),o=n,l=col;if(Array.isArray(r)){var c=jr(r,2);o=c[0],l=c[1]}this.cellProperties=this.instance.getCellMeta(o,l);var h=this.instance.rootDocument.activeElement;if(h&&h.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var f=this.instance.getCellEditor(this.cellProperties),td=this.instance.getCell(n,col,!0);if(f&&td){var d=this.instance.colToProp(l),y=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(o),l);this.activeEditor=Er(f,this.instance),this.activeEditor.prepare(n,col,d,td,y,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){this.activeEditor&&this.activeEditor.beginEditing(e,t)}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(e){var t=this;if(this.instance.isListening()){var n=e.keyCode;if(229!==n&&this.selection.isSelected()){var r=(e.ctrlKey||e.metaKey)&&!e.altKey;if(this.activeEditor&&!this.activeEditor.isWaiting()&&!(Yn(n)||Xn(n)||r||this.isEditorOpened())){var o=this.instance.getShortcutManager().getContext("editor"),l={runOnlyIf:function(){return it(t.instance.getSelected())},group:Lr};o.addShortcuts([{keys:[["ArrowUp"]],callback:function(){t.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){t.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){t.instance.selection.transformStart(0,-1*t.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){t.instance.selection.transformStart(0,t.instance.getDirectionFactor())}}],l),this.openEditor("",e)}}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&Nr(t.prototype,n),r&&Nr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Fr=new WeakMap;Vr.getInstance=function(e,t,n){var r=Fr.get(e);return r||(r=new Vr(e,t,n),Fr.set(e,r)),r};var Wr=Vr;n(526),n(789),n(905),n(679),n(725);function Ur(e){return function(e){if(Array.isArray(e))return zr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return zr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var Gr={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Yr=new RegExp(Object.keys(Gr).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function Kr(element){return"TABLE"===(element&&element.nodeName||"")}function Xr(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],data=e.getData.apply(e,r),o=data.length,l=o>0?data[0].length:0,c=["<table>","</table>"],h=t?["<thead>","</thead>"]:[],f=["<tbody>","</tbody>"],d=n?1:0,y=t?1:0,v=0;v<o;v+=1){for(var m=t&&0===v,w=[],C=0;C<l;C+=1){var S=!m&&n&&0===C,k="";if(m)k="<th>".concat(e.getColHeader(C-d),"</th>");else if(S)k="<th>".concat(e.getRowHeader(v-y),"</th>");else{var O=data[v][C],R=e.getCellMeta(v-y,C-d),E=R.hidden,T=R.rowspan,A=R.colspan;if(!E){var x=[];if(T&&x.push('rowspan="'.concat(T,'"')),A&&x.push('colspan="'.concat(A,'"')),lt(O))k="<td ".concat(x.join(" "),"></td>");else{var M=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");k="<td ".concat(x.join(" "),">").concat(M,"</td>")}}}w.push(k)}var P=["<tr>"].concat(w,["</tr>"]).join("");m?h.splice(1,0,P):f.splice(-1,0,P)}return c.splice(1,0,h.join(""),f.join("")),c.join("")}function $r(input){for(var e=input.length,t=["<table>"],n=0;n<e;n+=1){var r=input[n],o=r.length,l=[];0===n&&t.push("<tbody>");for(var c=0;c<o;c+=1){var h=r[c],f=lt(h)?"":h.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l.push("<td>".concat(f,"</td>"))}t.push.apply(t,["<tr>"].concat(l,["</tr>"])),n+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function qr(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,t={},n=e.createDocumentFragment(),r=e.createElement("div");n.appendChild(r);var o=element;if("string"==typeof o){var l=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(n).concat("</td>")}));r.insertAdjacentHTML("afterbegin","".concat(l)),o=r.querySelector("table")}if(o&&Kr(o)){var c=r.querySelector('meta[name$="enerator"]'),h=null!==o.querySelector("tbody th"),f=o.querySelector("tr"),d=f?Array.from(f.cells).reduce((function(e,t){return e+t.colSpan}),0)-(h?1:0):0,y=o.tFoot&&Array.from(o.tFoot.rows)||[],v=[],m=!1,w=0,C=0;if(o.tHead){var S=Array.from(o.tHead.rows).filter((function(tr){var e=null!==tr.querySelector("td");return e&&v.push(tr),!e}));m=(w=S.length)>0,w>1?t.nestedHeaders=Array.from(S).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,header,t){if(h&&0===t)return e;var n=header.colSpan,r=header.innerHTML,o=n>1?{label:r,colspan:n}:r;return e.push(o),e}),[]);return e.push(n),e}),[]):m&&(t.colHeaders=Array.from(S[0].children).reduce((function(e,header,t){return h&&0===t||e.push(header.innerHTML),e}),[]))}v.length&&(t.fixedRowsTop=v.length),y.length&&(t.fixedRowsBottom=y.length);var k=[].concat(v,Ur(Array.from(o.tBodies).reduce((function(e,section){return e.push.apply(e,Ur(Array.from(section.rows))),e}),[])),Ur(y));C=k.length;for(var O=new Array(C),R=0;R<C;R++)O[R]=new Array(d);for(var E=[],T=[],A=0;A<C;A++)for(var tr=k[A],x=Array.from(tr.cells),M=x.length,P=0;P<M;P++){var _=x[P],I=_.nodeName,H=_.innerHTML,j=_.rowSpan,D=_.colSpan,col=O[A].findIndex((function(e){return void 0===e}));if("TD"===I){if(j>1||D>1){for(var N=A;N<A+j;N++)if(N<C)for(var L=col;L<col+D;L++)O[N][L]=null;var B=_.getAttribute("style"),V=B&&B.includes("mso-ignore:colspan");V||E.push({col:col,row:A,rowspan:j,colspan:D})}var F="";F=c&&/excel/gi.test(c.content)?H.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):H.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),O[A][col]=F.replace(Yr,(function(e){return Gr[e]}))}else T.push(H)}return E.length&&(t.mergeCells=E),T.length&&(t.rowHeaders=T),O.length&&(t.data=O),t}}function Qr(e){return function(e){if(Array.isArray(e))return Jr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Zr(e){return Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function eo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Zr(e);if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);var r=Array.from(new Set(["."].concat(Qr(t)))).map((function(e){return"\\".concat(e)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(r,")?\\d+((").concat(r,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function to(e){return eo(e,[","])}function no(e,t,n){var r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function ro(e,t,n){var r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function oo(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function io(e){return function(e){if(Array.isArray(e))return so(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||lo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ao(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||lo(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lo(e,t){if(e){if("string"==typeof e)return so(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?so(e,t):void 0}}function so(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var uo="asc",co=new Map([[uo,[-1,1]],["desc",[1,-1]]]),ho=function(e){return"The priority '".concat(e,"' is already declared in a map.")},fo=function(e){return"The priority '".concat(e,"' is not a number.")};n(677);function po(e){return function(e){if(Array.isArray(e))return vo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||go(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yo(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||go(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function go(e,t){if(e){if("string"==typeof e)return vo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vo(e,t):void 0}}function vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var mo=function(e){return"The id '".concat(e,"' is already declared in a map.")};function bo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorIdExists,n=new Map;function r(e,r){if(d(e))throw new Error(t(e));n.set(e,r)}function o(e){return n.delete(e)}function l(){n.clear()}function c(e){var t=f().find((function(t){var n=yo(t,2),r=n[0],element=n[1];return e===element&&r}))||[null];return yo(t,1)[0]}function h(e){return n.get(e)}function f(){return po(n)}function d(e){return n.has(e)}return t=In(t)?t:mo,{addItem:r,clear:l,getId:c,getItem:h,getItems:f,hasItem:d,removeItem:o}}function wo(e){return function(e){if(Array.isArray(e))return Co(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Co(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Co(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Co(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var So=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function ko(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||Ro(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oo(e){return function(e){if(Array.isArray(e))return Eo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ro(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ro(e,t){if(e){if("string"==typeof e)return Eo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eo(e,t):void 0}}function Eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var To=function(e){return'There is already registered "'.concat(e,'" plugin.')},Ao=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,r=new Map;function o(e,o){if(!eo(e))throw new Error(n(e));if(r.has(e))throw new Error(t(e));r.set(e,o)}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uo,t=co.get(e)||co.get(uo),n=ao(t,2),o=n[0],l=n[1];return io(r).sort((function(a,b){return a[0]<b[0]?o:l})).map((function(e){return e[1]}))}return t=In(t)?t:ho,n=In(n)?n:fo,{addItem:o,getItems:l}}({errorPriorityExists:function(e){return'There is already registered plugin on priority "'.concat(e,'".')},errorPriorityNaN:function(e){return'The priority "'.concat(e,'" is not a number.')}}),xo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorItemExists,n=new Set;function r(e){if(n.has(e))throw new Error(t(e));n.add(e)}function o(){return wo(n)}function l(){n.clear()}return t=In(t)?t:So,{addItem:r,clear:l,getItems:o}}({errorItemExists:To}),Mo=bo({errorIdExists:To});function Po(){return[].concat(Oo(Ao.getItems()),Oo(xo.getItems()))}function _o(e){var t=kt(e);return Mo.getItem(t)}function Io(e,t,n){var r=function(e,t,n){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),o=ko(r,3);e=o[0],t=o[1],n=o[2],void 0===_o(e)&&function(e,t,n){var r=kt(e);if(Mo.hasItem(r))throw new Error(To(r));void 0===n?xo.addItem(r):Ao.addItem(n,r);Mo.addItem(r,t)}(e,t,n)}var Ho=vr("renderers"),jo=Ho.register,Do=Ho.getItem,No=Ho.hasItem,Lo=Ho.getNames;Ho.getValues;function Bo(e){if("function"==typeof e)return e;if(!No(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return Do(e)}function Vo(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),jo(e,t)}var Fo=vr("validators"),Wo=Fo.register,Uo=Fo.getItem,zo=Fo.hasItem,Go=Fo.getNames;Fo.getValues;function Yo(e){if("function"==typeof e)return e;if(!zo(e))throw Error('No registered validator found under "'.concat(e,'" name'));return Uo(e)}function Ko(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),Wo(e,t)}n(495),n(496);function Xo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var qo=new WeakMap,Qo=function(){function e(t,n,r,o,l,c){var h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Xo(this,e),this.wtSettings=r,this.domBindings=n,this.wtTable=l,this.selections=c,this.parent=h,this.eventManager=o,this.facadeGetter=t,qo.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var t,n,r;return t=e,(n=[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.momentumScrolling||(e.momentumScrolling={}),e.eventManager.addEventListener(e.wtTable.holder,"scroll",(function(){clearTimeout(e.momentumScrolling._timeout),e.momentumScrolling.ongoing||e.wtSettings.getSetting("onBeforeTouchScroll"),e.momentumScrolling.ongoing=!0,e.momentumScrolling._timeout=setTimeout((function(){e.touchApplied||(e.momentumScrolling.ongoing=!1,e.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))};Ve()?t():(B()&&t(),e.eventManager.addEventListener(e.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)})))}},{key:"selectedCellWasTouched",value:function(e){var t=qo.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){var r=[n.row,t.selectedCellBeforeTouchEnd.from.row],o=r[0],l=r[1],c=[n.col,t.selectedCellBeforeTouchEnd.from.col];return o===l&&c[0]===c[1]}return!1}},{key:"parentCell",value:function(e){var t={},n=Nt(e,["TD","TH"],this.wtTable.TABLE);return n?(t.coords=this.wtTable.getCoords(n),t.TD=n):zt(e,"wtBorder")&&zt(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):zt(e,"wtBorder")&&zt(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=qo.get(this),n=this.domBindings.rootDocument.activeElement,r=Ln(_t,e.target),o=e.target;if(o!==n&&r(0)!==n&&r(1)!==n){var l=this.parentCell(o);zt(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,o):l.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,l.coords,l.TD),(0===e.button||this.touchApplied)&&l.TD&&(t.dblClickOrigin[0]=l.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.wtSettings.has("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}},{key:"onMouseOver",value:function(e){if(this.wtSettings.has("onCellMouseOver")){var table=this.wtTable.TABLE,td=Nt(e.target,["TD","TH"],table),t=this.parent||this;td&&td!==t.lastMouseOver&&Lt(td,table)&&(t.lastMouseOver=td,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(td),td))}}},{key:"onMouseOut",value:function(e){if(this.wtSettings.has("onCellMouseOut")){var table=this.wtTable.TABLE,t=Nt(e.target,["TD","TH"],table),n=Nt(e.relatedTarget,["TD","TH"],table);t&&t!==n&&Lt(t,table)&&this.callListener("onCellMouseOut",e,this.wtTable.getCoords(t),t)}}},{key:"onMouseUp",value:function(e){var t=qo.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(zt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){qo.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,o=it(r)&&r.row>=0&&r.col>=0;e.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance")&&(Fe()&&(Pe()||Ie())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()),this.onMouseUp(e),this.touchApplied=!1}},{key:"callListener",value:function(e,t,n,r){var o=this.wtSettings.getSettingPure(e);o&&o(t,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var e=qo.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}])&&$o(t.prototype,n),r&&$o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Jo=Qo;function Zo(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ei=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n,r;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&Zo(t.prototype,n),r&&Zo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ti(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ni=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n,r;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&ti(t.prototype,n),r&&ti(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ri(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var oi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}])&&ri(t.prototype,n),r&&ri(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ii(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ai=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=new oi,this.workingSpace=0,this.sharedSize=null}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof oi}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}])&&ii(t.prototype,n),r&&ii(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function si(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ui=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new ai,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet())for(var element=e.firstElementChild;element;){if(element.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;element=element.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var l=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(l):e.insertBefore(l,e.firstChild),o+=1}for(var c=n&&t.isPlaceOn(1);o>r;)e.removeChild(c?e.firstChild:e.lastChild),o-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}])&&si(t.prototype,n),r&&si(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ci(e){return ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ci(e)}function hi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function di(e,p){return di=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},di(e,p)}function pi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gi(e);if(t){var o=gi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yi(this,n)}}function yi(e,t){if(t&&("object"===ci(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gi(e){return gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gi(e)}var vi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&di(e,t)}(l,e);var t,n,r,o=pi(l);function l(){return hi(this,l),o.apply(this,arguments)}return t=l,(n=[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}])&&fi(t.prototype,n),r&&fi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(ui);function mi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodeType=t.toUpperCase()}var t,n,r;return t=e,(n=[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&mi(t.prototype,n),r&&mi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ci=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodesPool="string"==typeof t?new bi(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}var t,n,r;return t=e,(n=[{key:"setTable",value:function(table){this.nodesPool&&this.nodesPool.setRootDocument(table.rootDocument),this.table=table}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&wi(t.prototype,n),r&&wi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Si(e){return Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Si(e)}function ki(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Oi(e,p){return Oi=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Oi(e,p)}function Ri(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ti(e);if(t){var o=Ti(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ei(this,n)}}function Ei(e,t){if(t&&("object"===Si(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ti(e){return Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ti(e)}var Ai=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oi(e,t)}(l,e);var t,n,r,o=Ri(l);function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=l,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new vi(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,o=e.rows,l=e.cells,c=0;c<t;c++){var h=this.table.renderedRowToSource(c),f=o.getRenderedNode(c);this.sourceRowIndex=h;var d=this.obtainOrderView(f),y=l.obtainOrderView(f);d.appendView(y).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var v=0;v<r;v++){d.render();var m=d.getCurrentNode();m.className="",m.removeAttribute("style"),n[v](h,m,v)}d.end()}}}])&&ki(t.prototype,n),r&&ki(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ci);function xi(e){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xi(e)}function Mi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pi(e,p){return Pi=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Pi(e,p)}function _i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hi(e);if(t){var o=Hi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ii(this,n)}}function Ii(e,t){if(t&&("object"===xi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Hi(e){return Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hi(e)}var ji=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pi(e,t)}(l,e);var t,n,r,o=_i(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,null,e)}return t=l,(n=[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,r=this.rootNode.firstChild;if(t){for(var o=this.table.columnsToRender+n,i=0,l=t;i<l;i++){for((r=this.rootNode.childNodes[i])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}var c=this.rootNode.childNodes.length;if(c>t)for(var h=t;h<c;h++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Xt(r)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,l=n.rowHeadersCount,c=this.rootNode.childNodes[t],h=-1*l;h<o;h+=1){var f=this.table.renderedColumnToSource(h),d=c.childNodes[h+l];d.className="",d.removeAttribute("style"),r[t](f,d,t)}}}])&&Mi(t.prototype,n),r&&Mi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ci);function Di(e){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(e)}function Ni(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Li(e,p){return Li=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Li(e,p)}function Bi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fi(e);if(t){var o=Fi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vi(this,n)}}function Vi(e,t){if(t&&("object"===Di(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fi(e){return Fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fi(e)}var Wi,Ui=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Li(e,t)}(l,e);var t,n,r,o=Bi(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,null,e)}return t=l,(n=[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=0;r<n;r++){var o=this.table.renderedColumnToSource(r),l=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width="".concat(l,"px")}for(var c=0;c<t;c++){var h=this.table.renderedColumnToSource(c),f=this.table.columnUtils.getStretchedColumnWidth(h);this.rootNode.childNodes[c+n].style.width="".concat(f,"px")}var d=this.rootNode.firstChild;d&&Gt(d,"rowHeader")}}])&&Ni(t.prototype,n),r&&Ni(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ci);function zi(e){return zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zi(e)}function Gi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yi(e,p){return Yi=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Yi(e,p)}function Ki(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$i(e);if(t){var o=$i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xi(this,n)}}function Xi(e,t){if(t&&("object"===zi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $i(e){return $i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$i(e)}var qi=!1,Qi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yi(e,t)}(l,e);var t,n,r,o=Ki(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,"TR",e)).orderView=new ui(e,(function(e){return t.nodesPool.obtain(e)}),t.nodeType),t}return t=l,n=[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!qi&&e>1e3&&(qi=!0,er(et(Wi||(Wi=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}],n&&Gi(t.prototype,n),r&&Gi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ci);function Ji(e){return Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ji(e)}function Zi(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ea(e,p){return ea=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},ea(e,p)}function ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ra(e);if(t){var o=ra(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return na(this,n)}}function na(e,t){if(t&&("object"===Ji(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ra(e){return ra=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ra(e)}var oa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ea(e,t)}(l,e);var t,n,r,o=ta(l);function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=o.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=l,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new vi(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,r=e.rows,o=e.rowHeaders,l=0;l<t;l++){var c=this.table.renderedRowToSource(l),h=r.getRenderedNode(l);this.sourceRowIndex=c;var f=this.obtainOrderView(h),d=o.obtainOrderView(h);f.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<n;y++){f.render();var v=f.getCurrentNode(),m=this.table.renderedColumnToSource(y);zt(v,"hide")||(v.className=""),v.removeAttribute("style"),v.removeAttribute("dir"),this.table.cellRenderer(c,m,v)}f.end()}}}])&&Zi(t.prototype,n),r&&Zi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ci);function ia(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var la=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;ia(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}var t,n,r;return t=e,n=[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,o=e.rows,l=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),l.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=l}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),l=this.rowUtils.getHeight(o);r.firstChild.style.height=l?"".concat(l-1,"px"):""}}}}],n&&aa(t.prototype,n),r&&aa(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function sa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ua(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ca=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,r=t.THEAD,o=t.COLGROUP,l=t.TBODY,c=t.rowUtils,h=t.columnUtils,f=t.cellRenderer;sa(this,e),this.renderer=new la(n,{cellRenderer:f}),this.renderer.setRenderers({rowHeaders:new Ai,columnHeaders:new ji(r),colGroup:new Ui(o),rows:new Qi(l),cells:new oa}),this.renderer.setAxisUtils(c,h)}var t,n,r;return t=e,(n=[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}])&&ua(t.prototype,n),r&&ua(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ha(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var fa=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataAccessObject=t,this.wtSettings=n,this.headerWidths=new Map}var t,n,r;return t=e,(n=[{key:"getWidth",value:function(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(e){var t=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(e);if(t){var r=t.getStretchedColumnWidth(e,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(e){var t=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wtSettings,t=this.dataAccessObject,n=t.wtTable,r=t.wtViewport,o=t.cloneSource,l=o?o.wtTable.holder:n.holder,c=l.offsetHeight<l.scrollHeight?kn():0,h=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-c),null!=(h=e.getSetting("onModifyRowHeaderWidth",h)))for(var f=e.getSetting("rowHeaders").length,d=e.getSetting("defaultColumnWidth"),y=0;y<f;y++){var v=Array.isArray(h)?h[y]:h;v=null==v?d:v,this.headerWidths.set(y,v)}}}])&&ha(t.prototype,n),r&&ha(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function da(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pa=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataAccessObject=t,this.wtSettings=n}var t,n,r;return t=e,(n=[{key:"getHeight",value:function(e){var t=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}])&&da(t.prototype,n),r&&da(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ya="top",ga="bottom",va="inline_start",ma="top_inline_start_corner",ba="bottom_inline_start_corner",wa=[ya,ga,va,ma,ba],Ca=new Map([[ya,"ht_clone_".concat(ya)],[ga,"ht_clone_".concat(ga)],[va,"ht_clone_".concat(va," ht_clone_left")],[ma,"ht_clone_".concat(ma," ht_clone_top_left_corner")],[ba,"ht_clone_".concat(ba," ht_clone_bottom_left_corner")]]);function Sa(e){return function(e){if(Array.isArray(e))return Ra(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Oa(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ka(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||Oa(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oa(e,t){if(e){if("string"==typeof e)return Ra(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ra(e,t):void 0}}function Ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ea(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ta(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Aa=function(){function e(t,n,r,o,l){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ta(this,"wtSettings",null),Ta(this,"domBindings",void 0),Ta(this,"TBODY",null),Ta(this,"THEAD",null),Ta(this,"COLGROUP",null),Ta(this,"hasTableHeight",!0),Ta(this,"hasTableWidth",!0),Ta(this,"isTableVisible",!1),Ta(this,"tableOffset",0),Ta(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===l,this.name=l,this.dataAccessObject=t,this.facadeGetter=n,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Kt(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var h=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return c._modifyRowHeaderWidth(h)})),this.rowUtils=new pa(this.dataAccessObject,this.wtSettings),this.columnUtils=new fa(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ca({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}var t,n,r;return t=e,n=[{key:"is",value:function(e){return this.name===e}},{key:"fixTableDomTree",value:function(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(table){var e,t=table.parentNode;return t&&t.nodeType===Node.ELEMENT_NODE&&zt(t,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",t&&t.insertBefore(e,table),e.appendChild(table)),e.style.position="relative",e}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&zt(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&zt(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable",t.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtSettings,n=this.dataAccessObject,r=n.wtOverlays,o=n.wtViewport,l=t.getSetting("totalRows"),c=t.getSetting("totalColumns"),h=t.getSetting("rowHeaders"),f=h.length,d=t.getSetting("columnHeaders"),y=d.length,v=!1,m=e;if(this.isMaster&&(this.holderOffset=en(this.holder),m=o.createRenderCalculators(m),f&&!t.getSetting("fixedColumnsStart"))){var w=r.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=0!==w,C!==this.correctHeaderWidth&&(m=!1)}if(this.isMaster&&(v=r.updateStateOfRendering()),m)this.isMaster&&o.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=en(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var S=l>0?this.getFirstRenderedRow():0,k=c>0?this.getFirstRenderedColumn():0;this.rowFilter=new ni(S,l,y),this.columnFilter=new ei(k,c,f);var O,R=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var E={};this.wtSettings.getSetting("beforeDraw",!0,E),R=!0!==E.skipRender}if(R)if(this.tableRenderer.setHeaderContentRenderers(h,d),(this.is(ga)||this.is(ba))&&this.tableRenderer.setHeaderContentRenderers(h,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(O=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ga))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var T=hn(this.hider),A=hn(this.TABLE);0!==T&&A!==T&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),O!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ga)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}if(this.isMaster){var x=r.topOverlay.resetFixedPosition();r.bottomOverlay.clone&&(x=r.bottomOverlay.resetFixedPosition()||x),x=r.inlineStartOverlay.resetFixedPosition()||x,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition(),x&&(r.refreshAll(),r.adjustElementsSize())}return this.refreshSelections(m),v&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(col){for(var e,t,n,r=this.columnFilter.renderedToSource(col),o=this.wtSettings.getSetting("columnHeaders").length,l=this.wtSettings.getSetting("defaultRowHeight"),c=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,e=this.getColumnHeaderHeight(o),(t=this.getColumnHeader(r,o))&&(n=dn(t),(!e&&l<n||e<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=n),Array.isArray(c)?null!==c[o]&&void 0!==c[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=c[o]):isNaN(c)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=c),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(c[o]||c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=c[o]||c))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wtSettings,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=0,r=e.getSetting("columnHeaders").length;i<r;i++)if(n[i]){if(!t[i]||0===t[i].childNodes.length)return;t[i].childNodes[0].style.height="".concat(n[i],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(ga))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),i=0,n=t.length;i<n;i++)Yt(t[i],e)}},{key:"refreshSelections",value:function(e){var t=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(e){for(var l=[],i=0;i<o;i++){for(var c=r[i].settings,h=c.highlightHeaderClassName,f=c.highlightRowClassName,d=c.highlightColumnClassName,y=r[i].classNames,v=y.length,m=0;m<v;m++)l.includes(y[m])||l.push(y[m]);h&&!l.includes(h)&&l.push(h),f&&!l.includes(f)&&l.push(f),d&&!l.includes(d)&&l.push(d)}var w=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(w))for(var C=0;C<w.length;C++)l.push(w[C]);for(var S=l.length,k=0;k<S;k++)this.removeClassFromCells(l[k])}for(var O=0;O<o;O++)r[O].draw(this.facadeGetter(),e)}}},{key:"getCell",value:function(e){var t,n=e.row,r=e.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(o&&Array.isArray(o)){var l=ka(o,2);n=l[0],r=l[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;if(!(t=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)])&&n>=0)throw new Error("TR was expected to be rendered but is not");var c=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!c&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return c}},{key:"getColumnHeader",value:function(col){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=this.THEAD.childNodes[e];return null==t?void 0:t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((function(e){var r=e.childNodes[n];r&&t.push(r)})),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(t>=n)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null==r?void 0:r.childNodes[t]}}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],l=null==o?void 0:o.childNodes[r];l&&t.push(l)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Dt(t,["TD","TH"])),null===t)return null;var n=t.parentNode,r=n.parentNode,o=Bt(n),col=t.cellIndex;return Vt(ma,t,this.wtRootElement)||Vt(ya,t,this.wtRootElement)?"THEAD"===r.nodeName&&(o-=r.childNodes.length):o=Vt(ba,t,this.wtRootElement)||Vt(ga,t,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o),col=Vt(ma,t,this.wtRootElement)||Vt(va,t,this.wtRootElement)||Vt(ba,t,this.wtRootElement)?this.columnFilter.offsettedTH(col):this.columnFilter.visibleRowHeadedColumnToSourceColumn(col),this.wot.createCellCoords(o,col)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var e,t,n,r,o,l=this.TBODY.childNodes.length;if(l*this.wtSettings.getSetting("defaultRowHeight")!=dn(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;l;)l-=1,n=this.rowFilter.renderedToSource(l),e=this.getRowHeight(n),t=(o=(r=this.getTrForRow(n)).querySelector("th"))?dn(o):dn(r)-1,(!e&&this.wtSettings.getSetting("defaultRowHeight")<t||e<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return hn(this.TABLE)}},{key:"getHeight",value:function(){return fn(this.TABLE)}},{key:"getTotalWidth",value:function(){var e=hn(this.hider);return 0!==e?e:this.getWidth()}},{key:"getTotalHeight",value:function(){var e=fn(this.hider);return 0!==e?e:this.getHeight()}},{key:"isVisible",value:function(){return Zt(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t=In(e)?e():null;return Array.isArray(t)?(t=Sa(t))[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}],n&&Ea(t.prototype,n),r&&Ea(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),xa=Aa,Ma={getFirstRenderedRow:function(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};me(Ma,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var Pa=Ma,_a={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};me(_a,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var Ia=_a;function Ha(e){return Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ha(e)}function ja(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Da(e,p){return Da=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Da(e,p)}function Na(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ba(e);if(t){var o=Ba(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return La(this,n)}}function La(e,t){if(t&&("object"===Ha(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ba(e){return Ba=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ba(e)}var Va=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Da(e,t)}(l,e);var t,n,r,o=Na(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,ya)}return t=l,n&&ja(t.prototype,n),r&&ja(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(xa);ye(Va,Pa),ye(Va,Ia);var Fa=Va;function Wa(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ua=function(){function e(t){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=void 0,(r="dataAccessObject")in(n=this)?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this.dataAccessObject=t}var t,n,r;return t=e,(n=[{key:"scrollViewport",value:function(e,t,n,r,o){if(e.col<0||e.row<0)return!1;var l=this.scrollViewportHorizontally(e.col,n,o),c=this.scrollViewportVertically(e.row,t,r);return l||c}},{key:"scrollViewportHorizontally",value:function(e,t,n){if(!this.dataAccessObject.drawn)return!1;var r=this.dataAccessObject,o=r.fixedColumnsStart,l=r.inlineStartOverlay,c=r.totalColumns,h=!1;if(e>=0&&e<=Math.max(c-1,0)){var f=this.getFirstVisibleColumn(),d=this.getLastVisibleColumn();e>=o&&f>-1&&(e<f||n)?h=l.scrollTo(e):(-1===d||d>-1&&(e>d||t))&&(h=l.scrollTo(e,!0))}return h}},{key:"scrollViewportVertically",value:function(e,t,n){if(!this.dataAccessObject.drawn)return!1;var r=this.dataAccessObject,o=r.fixedRowsBottom,l=r.fixedRowsTop,c=r.topOverlay,h=r.totalRows,f=!1;if(e>=0&&e<=Math.max(h-1,0)){var d=this.getFirstVisibleRow(),y=this.getLastVisibleRow();e>=l&&d>-1&&(e<d||t)?f=c.scrollTo(e):(-1===y||y>-1&&(e>y&&e<h-o||n))&&(f=c.scrollTo(e,!0))}return f}},{key:"getFirstVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,l=e.fixedRowsTop,c=e.rootWindow,h=n.getFirstVisibleRow();if(t.mainTableScrollableElement===c){var f=en(n.wtRootElement),d=dn(n.hider),y=dn(c),v=rn(c,c);if(f.top+d-y<=v){var m=r.getColumnHeaderHeight();m+=t.sumCellSizes(0,l);for(var w=o;w>0;w--)if(m+=t.sumCellSizes(w-1,w),f.top+d-m<=v){h=w;break}}}return h}},{key:"getLastVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,l=e.rootWindow,c=n.getLastVisibleRow();if(t.mainTableScrollableElement===l){var h=en(n.wtRootElement),f=rn(l,l);if(h.top>f)for(var d=dn(l),y=r.getColumnHeaderHeight(),v=1;v<=o;v++)if(y+=t.sumCellSizes(v-1,v),h.top+y-f>=d){c=v-2;break}}return c}},{key:"getFirstVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,l=e.rootWindow,c=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===l){var h=en(n.wtRootElement),f=pn(n.hider),d=pn(l),y=Math.abs(on(l,l));if(h.left+f-d<=y)for(var v=r.getRowHeaderWidth(),m=o;m>0;m--)if(v+=t.sumCellSizes(m-1,m),h.left+f-v<=y){c=m;break}}return c}},{key:"getLastVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,l=e.rootWindow,c=n.getLastVisibleColumn();if(t.mainTableScrollableElement===l){var h=en(n.wtRootElement),f=Math.abs(on(l,l));if(h.left>f)for(var d=pn(l),y=r.getRowHeaderWidth(),v=1;v<=o;v++)if(y+=t.sumCellSizes(v-1,v),h.left+y-f>=d){c=v-2;break}}return c}}])&&Wa(t.prototype,n),r&&Wa(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),za=Ua;function Ga(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ya(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ka(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Xa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $a(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Qa(e,t,"get"))}function qa(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Qa(e,t,"set"),n),n}function Qa(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ja=new WeakMap,Za=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Ga(this,e),Xa(this,"row",null),Xa(this,"col",null),Ka(this,Ja,{writable:!0,value:!1}),qa(this,Ja,r),void 0!==t&&void 0!==n&&(this.row=t,this.col=n)}var t,n,r;return t=e,(n=[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&($a(this,Ja)?this.col<=e.col:this.col>=e.col)}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&($a(this,Ja)?this.col>=e.col:this.col<=e.col)}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&($a(this,Ja)?this.col>=e.col:this.col<=e.col)}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&($a(this,Ja)?this.col<=e.col:this.col>=e.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,$a(this,Ja))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&Ya(t.prototype,n),r&&Ya(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),el=Za;function tl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rl(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function il(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function al(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,sl(e,t,"get"))}function ll(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,sl(e,t,"set"),n),n}function sl(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var cl=new WeakMap,hl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];tl(this,e),il(this,"highlight",null),il(this,"from",null),il(this,"to",null),rl(this,cl,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=n.clone(),this.to=r.clone(),ll(this,cl,o)}var t,n,r;return t=e,(n=[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(e){var t=e.row,col=e.col,n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return n.row<=t&&r.row>=t&&n.col<=col&&r.col>=col}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),c=Math.min(t.row,o.row),h=Math.min(t.col,o.col),f=Math.max(n.row,l.row),d=Math.max(n.col,l.col),y=this._createCellCoords(c,h),v=this._createCellCoords(f,d);return this.from=y,this.to=v,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return al(this,cl)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return al(this,cl)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return al(this,cl)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return al(this,cl)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return al(this,cl)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return al(this,cl)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return al(this,cl)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return al(this,cl)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof el))return!1;if(t){var n=t.from,r=t.to;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,r.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(r.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),l=Math.min(e.from.row,e.to.row),c=Math.max(e.from.row,e.to.row),h=Math.min(e.from.col,e.to.col),f=Math.max(e.from.col,e.to.col),d=[];return t===l&&d.push("top"),o===f&&d.push("right"),n===c&&d.push("bottom"),r===h&&d.push("left"),d}},{key:"getInner",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)e.row===r&&e.col===o?n.push(e):t.row===r&&t.col===o?n.push(t):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++)if(!1===e(r,o))return}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,al(this,cl))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(e,t){return new el(e,t,al(this,cl))}}])&&nl(t.prototype,n),r&&nl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),fl=hl;function pl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gl=function(){function e(table,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),yl(this,"wtTable",void 0),yl(this,"wtScroll",void 0),yl(this,"wtViewport",void 0),yl(this,"wtOverlays",void 0),yl(this,"selections",void 0),yl(this,"wtEvent",void 0),yl(this,"guid","wt_".concat(Rt())),yl(this,"drawInterrupted",!1),yl(this,"drawn",!1),yl(this,"domBindings",void 0),yl(this,"wtSettings",void 0),this.domBindings={rootTable:table,rootDocument:table.ownerDocument,rootWindow:table.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new za(this.createScrollDao())}var t,n,r;return t=e,n=[{key:"eventManager",get:function(){return new Hr(this)}},{key:"findOriginalHeaders",value:function(){var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Jt(n,e[t])}])}}},{key:"createCellCoords",value:function(e,t){return new el(e,t,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(e,t,n){return new fl(e,t,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),l=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<l)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<l&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<l)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"scrollViewport",value:function(e,t,n,r,o){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}],n&&pl(t.prototype,n),r&&pl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function vl(e){return vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vl(e)}function ml(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bl(e,p){return bl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},bl(e,p)}function wl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kl(e);if(t){var o=kl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cl(this,n)}}function Cl(e,t){if(t&&("object"===vl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Sl(e)}function Sl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kl(e){return kl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kl(e)}function Ol(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bl(e,t)}(l,e);var t,n,r,o=wl(l);function l(table,e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),Ol(Sl(n=o.call(this,table,e)),"cloneSource",void 0),Ol(Sl(n),"cloneOverlay",void 0);var r=n.wtSettings.getSetting("facade",Sl(n));return n.cloneSource=t.source,n.cloneOverlay=t.overlay,n.wtTable=n.cloneOverlay.createTable(n.getTableDao(),r,n.domBindings,n.wtSettings),n.wtViewport=t.viewport,n.selections=t.selections,n.wtEvent=new Jo(r,n.domBindings,n.wtSettings,n.eventManager,n.wtTable,n.selections,t.event),n.findOriginalHeaders(),n}return t=l,n&&ml(t.prototype,n),r&&ml(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(gl);function El(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Tl=function(){function e(t,n,r,o,l){var c,h,f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f=null,(h="wtSettings")in(c=this)?Object.defineProperty(c,h,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[h]=f,me(this,"wot",t,{writable:!1}),this.domBindings=l,this.facadeGetter=n,this.wtSettings=o;var d=this.wot.wtTable,y=d.TABLE,v=d.hider,m=d.spreader,w=d.holder,C=d.wtRootElement;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=y,this.hider=v,this.spreader=m,this.holder=w,this.wtRootElement=C,this.trimmingContainer=ln(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}var t,n,r;return t=e,n=[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=ln(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=an(e.TABLE)}},{key:"getRelativeCellPosition",value:function(element,e,t){if(!1!==this.clone.wtTable.holder.contains(element)){var n=this.mainTableScrollableElement===this.domBindings.rootWindow,r=t<this.wtSettings.getSetting("fixedColumnsStart"),o=e<this.wtSettings.getSetting("fixedRowsTop"),l=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(c),top:c.offsetTop},f={start:this.getRelativeStartPosition(element),top:element.offsetTop};return n?this.getRelativeCellPositionWithinWindow(o,r,f,h):this.getRelativeCellPositionWithinHolder(o,l,r,f,h)}er("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,r){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),l=0,c=0;if(t){var h=o.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(o.left+o.width+kn())),l=h<=0?-1*h:0}else l=r.start;return c=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:r.top,{start:n.start+l,top:n.top+c}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,o){var l=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),c=this.wot.wtOverlays.topOverlay.getScrollPosition(),h=0,f=0;if(n||(h=l-o.start),t){var d=this.wot.wtTable.wtRootElement.getBoundingClientRect();f=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+d.top}else e||(f=c-o.top);return{start:r.start-h,top:r.top-f}}},{key:"makeClone",value:function(){if(-1===wa.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=n.createElement("DIV"),l=n.createElement("TABLE"),c=e.wtRootElement.parentNode;o.className="".concat(Ca.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,l.className=e.TABLE.className,o.appendChild(l),c.appendChild(o);var h=this.wtSettings.getSetting("preventOverflow");return!0===h||"horizontal"===h&&this.type===ya||"vertical"===h&&this.type===va?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(c).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=an(e.TABLE),new Rl(l,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;$([e.style,t.style,e.parentNode.style],(function(style){style.width="",style.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}],n&&El(t.prototype,n),r&&El(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Al(e){return Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Al(e)}function xl(e,t,n){return xl=Hl()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&Pl(r,n.prototype),r},xl.apply(null,arguments)}function Ml(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pl(e,p){return Pl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Pl(e,p)}function _l(e,t){if(t&&("object"===Al(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Il(e)}function Il(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function jl(e){return jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jl(e)}var Dl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pl(e,t)}(h,e);var t,n,r,o,l,c=(t=h,n=Hl(),function(){var e,r=jl(t);if(n){var o=jl(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return _l(this,e)});function h(e,t,n,r){var o,l,f,d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),o=c.call(this,e,t,ya,n,r),l=Il(o),d=-1,(f="cachedFixedRowsTop")in l?Object.defineProperty(l,f,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[f]=d,o.cachedFixedRowsTop=o.wtSettings.getSetting("fixedRowsTop"),o}return r=h,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xl(Fa,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),r=0,o=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)r=this.getScrollPosition(),An(e);else{var l=this.wot.wtTable.hider.getBoundingClientRect();o=Math.ceil(l.bottom)===e.offsetHeight,r=this.getOverlayOffset(),En(e,"0px","".concat(r,"px"))}var c=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),c}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(nn(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultRowHeight"),r=e,o=0;r<t;){var l=this.wot.wtTable.getRowHeight(r);o+=void 0===l?n:l,r+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=kn(n),l=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===c){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=o),h=Math.min(h,e.wtRootElement.scrollWidth),l.width="".concat(h,"px")}else l.width="";this.clone.wtTable.holder.style.width=l.width;var f=fn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),l.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,r=this.wtSettings,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,l=this.getTableParentOffset(),c=0;if(t&&o.offsetHeight!==o.clientHeight&&(c=kn(this.domBindings.rootDocument)),t){var h=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");l+=this.sumCellSizes(0,e+1),l-=n.wtViewport.getViewportHeight()-this.sumCellSizes(f-h,f),l+=1}else l+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return l+=c,this.setScrollPosition(l)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return rn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();(n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>r&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("totalColumns");r?Yt(n,"emptyColumns"):Gt(n,"emptyColumns");var o=!1;if(!t){var l=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,h=this.wtSettings.getSetting("columnHeaders");if((c||0===l)&&h.length>0){var f=zt(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?(Gt(n,"innerBorderTop"),o=!f):(Yt(n,"innerBorderTop"),o=f)}}return o}}],o&&Ml(r.prototype,o),l&&Ml(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}(Tl),Nl={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};me(Nl,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var Ll=Nl;function Bl(e){return Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bl(e)}function Vl(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fl(e,p){return Fl=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Fl(e,p)}function Wl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zl(e);if(t){var o=zl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ul(this,n)}}function Ul(e,t){if(t&&("object"===Bl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function zl(e){return zl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zl(e)}var Gl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fl(e,t)}(l,e);var t,n,r,o=Wl(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,ga)}return t=l,n&&Vl(t.prototype,n),r&&Vl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(xa);ye(Gl,Ll),ye(Gl,Ia);var Yl=Gl;function Kl(e){return Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kl(e)}function Xl(e,t,n){return Xl=Zl()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&ql(r,n.prototype),r},Xl.apply(null,arguments)}function $l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ql(e,p){return ql=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},ql(e,p)}function Ql(e,t){if(t&&("object"===Kl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Jl(e)}function Jl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function es(e){return es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},es(e)}var ts=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ql(e,t)}(h,e);var t,n,r,o,l,c=(t=h,n=Zl(),function(){var e,r=es(t);if(n){var o=es(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Ql(this,e)});function h(e,t,n,r){var o,l,f,d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),o=c.call(this,e,t,ga,n,r),l=Jl(o),d=-1,(f="cachedFixedRowsBottom")in l?Object.defineProperty(l,f,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[f]=d,o.cachedFixedRowsBottom=o.wtSettings.getSetting("fixedRowsBottom"),o}return r=h,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Xl(Yl,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings.rootWindow,t=this.clone.wtTable.holder.parentNode;t.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var e=this.wot.wtTable,t=this.domBindings.rootDocument,n=this.clone.wtTable.holder.parentNode,r=kn(t);e.holder.clientHeight===e.holder.offsetHeight&&(r=0),n.style.bottom="".concat(r,"px")}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(nn(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.getSetting("defaultRowHeight"),l=e,c=0;l<t;){var h=r.getRowHeight(l);c+=void 0===h?o:h,l+=1}return c}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings,o=r.rootDocument,l=r.rootWindow,c=kn(o),h=this.clone.wtTable.holder.parentNode.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||"horizontal"===f){var d=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=c),d=Math.min(d,t.wtRootElement.scrollWidth),h.width="".concat(d,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var y=fn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),h.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;t&&r.offsetHeight!==r.clientHeight&&(o=kn(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return rn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),o=r-this.clone.wtTable.getTotalHeight(),l=this.domBindings.rootDocument.documentElement.clientHeight;(n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+r,0))>o&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders"),o=!1;if((n||0===t)&&r.length>0){var l=this.wot.wtTable.holder.parentNode,c=zt(l,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(Gt(l,"innerBorderBottom"),o=!c):(Yt(l,"innerBorderBottom"),o=c)}return o}}],o&&$l(r.prototype,o),l&&$l(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}(Tl),ns={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};me(ns,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var rs=ns,os={getFirstRenderedColumn:function(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};me(os,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var is=os;function as(e){return as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},as(e)}function ls(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ss(e,p){return ss=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},ss(e,p)}function us(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hs(e);if(t){var o=hs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cs(this,n)}}function cs(e,t){if(t&&("object"===as(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hs(e){return hs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hs(e)}var fs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ss(e,t)}(l,e);var t,n,r,o=us(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,va)}return t=l,n&&ls(t.prototype,n),r&&ls(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(xa);ye(fs,rs),ye(fs,is);var ds=fs;function ps(e){return ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ps(e)}function ys(e,t,n){return ys=bs()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&vs(r,n.prototype),r},ys.apply(null,arguments)}function gs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vs(e,p){return vs=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},vs(e,p)}function ms(e,t){if(t&&("object"===ps(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ws(e){return ws=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ws(e)}var Cs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vs(e,t)}(h,e);var t,n,r,o,l,c=(t=h,n=bs(),function(){var e,r=ws(t);if(n){var o=ws(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return ms(this,e)});function h(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),c.call(this,e,t,va,n,r)}return r=h,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ys(ds,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(!this.needFullRender||!e.holder.parentNode)return!1;var t=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==t||r&&"horizontal"===r?(o=this.getScrollPosition(),An(n)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),En(n,"".concat(o,"px"),"0px"));var l=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),l}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,tn(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultColumnWidth"),r=e,o=0;r<t;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=kn(n),l=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===c){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=o),h=Math.min(h,e.wtRootElement.scrollHeight),l.height="".concat(h,"px")}else l.height="";this.clone.wtTable.holder.style.height=l.height;var f=hn(this.clone.wtTable.TABLE);l.width="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(e=null==n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;return t&&r.offsetWidth!==r.clientWidth&&(o=kn(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Math.abs(on(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;return this.trimmingContainer!==e||t&&"horizontal"===t||(n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0),n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Yt(t,"emptyRows"):Gt(t,"emptyRows");var o=!1;if(r&&!n.length)Gt(t,"innerBorderLeft innerBorderInlineStart");else if(!r&&n.length){var l=zt(t,"innerBorderInlineStart");e?(Gt(t,"innerBorderLeft innerBorderInlineStart"),o=!l):(Yt(t,"innerBorderLeft innerBorderInlineStart"),o=l)}return o}}],o&&gs(r.prototype,o),l&&gs(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}(Tl);function Ss(e){return Ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ss(e)}function ks(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Os(e,p){return Os=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Os(e,p)}function Rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ts(e);if(t){var o=Ts(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Es(this,n)}}function Es(e,t){if(t&&("object"===Ss(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ts(e){return Ts=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ts(e)}var As=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Os(e,t)}(l,e);var t,n,r,o=Rs(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,ma)}return t=l,n&&ks(t.prototype,n),r&&ks(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(xa);ye(As,Pa),ye(As,is);var xs=As;function Ms(e){return Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ms(e)}function Ps(e,t,n){return Ps=Ds()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&Is(r,n.prototype),r},Ps.apply(null,arguments)}function _s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Is(e,p){return Is=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Is(e,p)}function Hs(e,t){if(t&&("object"===Ms(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return js(e)}function js(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ds(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ns(e){return Ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ns(e)}function Ls(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Is(e,t)}(h,e);var t,n,r,o,l,c=(t=h,n=Ds(),function(){var e,r=Ns(t);if(n){var o=Ns(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Hs(this,e)});function h(e,t,n,r,o,l){var f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),Ls(js(f=c.call(this,e,t,ma,n,r)),"topOverlay",void 0),Ls(js(f),"inlineStartOverlay",void 0),f.topOverlay=o,f.inlineStartOverlay=l,f}return r=h,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ps(xs,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();En(e,"".concat(t,"px"),"".concat(n,"px"))}else An(e);var r=fn(this.clone.wtTable.TABLE),o=hn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height="".concat(r,"px"),e.style.width="".concat(o,"px"),!1}}],o&&_s(r.prototype,o),l&&_s(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}(Tl);function Vs(e){return Vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vs(e)}function Fs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ws(e,p){return Ws=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Ws(e,p)}function Us(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gs(e);if(t){var o=Gs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zs(this,n)}}function zs(e,t){if(t&&("object"===Vs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Gs(e){return Gs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gs(e)}var Ys=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ws(e,t)}(l,e);var t,n,r,o=Us(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,ba)}return t=l,n&&Fs(t.prototype,n),r&&Fs(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(xa);ye(Ys,Ll),ye(Ys,is);var Ks=Ys;function Xs(e){return Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xs(e)}function $s(e,t,n){return $s=Zs()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&Qs(r,n.prototype),r},$s.apply(null,arguments)}function qs(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qs(e,p){return Qs=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Qs(e,p)}function Js(e,t){if(t&&("object"===Xs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function eu(e){return eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},eu(e)}var tu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qs(e,t)}(h,e);var t,n,r,o,l,c=(t=h,n=Zs(),function(){var e,r=eu(t);if(n){var o=eu(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Js(this,e)});function h(e,t,n,r,o,l){var f;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(f=c.call(this,e,t,ba,n,r)).bottomOverlay=o,f.inlineStartOverlay=l,f}return r=h,o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return $s(Ks,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]="".concat(n,"px"),t.style.bottom="".concat(r,"px")}else An(t),this.repositionOverlay();var o=fn(this.clone.wtTable.TABLE),l=hn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),t.style.height="".concat(o,"px"),t.style.width="".concat(l,"px"),!1}},{key:"repositionOverlay",value:function(){var e=this.wot.wtTable,t=this.domBindings.rootDocument,n=this.clone.wtTable.holder.parentNode,r=kn(t);e.holder.clientHeight===e.holder.offsetHeight&&(r=0),n.style.bottom="".concat(r,"px")}}],o&&qs(r.prototype,o),l&&qs(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}(Tl);function nu(e,t,n){return nu=ru()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&ou(r,n.prototype),r},nu.apply(null,arguments)}function ru(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ou(e,p){return ou=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},ou(e,p)}function iu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function au(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lu=function(){function e(t,n,r,o,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),au(this,"wot",null),au(this,"topOverlay",null),au(this,"bottomOverlay",null),au(this,"inlineStartOverlay",null),au(this,"topInlineStartCornerOverlay",null),au(this,"bottomInlineStartCornerOverlay",null),au(this,"browserLineHeight",void 0),au(this,"wtSettings",null),this.wot=t,this.wtSettings=o,this.domBindings=r,this.facadeGetter=n,this.wtTable=c;var h=this.domBindings,f=h.rootDocument,d=h.rootWindow;this.instance=this.wot,this.eventManager=l,this.scrollbarSize=kn(f);var y="hidden"===d.getComputedStyle(c.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=y?c.holder:an(c.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=d.scrollX,this.lastScrollY=d.scrollY}var t,n,r;return t=e,n=[{key:"initBrowserLineHeight",value:function(){var e=this.domBindings,t=e.rootWindow,n=e.rootDocument,r=t.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),l=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||l}},{key:"initOverlays",value:function(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=nu(Dl,e),this.bottomOverlay=nu(ts,e),this.inlineStartOverlay=nu(Cs,e),this.topInlineStartCornerOverlay=nu(Bs,e.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=nu(tu,e.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,o=this.topOverlay.mainTableScrollableElement,l=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),o!==l&&this.eventManager.addEventListener(l,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var c,h=r.devicePixelRatio&&r.devicePixelRatio>1,f=this.scrollableElement===r,d=this.wtSettings.getSetting("preventWheel"),y={passive:f};(d||h||!Me())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,d)}),y),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,d)}),y)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(c),c=setTimeout((function(){e.wtSettings.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==t&&o!==t&&!e.target.contains(r)||n!==t&&o!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,l=e.target,c=o!==n&&l!==n&&!l.contains(o),h=r!==n&&l!==n&&!l.contains(r);if(!this.keyPressed||!c&&!h){var f=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&f)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=$n(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);var r=this.scrollVertically(t),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.domBindings.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],l=r[1];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==l||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;var c=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;c&&(c.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=l),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=an(e.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtTable.spreader,n=t.clientWidth,r=t.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),l=t.getRowHeaderWidth(),c=t.getColumnHeaderHeight(),h=n.hider.style;if(h.width="".concat(l+this.inlineStartOverlay.sumCellSizes(0,r),"px"),h.height="".concat(c+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var f=n.wtRootElement,d=f.scrollHeight,y=f.scrollWidth,v=n.holder,m=v.scrollHeight,w=v.scrollWidth;this.hasScrollbarRight=d<m,this.hasScrollbarBottom=y<w,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>y?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>d&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(element){if(!element)return null;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],t=null;return $(e,(function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(element)&&(t=e.clone)})),t}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wtTable.TABLE;$([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}],n&&iu(t.prototype,n),r&&iu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),su=lu;function uu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hu=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),cu(this,"settings",{}),cu(this,"defaults",Object.freeze(this.getDefaults())),be(this.defaults,(function(e,r){if(void 0!==t[r])n.settings[r]=t[r];else{if(void 0===e)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=e}}))}var t,n,r;return t=e,(n=[{key:"getDefaults",value:function(){var e=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return e.getSetting("fixedColumnsStart")>0||e.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return e.getSetting("fixedRowsTop")>0||e.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return e.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,n,r){var o=e.getSetting("data",t,n);Jt(r,null==o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(e,t){var n=this;return void 0===t?be(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this}},{key:"getSetting",value:function(e,t,n,r,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"getSettingPure",value:function(e){return this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}])&&uu(t.prototype,n),r&&uu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function fu(e){return fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fu(e)}function du(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pu(e,p){return pu=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},pu(e,p)}function yu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vu(e);if(t){var o=vu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gu(this,n)}}function gu(e,t){if(t&&("object"===fu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vu(e){return vu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vu(e)}var mu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pu(e,t)}(l,e);var t,n,r,o=yu(l);function l(e,t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,e,t,n,r,"master")}return t=l,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=ln(this.wtRootElement),t=this.domBindings.rootWindow;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=e.parentElement,r=sn(e,"height",t),o=sn(e,"overflow",t),l=this.holder.style,c=e.scrollWidth,h=e.scrollHeight,f=e.getBoundingClientRect(),d=f.width,y=f.height;if(n&&["auto","hidden","scroll"].includes(o)){var v=e.cloneNode(!1);v.style.overflow="auto",e.nextElementSibling?n.insertBefore(v,e.nextElementSibling):n.appendChild(v);var m=parseInt(cn(v,t).height,10);n.removeChild(v),0===m&&(y=0)}y=Math.min(y,h),l.height="auto"===r?"auto":"".concat(y,"px"),d=Math.min(d,c),l.width="".concat(d,"px"),l.overflow="",this.hasTableHeight="auto"===l.height||y>0,this.hasTableWidth=d>0}this.isTableVisible=Zt(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport,n=e.getSetting("columnHeaders").length;if(n&&!t.hasOversizedColumnHeadersMarked.master){for(var r=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount(),i=0;i<n;i++)for(var l=-1*r;l<o;l++)this.markIfOversizedColumnHeader(l);t.hasOversizedColumnHeadersMarked.master=!0}}}])&&du(t.prototype,n),r&&du(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(xa);ye(mu,rs),ye(mu,Ia);var bu=mu;function wu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Su=new WeakMap,ku=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,l=t.itemSizeFn,c=t.overrideFn,h=t.calculationType,f=t.scrollbarHeight;wu(this,e),Su.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:l,overrideFn:c,calculationType:h,horizontalScrollbarHeight:f}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}var t,n,r;return t=e,r=[{key:"DEFAULT_HEIGHT",get:function(){return 23}}],(n=[{key:"calculate",value:function(){for(var t,n=0,r=!0,o=[],l=Su.get(this),c=l.calculationType,h=l.overrideFn,f=l.rowHeightFn,d=l.scrollOffset,y=l.totalRows,v=l.viewportHeight,m=l.horizontalScrollbarHeight||0,i=0;i<y;i++)if(t=f(i),isNaN(t)&&(t=e.DEFAULT_HEIGHT),n<=d&&2!==c&&(this.startRow=i),n>=d&&n+(2===c?t:0)<=d+v-m&&(null===this.startRow&&(this.startRow=i),this.endRow=i),o.push(n),n+=t,2!==c&&(this.endRow=i),n>=d+v-m){r=!1;break}if(this.endRow===y-1&&r)for(this.startRow=this.endRow;this.startRow>0;){var w=o[this.endRow]+t-o[this.startRow-1];if((w<=v-m||2!==c)&&(this.startRow-=1),w>=v-m)break}1===c&&null!==this.startRow&&h&&h(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),y<this.endRow&&(this.endRow=y-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}])&&Cu(t.prototype,n),r&&Cu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ou=ku;function Ru(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Tu=new WeakMap,Au=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,l=t.itemSizeFn,c=t.overrideFn,h=t.calculationType,f=t.stretchMode,d=t.stretchingItemWidthFn,y=void 0===d?function(e){return e}:d;Ru(this,e),Tu.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:o,columnWidthFn:l,overrideFn:c,calculationType:h,stretchingColumnWidthFn:y}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=f,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}var t,n,r;return t=e,r=[{key:"DEFAULT_WIDTH",get:function(){return 50}}],(n=[{key:"calculate",value:function(){for(var e,t=0,n=!0,r=[],o=Tu.get(this),l=o.calculationType,c=o.overrideFn,h=o.scrollOffset,f=o.totalColumns,d=o.viewportWidth,i=0;i<f;i++)if(e=this._getColumnWidth(i),t<=h&&2!==l&&(this.startColumn=i),t>=h&&t+(2===l?e:0)<=h+(h>0?d+1:d)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=i),this.endColumn=i),r.push(t),t+=e,2!==l&&(this.endColumn=i),t>=h+d){n=!1;break}if(this.endColumn===f-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var y=r[this.endColumn]+e-r[this.startColumn-1];if((y<=d||2!==l)&&(this.startColumn-=1),y>d)break}1===l&&null!==this.startColumn&&c&&c(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=Tu.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var l=this._getColumnWidth(i),c=n.stretchingColumnWidthFn(void 0,i);"number"==typeof c?t-=c:o+=l}var h=t-o;if("all"===this.stretch&&h>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var f=this._getColumnWidth(r-1),d=h+f;this.stretchLastWidth=d>=0?d:f}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=Tu.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var l=Math.round(t*this.stretchAllRatio),c=r.stretchingColumnWidthFn(l,e);this.stretchAllColumnsWidth[e]=void 0===c?l:isNaN(c)?this._getColumnWidth(e):c}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===Tu.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=Tu.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}])&&Eu(t.prototype,n),r&&Eu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),xu=Au;function Mu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Pu=function(){function e(t,n,r,o,l){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=l,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){c.clientHeight=c.getWorkspaceHeight()}))}var t,n,r;return t=e,n=[{key:"getWorkspaceHeight",value:function(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;return t===this.domBindings.rootWindow?e.documentElement.clientHeight:fn(t)>0&&t.clientHeight>0?t.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wtSettings,r=this.domBindings,o=r.rootDocument,l=r.rootWindow,c=this.dataAccessObject.inlineStartOverlayTrimmingContainer,h=o.documentElement.offsetWidth,f=n.getSetting("totalColumns"),d=n.getSetting("preventOverflow"),y=n.getSetting("rtlMode"),v=this.wtTable.TABLE.getBoundingClientRect(),m=h-(y?v.right-h:v.left);if(d)return hn(this.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(m,h):Math.min(this.getContainerFillWidth(),m,h),c===l&&f>0&&this.sumColumnWidths(0,f-1)>e)return o.documentElement.clientWidth;if(c!==l&&("scroll"===(t=sn(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",l))||"hidden"===t||"auto"===t))return Math.max(e,c.clientWidth);var w=n.getSetting("stretchH");return"none"!==w&&w?e:Math.max(e,hn(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=0,r=e;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return en(this.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return fn(this.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return hn(this.wtTable.TABLE)||hn(this.wtTable.TBODY)||hn(this.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=fn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var i=0,n=t.length;i<n;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(t.length){var r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var o=0,l=t.length;o<l;o++)r?(this.rowHeaderWidth+=hn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=this.wtSettings,l=this.wtTable;this.rowHeaderWidth=NaN,e=o.getSetting("renderAllRows")&&1===r?1/0:this.getViewportHeight();var c=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;c<0&&(c=0);var h=o.getSetting("fixedRowsTop"),f=o.getSetting("fixedRowsBottom"),d=o.getSetting("totalRows");return h&&(c+=n=this.dataAccessObject.topOverlay.sumCellSizes(0,h),e-=n),f&&this.dataAccessObject.bottomOverlay.clone&&(e-=n=this.dataAccessObject.bottomOverlay.sumCellSizes(d-f,d)),t=l.holder.clientHeight===l.holder.offsetHeight?0:kn(this.domBindings.rootDocument),new Ou({viewportSize:e,scrollOffset:c,totalItems:o.getSetting("totalRows"),itemSizeFn:function(e){return l.getRowHeight(e)},overrideFn:o.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.wtSettings,n=this.wtTable,r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN,o<0&&(o=0);var l=t.getSetting("fixedColumnsStart");if(l){var c=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,l);o+=c,r-=c}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=kn(this.domBindings.rootDocument)),new xu({viewportSize:r,scrollOffset:Math.abs(o),totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return n.getColumnWidth(e)},overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(2),r=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow,r=this.rowsRenderCalculator,o=r.startRow,l=r.endRow;return!(t<o||t===o&&t>0||n>l||n===l&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn,r=this.columnsRenderCalculator,o=r.startColumn,l=r.endColumn;return!(t<o||t===o&&t>0||n>l||n===l&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){be(this.hasOversizedColumnHeadersMarked,(function(e,t,object){object[t]=void 0}))}}],n&&Mu(t.prototype,n),r&&Mu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),_u=Pu;function Iu(e){return Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iu(e)}function Hu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ju(e,p){return ju=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},ju(e,p)}function Du(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bu(e);if(t){var o=Bu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nu(this,n)}}function Nu(e,t){if(t&&("object"===Iu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Lu(e)}function Lu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bu(e){return Bu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bu(e)}var Vu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ju(e,t)}(l,e);var t,n,r,o=Du(l);function l(table,e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var n=(t=o.call(this,table,new hu(e))).wtSettings.getSetting("facade",Lu(t));return t.wtTable=new bu(t.getTableDao(),n,t.domBindings,t.wtSettings),t.wtViewport=new _u(t.getViewportDao(),t.domBindings,t.wtSettings,t.eventManager,t.wtTable),t.selections=t.wtSettings.getSetting("selections"),t.wtEvent=new Jo(n,t.domBindings,t.wtSettings,t.eventManager,t.wtTable,t.selections),t.wtOverlays=new su(Lu(t),n,t.domBindings,t.wtSettings,t.eventManager,t.wtTable),t.exportSettingsAsClassNames(),t.findOriginalHeaders(),t}return t=l,(n=[{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],n=[];be({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(r,o){e.wtSettings.getSetting(o).length&&n.push(r),t.push(r)})),Yt(this.wtTable.wtRootElement.parentNode,t),Gt(this.wtTable.wtRootElement.parentNode,n)}},{key:"getViewportDao",value:function(){var e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}])&&Hu(t.prototype,n),r&&Hu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(gl);function Fu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof gl?this._wot=t:this._initFromSettings(t)}var t,n,r;return t=e,n=[{key:"_initFromSettings",value:function(t){t.facade=function(t){var n=new e(t);return function(){return n}},this._wot=new Vu(t.table,t)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(e){this._wot.drawn=e}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(e){this._wot.drawInterrupted=e}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(e){this._wot.lastMouseOver=e}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(e){this._wot.momentumScrolling=e}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(e){this._wot.touchApplied=e}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(e){this._wot.eventListeners=e}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(e,t){return this._wot.createCellCoords(e,t)}},{key:"createCellRange",value:function(e,t,n){return this._wot.createCellRange(e,t,n)}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wot.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(e,t){return this._wot.wtSettings.update(e,t),this}},{key:"getSetting",value:function(e,t,n,r,o){return this._wot.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this._wot.wtSettings.hasSetting(e)}},{key:"destroy",value:function(){this._wot.destroy()}}],n&&Fu(t.prototype,n),r&&Fu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Uu(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,o=e.coords,l=e.selection,c=e.controller,h=e.cellCoordsFactory,f=l.isSelected()?l.getSelectedRange().current():null,d=l.isSelectedByCorner(),y=l.isSelectedByRowHeader();if(t&&f)o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(o):(d||y)&&o.row>=0&&o.col>=0&&!c.cell?l.setRangeEnd(h(o.row,o.col)):d&&o.row<0&&!c.column?l.setRangeEnd(h(f.to.row,o.col)):y&&o.col<0&&!c.row?l.setRangeEnd(h(o.row,f.to.col)):(!d&&!y&&o.col<0||d&&o.col<0)&&!c.row?l.selectRows(Math.max(f.from.row,0),o.row,o.col):(!d&&!y&&o.row<0||y&&o.row<0)&&!c.column&&l.selectColumns(Math.max(f.from.col,0),o.col,o.row);else{var v=!l.inInSelection(o),m=n||r&&v;o.row<0&&o.col>=0&&!c.column?m&&l.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!c.row?m&&l.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!c.cell?m&&l.setRangeStart(o):o.col<0&&o.row<0&&l.selectAll(!0,!0)}}var zu=new Map([["mousedown",Uu],["mouseover",function(e){var t=e.isLeftClick,n=e.coords,r=e.selection,o=e.controller,l=e.cellCoordsFactory;if(t){var c=r.isSelectedByRowHeader(),h=r.isSelectedByColumnHeader(),f=r.tableProps.countCols(),d=r.tableProps.countRows();h&&!o.column?r.setRangeEnd(l(d-1,n.col)):c&&!o.row?r.setRangeEnd(l(n.row,f-1)):o.cell||r.setRangeEnd(n)}}],["touchstart",Uu]]);function Gu(e,t){var n=t.coords,r=t.selection,o=t.controller,l=t.cellCoordsFactory;zu.get(e.type)({coords:n,selection:r,controller:o,cellCoordsFactory:l,isShiftKey:e.shiftKey,isLeftClick:Zn(e)||"touchstart"===e.type,isRightClick:Jn(e)})}var Yu=new WeakMap,Ku=Symbol("rootInstance");function Xu(object){Yu.set(object,!0)}function $u(e){return e===Ku}function qu(object){return Yu.has(object)}function Qu(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||Zu(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ju(e){return function(e){if(Array.isArray(e))return ec(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Zu(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zu(e,t){if(e){if("string"==typeof e)return ec(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ec(e,t):void 0}}function ec(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function tc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var nc=new WeakMap,rc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new Hr(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this._wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,nc.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var t,n,r;return t=e,n=[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var td=this._wt.getCell(e,t);return td<0?null:td}},{key:"scrollViewport",value:function(e,t,n,r,o){return this._wt.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=nc.get(this),t=this.instance,n=t.rootElement,r=t.rootDocument,o=n.getAttribute("style");o&&n.setAttribute("data-originalstyle",o),Gt(n,"handsontable"),e.table=r.createElement("TABLE"),Gt(e.table,"htCore"),this.instance.getSettings().tableClassName&&Gt(e.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=nc.get(this),n=this.instance,r=n.rootElement,o=n.rootDocument,l=n.selection,c=o.documentElement;this.eventManager.addEventListener(r,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var r=e.instance.rootWindow;wn(r),n.preventDefault(),r.focus()}})),this.eventManager.addEventListener(r,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(r,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&wn(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(c,"keyup",(function(e){l.isInProgress()&&!e.shiftKey&&l.finish()})),this.eventManager.addEventListener(c,"mouseup",(function(n){l.isInProgress()&&Zn(n)&&l.finish(),t.mouseDown=!1,!Mn(o.activeElement)&&(l.isSelected()||l.isSelectedByAnyHeader()||r.contains(n.target)||Jn(n))||e.instance.unlisten()})),this.eventManager.addEventListener(c,"contextmenu",(function(e){l.isInProgress()&&Jn(e)&&(l.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(c,"touchend",(function(){l.isInProgress()&&l.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(c,"mousedown",(function(n){var l=n.target,h=n.x||n.clientX,f=n.y||n.clientY,d=n.target;if(!t.mouseDown&&r&&e.instance.view){var y=e.instance.view._wt.wtTable.holder;if(d===y){var v=kn(o);if(o.elementFromPoint(h+v,f)!==y||o.elementFromPoint(h,f+v)!==y)return}else for(;d!==c;){if(null===d){if(n.isTargetWebComponent)break;return}if(d===r)return;d=d.parentNode}("function"==typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(l):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||xn(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t,n=e.row,col=e.col;return(t=this.instance)._createCellCoords.apply(t,Ju(this.translateFromRenderableToVisualIndex(n,col)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getFirstNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var o=n.getFirstNotHiddenIndex(e,t),l=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(l))return 0;var c=0;return t<0?c=l+1:t>0&&(c=r-l),c}},{key:"countNotHiddenFixedColumnsStart",value:function(){var e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}},{key:"initializeWalkontable",value:function(){var e=this,t=nc.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return qu(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,Ju(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsStart:function(){return e.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return e.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return e.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return e.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var o=Qu(e.translateFromRenderableToVisualIndex(t,n),2),l=o[0],c=o[1],h=e.instance.runHooks("modifyGetCellCoords",l,c),f=l,d=c;if(Array.isArray(h)){var y=Qu(h,2);f=y[0],d=y[1]}var v=e.instance.getCellMeta(f,d),m=e.instance.colToProp(d),w=e.instance.getDataAtRowProp(f,m);e.instance.hasHook("beforeValueRender")&&(w=e.instance.runHooks("beforeValueRender",w,v)),e.instance.runHooks("beforeRenderer",r,l,c,m,w,v),e.instance.getCellRenderer(v)(e.instance,r,l,c,m,w,v),e.instance.runHooks("afterRenderer",r,l,c,m,w,v)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,l){var c=e.translateFromRenderableToVisualCoords(r),h={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=l,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,c,o,h),Qn(n)||(Gu(n,{coords:c,selection:e.instance.selection,controller:h,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseDown",n,c,o),e.activeWt=e._wt)},onCellContextMenu:function(n,r,o,l){var c=e.translateFromRenderableToVisualCoords(r);e.activeWt=l,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,c,o),Qn(n)||(e.instance.runHooks("afterOnCellContextMenu",n,c,o),e.activeWt=e._wt)},onCellMouseOut:function(t,n,r,o){var l=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,l,r),Qn(t)||(e.instance.runHooks("afterOnCellMouseOut",t,l,r),e.activeWt=e._wt)},onCellMouseOver:function(n,r,o,l){var c=e.translateFromRenderableToVisualCoords(r),h={row:!1,column:!1,cell:!1};e.activeWt=l,e.instance.runHooks("beforeOnCellMouseOver",n,c,o,h),Qn(n)||(t.mouseDown&&Gu(n,{coords:c,selection:e.instance.selection,controller:h,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseOver",n,c,o),e.activeWt=e._wt)},onCellMouseUp:function(t,n,r,o){var l=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,l,r),Qn(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,l,r),e.activeWt=e._wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.afterRender(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,r){var o=e.instance.rowIndexMapper,l=o.getVisualFromRenderableIndex(t),c=e.instance.runHooks("beforeHighlightingRowHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:function(t,n,r){var o=e.instance.columnIndexMapper,l=o.getVisualFromRenderableIndex(t),c=e.instance.runHooks("beforeHighlightingColumnHeader",l,n,r);return o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(c,1))},onAfterDrawSelection:function(t,n,r){var o,l=Qu(e.translateFromRenderableToVisualIndex(t,n),2),c=l[0],h=l[1],f=e.instance.selection.getSelectedRange(),d=f.size();if(d>0){var y=(null!=r?r:0)+1-d,v=f.peekByIndex(y);o=[v.from.row,v.from.col,v.to.row,v.to.col]}return e.instance.runHooks("afterDrawSelection",c,h,o,r)},onBeforeDrawBorders:function(t,n){var r=Qu(t,4),o=r[0],l=r[1],c=r[2],h=r[3],f=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l),e.instance.rowIndexMapper.getVisualFromRenderableIndex(c),e.instance.columnIndexMapper.getVisualFromRenderableIndex(h)];return e.instance.runHooks("beforeDrawBorders",f,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var o=e.instance.rowIndexMapper,l=e.instance.columnIndexMapper,c=n>=0?l.getVisualFromRenderableIndex(n):n,h=t>=0?o.getVisualFromRenderableIndex(t):t,f=e.instance.runHooks("modifyGetCellCoords",h,c,r);if(Array.isArray(f)){var d=Qu(f,4),y=d[0],v=d[1],m=d[2],w=d[3];return[y>=0?o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(y,1)):y,v>=0?l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(v,1)):v,m>=0?o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(m,-1)):m,w>=0?l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows(),o=t.startRow,l=t.endRow;if("number"==typeof n)t.startRow=Math.max(o-n,0),t.endRow=Math.min(l+n,r-1);else if("auto"===n){var c=Math.ceil(l/r*12);t.startRow=Math.max(o-c,0),t.endRow=Math.min(l+c,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns(),o=t.startColumn,l=t.endColumn;if("number"==typeof n&&(t.startColumn=Math.max(o-n,0),t.endColumn=Math.min(l+n,r-1)),"auto"===n){var c=Math.ceil(l/r*6);t.startColumn=Math.max(o-c,0),t.endColumn=Math.min(l+c,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new Wu(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),l=o.width,c=o.height;this.setLastSize(l,c),this.eventManager.addEventListener(r,"mousedown",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e._wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(xn(e))return!0;var t=Lt(e,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return nc.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!zt(n,"relative"))return Xt(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var r=this.instance,o=r.rootDocument,l=r.getRowHeader,div=o.createElement("div"),span=o.createElement("span");div.className="relative",span.className="rowHeader",this.updateCellHeader(span,e,l),div.appendChild(span),t.appendChild(div)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;zt(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):(Xt(t),this.appendColHeader(e,t))}else{var r=this.instance.rootDocument,div=r.createElement("div"),span=r.createElement("span");div.className="relative",span.className="colHeader",this.updateCellHeader(span,e,this.instance.getColHeader),div.appendChild(span),t.appendChild(div)}this.instance.runHooks("afterGetColHeader",e,t)}},{key:"updateCellHeader",value:function(element,e,content){var t=e,n=this._wt.wtOverlays.getParentOverlay(element)||this._wt;element.parentNode&&(zt(element,"colHeader")?t=n.wtTable.columnFilter.sourceToRendered(e):zt(element,"rowHeader")&&(t=n.wtTable.rowFilter.sourceToRendered(e))),t>-1?Qt(element,content(e)):(Jt(element,String.fromCharCode(160)),Gt(element,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var n=nc.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=nc.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}],n&&tc(t.prototype,n),r&&tc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),oc=rc,ic=vr("cellTypes"),ac=ic.register,lc=ic.getItem,sc=ic.hasItem,uc=ic.getNames;ic.getValues;function cc(e){if(!sc(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return lc(e)}function hc(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);var n=t,r=n.editor,o=n.renderer,l=n.validator;r&&Ar(e,r),o&&Vo(e,o),l&&Ko(e,l),ac(e,t)}function fc(e){return fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fc(e)}var dc="ABCDEFGHIJKLMNOPQRSTUVWXYZ",pc=dc.length;function yc(e){for(var t,n=e+1,r="";n>0;)t=(n-1)%pc,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/pc,10);return r}function gc(label){var e=0;if(label)for(var i=0,t=label.length-1;i<label.length;i+=1,t-=1)e+=Math.pow(pc,t)*(dc.indexOf(label[i])+1);return e-=1}function vc(){var i,e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(i=0;i<t;i++){var o=[];for(e=0;e<n;e++)o.push(yc(e)+(i+1));r.push(o)}return r}function mc(){var i,e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(i=0;i<t;i++){var o={};for(e=0;e<n;e++)o["prop".concat(e)]=yc(e)+(i+1);r.push(o)}return r}function bc(e,t){for(var n,data=[],i=0;i<e;i++){n=[];for(var r=0;r<t;r++)n.push("");data.push(n)}return data}function wc(e,t){var n=void 0===t||t;return function(t,col){return function t(r){if(r){if(Oe(r,e)&&void 0!==r[e])return r[e];if(Oe(r,"type")&&r.type){if("string"!=typeof r.type)throw new Error('Cell "type" must be a string');var o=cc(r.type);if(Oe(o,e))return o[e];if(n)return}return t(Object.getPrototypeOf(r))}}("number"==typeof t?this.getCellMeta(t,col):t)}}function Cc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((function(e,n){Array.isArray(e)?e.forEach((function(e,o){r.push([n+t,o,e])})):Object.keys(e).forEach((function(o){r.push([n+t,o,e[o]])}))})),r}function Sc(data){var e=0;return Array.isArray(data)&&(data[0]&&Array.isArray(data[0])?e=data[0].length:data[0]&&ve(data[0])&&(e=Se(data[0]))),e}function kc(data){return!!(Array.isArray(data)&&data.length&&data.every((function(e){return Array.isArray(e)})))}function Oc(data){return!!(Array.isArray(data)&&data.length&&data.every((function(e){return"object"===fc(e)&&!Array.isArray(e)&&null!==e})))}function Rc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ec(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Tc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Rc(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var t,n,r;return t=e,n=[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(data){this.data=data}},{key:"getAtColumn",value:function(e){var t=this,n=[];return $(this.data,(function(r,o){var l=t.getAtCell(o,e);n.push(l)})),n}},{key:"getAtRow",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=void 0===t&&void 0===n,c=null,h=null;if(c=this.modifyRowData(e),Array.isArray(c))h=[],l?c.forEach((function(t,n){h[n]=r.getAtPhysicalCell(e,n,c)})):no(t,n,(function(n){h[n-t]=r.getAtPhysicalCell(e,n,c)}));else if(ve(c)||In(c))if(h=o?[]:{},!l||o){var f=0,d=this.countFirstRowKeys()-1;no(f,d,(function(l){var y=r.colToProp(l);if(l>=(t||f)&&l<=(n||d)&&!Number.isInteger(y)){var v=r.getAtPhysicalCell(e,y,c);o?h.push(v):Ce(h,y,v)}}))}else be(c,(function(t,n){Ce(h,n,r.getAtPhysicalCell(e,n,c))}));return h}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=ke(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(t)?this.data[e][t]=n:Ce(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var r=null;if(n&&(r="string"==typeof t?we(n,t):"function"==typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var o=ke(r);this.hot.runHooks("modifySourceData",e,this.colToProp(t),o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,l=null,c=null,h=null,f=null;null===t||null===n?(o=!0,l=0,h=this.countRows()-1):(l=Math.min(t.row,n.row),c=Math.min(t.col,n.col),h=Math.max(t.row,n.row),f=Math.max(t.col,n.col));var d=[];return no(l,h,(function(t){d.push(o?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,c,f,r))})),d}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Sc(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}],n&&Ec(t.prototype,n),r&&Ec(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ac=Tc,xc=(n(504),n(500),{_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,n,r,o,l,c){if(this._localHooks[e])for(var h=this._localHooks[e].length,i=0;i<h;i++)Fn(this._localHooks[e][i],this,t,n,r,o,l,c)},clearLocalHooks:function(){return this._localHooks={},this}});me(xc,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});var Mc=xc;function Pc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ic=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Pc(this,e),this.indexedValues=[],this.initValueOrFn=t}var t,n,r;return t=e,n=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,In(this.initValueOrFn)?no(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):no(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}],n&&_c(t.prototype,n),r&&_c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Hc(e){return function(e){if(Array.isArray(e))return jc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jc(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jc(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Dc(e,t,n){return[].concat(Hc(e.slice(0,t)),Hc(n),Hc(e.slice(t)))}function Nc(e,t){return K(e,(function(e){return!1===t.includes(e)}))}function Lc(e,t){return X(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function Bc(e,t){var n=t[0],r=t.length;return X(e,(function(e){return e>=n?e+r:e}))}function Vc(e){return Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vc(e)}function Fc(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wc(){return Wc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Uc(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Wc.apply(this,arguments)}function Uc(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Kc(object)););return object}function zc(e,p){return zc=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},zc(e,p)}function Gc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Kc(e);if(t){var o=Kc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yc(this,n)}}function Yc(e,t){if(t&&("object"===Vc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Kc(e){return Kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kc(e)}ye(Ic,Mc);var Xc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zc(e,t)}(l,e);var t,n,r,o=Gc(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,(function(e){return e}))}return t=l,(n=[{key:"insert",value:function(e,t){var n=Bc(this.indexedValues,t);this.indexedValues=Dc(n,e,t),Wc(Kc(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=Nc(this.indexedValues,e);this.indexedValues=Lc(t,e),Wc(Kc(l.prototype),"remove",this).call(this,e)}}])&&Fc(t.prototype,n),r&&Fc(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ic);function $c(e){return function(e){if(Array.isArray(e))return qc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return qc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qc(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qc(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Qc(e,t,n,r){var o=n.length?n[0]:void 0;return[].concat($c(e.slice(0,o)),$c(n.map((function(e,t){return In(r)?r(e,t):r}))),$c(void 0===o?[]:e.slice(o)))}function Jc(e,t){return K(e,(function(e,n){return!1===t.includes(n)}))}function Zc(e){return Zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zc(e)}function eh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rh(){return rh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=oh(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},rh.apply(this,arguments)}function oh(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=sh(object)););return object}function ih(e,p){return ih=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},ih(e,p)}function ah(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sh(e);if(t){var o=sh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lh(this,n)}}function lh(e,t){if(t&&("object"===Zc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sh(e){return sh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sh(e)}var uh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ih(e,t)}(l,e);var t,n,r,o=ah(l);function l(){return eh(this,l),o.apply(this,arguments)}return t=l,(n=[{key:"insert",value:function(e,t){this.indexedValues=Qc(this.indexedValues,0,t,this.initValueOrFn),rh(sh(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Jc(this.indexedValues,e),rh(sh(l.prototype),"remove",this).call(this,e)}}])&&nh(t.prototype,n),r&&nh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ic);function ch(e){return ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(e)}function hh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dh(e,p){return dh=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},dh(e,p)}function ph(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gh(e);if(t){var o=gh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yh(this,n)}}function yh(e,t){if(t&&("object"===ch(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gh(e){return gh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gh(e)}var vh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dh(e,t)}(l,e);var t,n,r,o=ph(l);function l(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return hh(this,l),o.call(this,e)}return t=l,(n=[{key:"getHiddenIndexes",value:function(){return Y(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&fh(t.prototype,n),r&&fh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(uh);function mh(e){return mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mh(e)}function bh(e){return function(e){if(Array.isArray(e))return wh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return wh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wh(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wh(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ch(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kh(){return kh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Oh(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},kh.apply(this,arguments)}function Oh(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=xh(object)););return object}function Rh(e,p){return Rh=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Rh(e,p)}function Eh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=xh(e);if(t){var o=xh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Th(this,n)}}function Th(e,t){if(t&&("object"===mh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ah(e)}function Ah(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xh(e){return xh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xh(e)}function Mh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ph=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rh(e,t)}(l,e);var t,n,r,o=Eh(l);function l(){var e;Ch(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Mh(Ah(e=o.call.apply(o,[this].concat(n))),"orderOfIndexes",[]),e}return t=l,n=[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return e.indexedValues[t]}))}},{key:"setValues",value:function(e){this.orderOfIndexes=bh(Array(e.length).keys()),kh(xh(l.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=Nc(this.orderOfIndexes,[e]),In(this.initValueOrFn)?kh(xh(l.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):kh(xh(l.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,kh(xh(l.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=Qc(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=Bc(this.orderOfIndexes,t),kh(xh(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=Jc(this.indexedValues,e),this.orderOfIndexes=Nc(this.orderOfIndexes,e),this.orderOfIndexes=Lc(this.orderOfIndexes,e),kh(xh(l.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return[t,e.getValueAtIndex(t)]}))}}],n&&Sh(t.prototype,n),r&&Sh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ic);function _h(e){return _h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(e)}function Ih(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jh(e,p){return jh=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},jh(e,p)}function Dh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lh(e);if(t){var o=Lh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nh(this,n)}}function Nh(e,t){if(t&&("object"===_h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lh(e){return Lh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lh(e)}var Bh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jh(e,t)}(l,e);var t,n,r,o=Dh(l);function l(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Ih(this,l),o.call(this,e)}return t=l,(n=[{key:"getTrimmedIndexes",value:function(){return Y(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&Hh(t.prototype,n),r&&Hh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(uh),Vh=new Map([["hiding",vh],["index",Ic],["linkedPhysicalIndexToValue",Ph],["physicalIndexToValue",uh],["trimming",Bh]]);function Fh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wh=0,Uh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.collection=new Map}var t,n,r;return t=e,(n=[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),Wh+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);it(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Wh-=1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach((function(t,n){return e.unregister(n)})),this.collection.clear()}},{key:"get",value:function(e){return at(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}])&&Fh(t.prototype,n),r&&Fh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function zh(e){return zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zh(e)}function Gh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yh(e,p){return Yh=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Yh(e,p)}function Kh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$h(e);if(t){var o=$h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xh(this,n)}}function Xh(e,t){if(t&&("object"===zh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $h(e){return $h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$h(e)}ye(Uh,Mc);var qh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yh(e,t)}(l,e);var t,n,r,o=Kh(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this)).mergedValuesCache=[],n.aggregationFunction=e,n.fallbackValue=t,n}return t=l,n=[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=X(this.get(),(function(map){return map.getValues()})),n=[],r=it(t[0])&&t[0].length||0,o=0;o<r;o+=1){for(var l=[],c=0;c<this.getLength();c+=1)l.push(t[c][o]);n.push(l)}return X(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return it(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}],n&&Gh(t.prototype,n),r&&Gh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Uh);function Qh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jh(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Zh(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,ef(e,t,"set"),n),n}function ef(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var tf=new WeakMap,nf=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Jh(this,tf,{writable:!0,value:[]})}var t,n,r;return t=e,(n=[{key:"subscribe",value:function(e){var t;return this.addLocalHook("change",e),this._write(function(e,t){return t.get?t.get.call(e):t.value}(t=this,ef(t,tf,"get"))),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){Zh(this,tf,e)}}])&&Qh(t.prototype,n),r&&Qh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rf(e,t){for(var n=[],i=0,r=0;i<e.length&&r<t.length;i++,r++)e[i]!==t[r]&&n.push({op:"replace",index:r,oldValue:e[i],newValue:t[r]});for(;i<t.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:t[i]});for(;r<e.length;r++)n.push({op:"remove",index:r,oldValue:e[r],newValue:void 0});return n}function of(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function af(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lf(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function sf(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,cf(e,t,"get"))}function uf(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,cf(e,t,"set"),n),n}function cf(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}ye(nf,Mc);var hf=new WeakMap,ff=new WeakMap,df=new WeakMap,pf=new WeakMap,yf=new WeakMap,gf=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialIndexValue;of(this,e),lf(this,hf,{writable:!0,value:new Set}),lf(this,ff,{writable:!0,value:[]}),lf(this,df,{writable:!0,value:[]}),lf(this,pf,{writable:!0,value:!1}),lf(this,yf,{writable:!0,value:!1}),uf(this,yf,null!=n&&n)}var t,n,r;return t=e,(n=[{key:"createObserver",value:function(){var e=this,t=new nf;return sf(this,hf).add(t),t.addLocalHook("unsubscribe",(function(){sf(e,hf).delete(t)})),t._writeInitialChanges(rf(sf(this,ff),sf(this,df))),t}},{key:"emit",value:function(e){var t=sf(this,df);sf(this,pf)&&sf(this,ff).length===e.length||(0===e.length?e=new Array(t.length).fill(sf(this,yf)):uf(this,ff,new Array(e.length).fill(sf(this,yf))),sf(this,pf)||(uf(this,pf,!0),t=sf(this,ff)));var n=rf(t,e);sf(this,hf).forEach((function(e){return e._write(n)})),uf(this,df,e)}}])&&af(t.prototype,n),r&&af(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function vf(e){return function(e){if(Array.isArray(e))return mf(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return mf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mf(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mf(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function bf(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var wf,Cf=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexesSequence=new Xc,this.trimmingMapsCollection=new qh((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new qh((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new Uh,this.hidingChangesObservable=new gf({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}var t,n,r;return t=e,n=[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Vh.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(Vh.get(e))(t)}(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof Bh?this.trimmingMapsCollection.register(e,t):t instanceof vh?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return it(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return it(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return it(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return it(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t,o=this.getPhysicalFromVisualIndex(e);return null===o?!0===n&&r!==e-t?this.getFirstNotHiddenIndex(r,-t,!1,r):null:!1===this.isHidden(o)?e:this.getFirstNotHiddenIndex(e+t,t,n,r)}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=vf(new Array(e).keys()),this.notHiddenIndexesCache=vf(new Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(e){var t=this.getNumberOfIndexes();if(e<t){var n=vf(Array(this.getNumberOfIndexes()-e).keys()).map((function(i){return i+e}));this.removeIndexes(n)}else this.insertIndexes(t,e-t)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"==typeof e&&(e=[e]);var r=X(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),o=this.getNotTrimmedIndexesLength(),l=e.length,c=Nc(this.getIndexesSequence(),r),h=o-l;if(t+l<o){var f=c.filter((function(e){return!1===n.isTrimmed(e)}))[t];h=c.indexOf(f)}this.setIndexesSequence(Dc(c,h,r))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],r=it(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),l=X(new Array(t).fill(r),(function(e,t){return e+t}));this.suspendOperations(),this.indexesSequence.insert(o,l),this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}],n&&bf(t.prototype,n),r&&bf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Sf(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function kf(e){it(e)&&nr(et(wf||(wf=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),e))}ye(Cf,Mc);var Of=vr("phraseFormatters"),Rf=Of.register,Ef=Of.getValues;Rf("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));var Tf,Af="ContextMenu:items",xf="".concat(Af,".noItems"),Mf="".concat(Af,".insertRowAbove"),Pf="".concat(Af,".insertRowBelow"),_f="".concat(Af,".insertColumnOnTheLeft"),If="".concat(Af,".insertColumnOnTheRight"),Hf="".concat(Af,".removeRow"),jf="".concat(Af,".removeColumn"),Df="".concat(Af,".undo"),Nf="".concat(Af,".redo"),Lf="".concat(Af,".readOnly"),Bf="".concat(Af,".clearColumn"),Vf="".concat(Af,".copy"),Ff="".concat(Af,".cut"),Wf="".concat(Af,".freezeColumn"),Uf="".concat(Af,".unfreezeColumn"),zf="".concat(Af,".mergeCells"),Gf="".concat(Af,".unmergeCells"),Yf="".concat(Af,".addComment"),Kf="".concat(Af,".editComment"),Xf="".concat(Af,".removeComment"),$f="".concat(Af,".readOnlyComment"),qf="".concat(Af,".align"),Qf="".concat(Af,".align.left"),Jf="".concat(Af,".align.center"),Zf="".concat(Af,".align.right"),ed="".concat(Af,".align.justify"),nd="".concat(Af,".align.top"),rd="".concat(Af,".align.middle"),od="".concat(Af,".align.bottom"),id="".concat(Af,".borders"),ad="".concat(Af,".borders.top"),ld="".concat(Af,".borders.right"),sd="".concat(Af,".borders.bottom"),ud="".concat(Af,".borders.left"),cd="".concat(Af,".borders.remove"),hd="".concat(Af,".nestedHeaders.insertChildRow"),fd="".concat(Af,".nestedHeaders.detachFromParent"),pd="".concat(Af,".hideColumn"),yd="".concat(Af,".showColumn"),gd="".concat(Af,".hideRow"),vd="".concat(Af,".showRow"),md="Filters:",bd="".concat(md,"conditions"),wd="".concat(bd,".none"),Cd="".concat(bd,".isEmpty"),Sd="".concat(bd,".isNotEmpty"),kd="".concat(bd,".isEqualTo"),Od="".concat(bd,".isNotEqualTo"),Rd="".concat(bd,".beginsWith"),Ed="".concat(bd,".endsWith"),Td="".concat(bd,".contains"),Ad="".concat(bd,".doesNotContain"),xd="".concat(bd,".byValue"),Md="".concat(bd,".greaterThan"),Pd="".concat(bd,".greaterThanOrEqualTo"),_d="".concat(bd,".lessThan"),Id="".concat(bd,".lessThanOrEqualTo"),Hd="".concat(bd,".isBetween"),jd="".concat(bd,".isNotBetween"),Dd="".concat(bd,".after"),Nd="".concat(bd,".before"),Ld="".concat(bd,".today"),Bd="".concat(bd,".tomorrow"),Vd="".concat(bd,".yesterday"),Fd="".concat(md,"labels.filterByCondition"),Wd="".concat(md,"labels.filterByValue"),Ud="".concat(md,"labels.conjunction"),zd="".concat(md,"labels.disjunction"),Gd="".concat(md,"values.blankCells"),Yd="".concat(md,"buttons.selectAll"),Kd="".concat(md,"buttons.clear"),Xd="".concat(md,"buttons.ok"),$d="".concat(md,"buttons.cancel"),qd="".concat(md,"buttons.placeholder.search"),Qd="".concat(md,"buttons.placeholder.value"),Jd="".concat(md,"buttons.placeholder.secondValue");function Zd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ep=(Zd(Tf={languageCode:"en-US"},xf,"No available options"),Zd(Tf,Mf,"Insert row above"),Zd(Tf,Pf,"Insert row below"),Zd(Tf,_f,"Insert column left"),Zd(Tf,If,"Insert column right"),Zd(Tf,Hf,["Remove row","Remove rows"]),Zd(Tf,jf,["Remove column","Remove columns"]),Zd(Tf,Df,"Undo"),Zd(Tf,Nf,"Redo"),Zd(Tf,Lf,"Read only"),Zd(Tf,Bf,"Clear column"),Zd(Tf,qf,"Alignment"),Zd(Tf,Qf,"Left"),Zd(Tf,Jf,"Center"),Zd(Tf,Zf,"Right"),Zd(Tf,ed,"Justify"),Zd(Tf,nd,"Top"),Zd(Tf,rd,"Middle"),Zd(Tf,od,"Bottom"),Zd(Tf,Wf,"Freeze column"),Zd(Tf,Uf,"Unfreeze column"),Zd(Tf,id,"Borders"),Zd(Tf,ad,"Top"),Zd(Tf,ld,"Right"),Zd(Tf,sd,"Bottom"),Zd(Tf,ud,"Left"),Zd(Tf,cd,"Remove border(s)"),Zd(Tf,Yf,"Add comment"),Zd(Tf,Kf,"Edit comment"),Zd(Tf,Xf,"Delete comment"),Zd(Tf,$f,"Read-only comment"),Zd(Tf,zf,"Merge cells"),Zd(Tf,Gf,"Unmerge cells"),Zd(Tf,Vf,"Copy"),Zd(Tf,Ff,"Cut"),Zd(Tf,hd,"Insert child row"),Zd(Tf,fd,"Detach from parent"),Zd(Tf,pd,["Hide column","Hide columns"]),Zd(Tf,yd,["Show column","Show columns"]),Zd(Tf,gd,["Hide row","Hide rows"]),Zd(Tf,vd,["Show row","Show rows"]),Zd(Tf,wd,"None"),Zd(Tf,Cd,"Is empty"),Zd(Tf,Sd,"Is not empty"),Zd(Tf,kd,"Is equal to"),Zd(Tf,Od,"Is not equal to"),Zd(Tf,Rd,"Begins with"),Zd(Tf,Ed,"Ends with"),Zd(Tf,Td,"Contains"),Zd(Tf,Ad,"Does not contain"),Zd(Tf,Md,"Greater than"),Zd(Tf,Pd,"Greater than or equal to"),Zd(Tf,_d,"Less than"),Zd(Tf,Id,"Less than or equal to"),Zd(Tf,Hd,"Is between"),Zd(Tf,jd,"Is not between"),Zd(Tf,Dd,"After"),Zd(Tf,Nd,"Before"),Zd(Tf,Ld,"Today"),Zd(Tf,Bd,"Tomorrow"),Zd(Tf,Vd,"Yesterday"),Zd(Tf,Gd,"Blank cells"),Zd(Tf,Fd,"Filter by condition"),Zd(Tf,Wd,"Filter by value"),Zd(Tf,Ud,"And"),Zd(Tf,zd,"Or"),Zd(Tf,Yd,"Select all"),Zd(Tf,Kd,"Clear"),Zd(Tf,Xd,"OK"),Zd(Tf,$d,"Cancel"),Zd(Tf,qd,"Search"),Zd(Tf,Qd,"Value"),Zd(Tf,Jd,"Second value"),Tf),tp=ep.languageCode,np=vr("languagesDictionaries"),op=np.register,ip=np.getItem,ap=np.hasItem,lp=np.getValues;function sp(e,t){var n=e,r=t;return ve(e)&&(n=(r=e).languageCode),function(e,t){e!==tp&&(n=t,be(ip(tp),(function(e,t){at(n[t])&&(n[t]=e)})));var n}(n,r),op(n,de(r)),de(r)}function up(e){return cp(e)?de(ip(e)):null}function cp(e){return ap(e)}function hp(e,t,n){var r=up(e);if(null===r)return null;var o=r[t];if(at(o))return null;var l=function(e,t){var n=e;return $(function(){return Ef()}(),(function(r){n=r(e,t)})),n}(o,n);return Array.isArray(l)?l[0]:l}function fp(e){var t=Sf(e);return cp(t)||(t=tp,kf(e)),t}sp(ep);n(543);var dp="active-header",pp="area",yp="cell",gp="fill",vp="header",mp="custom-selection";n(903);function bp(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return wp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wp(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wp(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Cp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Sp=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var t,n,r;return t=e,n=[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t,n){var element=e.main.childNodes[t];e.eventManager.addEventListener(element,"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),qn(e);var n=this,r=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function e(l){var c;((c=l).clientY<Math.floor(o.top)||c.clientY>Math.ceil(o.top+o.height)||c.clientX<Math.floor(o.left)||c.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")}))}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","start","bottom","end","corner"],style=this.main.style;style.position="absolute",style.top=0,style.left=0;for(var i=0;i<5;i++){var r=n[i],div=t.createElement("div");div.className="wtBorder ".concat(this.settings.className||""),this.settings[r]&&this.settings[r].hide&&(div.className+=" hidden"),(style=div.style).backgroundColor=this.settings[r]&&this.settings[r].color?this.settings[r].color:e.border.color,style.height=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(e.border.width,"px"),style.width=this.settings[r]&&this.settings[r].width?"".concat(this.settings[r].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(div)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ve()&&this.createMultipleSelectorHandles(),this.disappear();var o=this.wot.wtTable,l=o.bordersHolder;l||((l=t.createElement("div")).className="htBorders",o.bordersHolder=l,o.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style},be({position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")},(function(t,n){e.selectionHandles.styles.bottomHitArea[n]=t,e.selectionHandles.styles.topHitArea[n]=t})),be({position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"},(function(t,n){e.selectionHandles.styles.bottom[n]=t,e.selectionHandles.styles.top[n]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(e,col){var t=this.wot.selections.createOrGetArea();return!(!t.cellRange||e===t.cellRange.to.row&&col===t.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,col,t,n,r,o){var l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",c=parseInt(this.selectionHandles.styles.top.width,10),h=parseInt(this.selectionHandles.styles.topHitArea.width,10);this.selectionHandles.styles.top.top="".concat(parseInt(t-c-1,10),"px"),this.selectionHandles.styles.top[l]="".concat(parseInt(n-c-1,10),"px"),this.selectionHandles.styles.topHitArea.top="".concat(parseInt(t-h/4*3,10),"px"),this.selectionHandles.styles.topHitArea[l]="".concat(parseInt(n-h/4*3,10),"px"),this.selectionHandles.styles.bottom.top="".concat(parseInt(t+o,10),"px"),this.selectionHandles.styles.bottom[l]="".concat(parseInt(n+r,10),"px"),this.selectionHandles.styles.bottomHitArea.top="".concat(parseInt(t+o-h/4,10),"px"),this.selectionHandles.styles.bottomHitArea[l]="".concat(parseInt(n+r-h/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.top.display="block",this.selectionHandles.styles.topHitArea.display="block",this.isPartRange(e,col)?(this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none"):(this.selectionHandles.styles.bottom.display="block",this.selectionHandles.styles.bottomHitArea.display="block")):(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottomHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||col===this.wot.wtSettings.getSetting("fixedColumnsStart")?(this.selectionHandles.styles.top.zIndex="9999",this.selectionHandles.styles.topHitArea.zIndex="9999"):(this.selectionHandles.styles.top.zIndex="",this.selectionHandles.styles.topHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,r,o,l,c,h=this.wot,f=h.wtTable,d=h.rootDocument,y=h.rootWindow,v=f.getRenderedRowsCount(),i=0;i<v;i+=1){var s=f.rowFilter.renderedToSource(i);if(s>=e[0]&&s<=e[2]){t=s,l=e[0];break}}for(var m=v-1;m>=0;m-=1){var w=f.rowFilter.renderedToSource(m);if(w>=e[0]&&w<=e[2]){n=w;break}}for(var C=f.getRenderedColumnsCount(),S=0;S<C;S+=1){var k=f.columnFilter.renderedToSource(S);if(k>=e[1]&&k<=e[3]){r=k,c=e[1];break}}for(var O=C-1;O>=0;O-=1){var R=f.columnFilter.renderedToSource(O);if(R>=e[1]&&R<=e[3]){o=R;break}}if(void 0!==t&&void 0!==r){var E=f.getCell(this.wot.createCellCoords(t,r)),T=t!==n||r!==o,A=T?f.getCell(this.wot.createCellCoords(n,o)):E,x=en(E),M=T?en(A):x,P=en(f.TABLE),_=hn(f.TABLE),I=x.top,H=x.left,j=this.wot.wtSettings.getSetting("rtlMode"),D=0,N=0;if(j){var L=hn(E),B=y.innerWidth-P.left-_;N=H+L-M.left,D=y.innerWidth-H-L-B-1}else N=M.left+hn(A)-H,D=H-P.left-1;if(this.isEntireColumnSelected(t,n)){var V=this.getDimensionsFromHeader("columns",r,o,l,P),F=null;if(V){var W=bp(V,3);F=W[0],D=W[1],N=W[2]}F&&(E=F)}var U=I-P.top-1,z=M.top+fn(A)-I;if(this.isEntireRowSelected(r,o)){var G=this.getDimensionsFromHeader("rows",t,n,c,P),Y=null;if(G){var K=bp(G,3);Y=K[0],U=K[1],z=K[2]}Y&&(E=Y)}var style=cn(E,y);parseInt(style.borderTopWidth,10)>0&&(U+=1,z=z>0?z-1:0),parseInt(style[j?"borderRightWidth":"borderLeftWidth"],10)>0&&(D+=1,N=N>0?N-1:0);var X=j?"right":"left";this.topStyle.top="".concat(U,"px"),this.topStyle[X]="".concat(D,"px"),this.topStyle.width="".concat(N,"px"),this.topStyle.display="block",this.startStyle.top="".concat(U,"px"),this.startStyle[X]="".concat(D,"px"),this.startStyle.height="".concat(z,"px"),this.startStyle.display="block";var $=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(U+z-$,"px"),this.bottomStyle[X]="".concat(D,"px"),this.bottomStyle.width="".concat(N,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(U,"px"),this.endStyle[X]="".concat(D+N-$,"px"),this.endStyle.height="".concat(z+1,"px"),this.endStyle.display="block";var Q=this.settings.border.cornerVisible;Q="function"==typeof Q?Q(this.settings.layerLevel):Q;var J=this.wot.getSetting("onModifyGetCellCoords",n,o),Z=n,ee=o;if(J&&Array.isArray(J)){var te=bp(J,4);Z=te[2],ee=te[3]}if(Ve()||!Q||this.isPartRange(Z,ee))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(U+z+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[X]="".concat(D+N+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ne=ln(f.TABLE),re=ne===y;if(re&&(ne=d.documentElement),o===this.wot.getSetting("totalColumns")-1){var oe=re?A.getBoundingClientRect().left:A.offsetLeft;(j?oe-parseInt(this.cornerDefaultStyle.width,10)/2<0:oe+hn(A)+parseInt(this.cornerDefaultStyle.width,10)/2>=pn(ne))&&(this.cornerStyle[X]="".concat(Math.floor(D+N+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle[j?"borderLeftWidth":"borderRightWidth"]=0)}n===this.wot.getSetting("totalRows")-1&&(re?A.getBoundingClientRect().top:A.offsetTop)+fn(A)+parseInt(this.cornerDefaultStyle.height,10)/2>=dn(ne)&&(this.cornerStyle.top="".concat(Math.floor(U+z+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Ve()&&this.updateMultipleSelectionHandlesPosition(n,o,U,D,N,z)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,r,o){var l=this.wot.wtTable,c=l.wtRootElement.parentNode,h=null,f=null,d=null,y=null,v=null,m=null,w=null,C=null;switch(e){case"rows":h=function(){return l.getRowHeader.apply(l,arguments)},f=function(){return fn.apply(void 0,arguments)},d="ht__selection--rows",m="top";break;case"columns":h=function(){return l.getColumnHeader.apply(l,arguments)},f=function(){return hn.apply(void 0,arguments)},d="ht__selection--columns",m="left"}if(c.classList.contains(d)){var S=this.wot.getSetting("columnHeaders").length;if(w=h(t,S-r),C=h(n,S-r),!w||!C)return!1;var k=en(w),O=en(C);return w&&C&&(y=k[m]-o[m]-1,v=O[m]+f(C)-k[m]),[w,y,v]}return!1}},{key:"changeBorderStyle",value:function(e,t){var style=this[e].style,n=t[e];!n||n.hide?Gt(this[e],"hidden"):(zt(this[e],"hidden")&&Yt(this[e],"hidden"),style.backgroundColor=n.color,"top"!==e&&"bottom"!==e||(style.height="".concat(n.width,"px")),"start"!==e&&"end"!==e||(style.width="".concat(n.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t=1,n="#000",style=this[e].style;style.backgroundColor=n,style.width="".concat(t,"px"),style.height="".concat(t,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?Gt(this[e],"hidden"):Yt(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ve()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.bottom.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}],n&&Cp(t.prototype,n),r&&Cp(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),kp=Sp;function Op(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Rp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rp(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rp(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ep(e){return Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ep(e)}function Tp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ap=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var t,n,r;return t=e,n=[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new kp(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=e.wtTable.getCell(this.settings.createCellCoords(t,n));if("object"===Ep(l)){var c=r;o&&(c=this.classNameGenerator(l),this.classNames.includes(c)||this.classNames.push(c)),Gt(l,c)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(element){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===r)return e;var o=r>=0?r:t,l=e,c=0==(o-=1)?e:"".concat(e,"-").concat(o);if(zt(element,c)){var h=o+1;l="".concat(e,"-").concat(h)}else l=n(element,o);return l}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=Op(r,4),l=o[0],c=o[1],h=o[2],f=o[3],d=this.settings,y=d.highlightHeaderClassName,v=d.highlightColumnClassName,m=d.highlightRowClassName,w=d.highlightOnlyClosestHeader,C=d.selectionType,S=void 0===C||["active-header","header"].includes(C);if(S&&null!==c&&null!==f)for(var k=0,O=0;O<n;O+=1){var R=e.wtTable.columnFilter.renderedToSource(O);if(R>=c&&R<=f){var E=e.wtTable.getColumnHeaders(R),T=E.length-1;w&&E.length>1&&(E=[E[T]]);for(var A=0;A<E.length;A+=1){var x=[],M=E[A];y&&x.push(y),v&&x.push(v),A=w?T:A;var P=e.getSetting("onBeforeHighlightingColumnHeader",R,A,{selectionType:C,columnCursor:k,selectionWidth:f-c+1,classNames:x});P!==R&&(M=e.wtTable.getColumnHeader(P,A)),Gt(M,x)}k+=1}}if(null!==l&&null!==h)for(var _=0,I=0;I<t;I+=1){var H=e.wtTable.rowFilter.renderedToSource(I);if(S&&H>=l&&H<=h){var j=e.wtTable.getRowHeaders(H),D=j.length-1;w&&j.length>1&&(j=[j[D]]);for(var N=0;N<j.length;N+=1){var L=[],B=j[N];y&&L.push(y),m&&L.push(m),N=w?D:N;var V=e.getSetting("onBeforeHighlightingRowHeader",H,N,{selectionType:C,rowCursor:_,selectionHeight:h-l+1,classNames:L});V!==H&&(B=e.wtTable.getRowHeader(V,N)),Gt(B,L)}_+=1}if(null!==c&&null!==f)for(var F=0;F<n;F+=1){var W=e.wtTable.columnFilter.renderedToSource(F);H>=l&&H<=h&&W>=c&&W<=f?this.settings.className&&this.addClassAtCoords(e,H,W,this.settings.className,this.settings.markIntersections):H>=l&&H<=h?m&&this.addClassAtCoords(e,H,W,m):W>=c&&W<=f&&v&&this.addClassAtCoords(e,H,W,v);var U=e.getSetting("onAfterDrawSelection",H,W,this.settings.layerLevel);"string"==typeof U&&this.addClassAtCoords(e,H,W,U)}}e.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(e).appear(r)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}],n&&Tp(t.prototype,n),r&&Tp(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xp(e){return xp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xp(e)}function Mp(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Pp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pp(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pp(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ip(){return Ip="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Hp(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Ip.apply(this,arguments)}function Hp(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Lp(object)););return object}function jp(e,p){return jp=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},jp(e,p)}function Dp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lp(e);if(t){var o=Lp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Np(this,n)}}function Np(e,t){if(t&&("object"===xp(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lp(e){return Lp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lp(e)}var Bp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jp(e,t)}(l,e);var t,n,r,o=Dp(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this,e,null)).visualCellRange=t||null,n.commit(),n}return t=l,n=[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,Ip(Lp(l.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,o=this.findVisibleCoordsInRowsRange(e.row,t.row,n);if(null===o)return null;var l=this.findVisibleCoordsInColumnsRange(e.col,t.col,r);return null===l?null:this.settings.createCellCoords(o,l)}},{key:"findVisibleCoordsInRowsRange",value:function(e,t,n){var r=this.settings.visualToRenderableCoords({row:e,col:-1}).row;return t===e&&null===r?null:null===r?this.findVisibleCoordsInRowsRange(e+n,t,n):e}},{key:"findVisibleCoordsInColumnsRange",value:function(e,t,n){var r=this.settings.visualToRenderableCoords({row:-1,col:e}).col;return t===e&&null===r?null:null===r?this.findVisibleCoordsInColumnsRange(e+n,t,n):e}},{key:"findVisibleHeaderRange",value:function(e,t,n,r){var o=this.findVisibleCoordsInRowsRange(e.row,t.row,n),l=this.findVisibleCoordsInRowsRange(t.row,e.row,-n),c=this.findVisibleCoordsInColumnsRange(e.col,t.col,r),h=this.findVisibleCoordsInColumnsRange(t.col,e.col,-r);return null===o&&null===l&&null===c&&null===h?null:[this.settings.createCellCoords(o,c),this.settings.createCellCoords(l,h)]}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.visualCellRange,t=e.from,n=e.to,r=this.getRowSearchDirection(this.visualCellRange),o=this.getColumnSearchDirection(this.visualCellRange),l=this.findVisibleCoordsInRange(t,n,r,o),c=this.findVisibleCoordsInRange(n,t,-r,-o);if(null===l||null===c){var h=null;if("header"===this.settings.type){var f=Mp(this.findVisibleHeaderRange(t,n,r,o),2),d=f[0],y=f[1];h=this.createRenderableCellRange(d,y)}this.cellRange=h}else this.cellRange=this.createRenderableCellRange(l,c);return this}},{key:"adjustCoordinates",value:function(e){var t=this.getRowSearchDirection(e),n=this.getColumnSearchDirection(e),r=e.from.clone().normalize(),o=e.to.clone().normalize(),l=this.findVisibleCoordsInRange(r,o,t,n);if(null!==l){if(null===this.cellRange){var c=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(c)}return e.setHighlight(l),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,r=null===t.row||null===n.row,o=null===t.col||null===n.col,l=this.settings.createCellCoords(r?null:Math.min(t.row,n.row),o?null:Math.min(t.col,n.col)),c=this.settings.createCellCoords(r?null:Math.max(t.row,n.row),o?null:Math.max(t.col,n.col));return[l.row,l.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,r)}},{key:"getRowSearchDirection",value:function(e){return e.from.row<e.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(e){return e.from.col<e.to.col?1:-1}}],n&&_p(t.prototype,n),r&&_p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ap),Vp=Bp,Fp=["activeHeaderClassName"];function Wp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Up(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Wp(Object(source),!0).forEach((function(t){zp(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Wp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function zp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gp(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var Yp=function(e){var t=e.activeHeaderClassName,n=Gp(e,Fp);return new Vp(Up(Up({highlightHeaderClassName:t},n),{},{selectionType:dp}))},Kp=["layerLevel","areaCornerVisible"];function Xp(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function $p(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Xp(Object(source),!0).forEach((function(t){qp(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Xp(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function qp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qp(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var Jp=function(e){var t=e.layerLevel,n=e.areaCornerVisible,r=Qp(e,Kp);return new Vp($p($p({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:pp}))},Zp=["cellCornerVisible"];function ey(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function ty(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ey(Object(source),!0).forEach((function(t){ny(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ey(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function ny(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ry(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var oy=function(e){var t=e.cellCornerVisible,n=ry(e,Zp);return new Vp(ty(ty({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:yp}))},iy=["border","visualCellRange"];function ay(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function ly(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ay(Object(source),!0).forEach((function(t){sy(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ay(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function sy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uy(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var cy=function(e){var t=e.border,n=e.visualCellRange,r=uy(e,iy);return new Vp(ly(ly(ly({},t),r),{},{selectionType:mp}),n)};n(724);function hy(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function fy(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?hy(Object(source),!0).forEach((function(t){dy(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):hy(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function dy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var py=function(e){var t=Object.assign({},e);return new Vp(fy(fy({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:gp}))},yy=["headerClassName","rowClassName","columnClassName"];function gy(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function vy(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?gy(Object(source),!0).forEach((function(t){my(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):gy(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function my(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function by(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}var wy=function(e){var t=e.headerClassName,n=e.rowClassName,r=e.columnClassName,o=by(e,yy);return new Vp(vy(vy({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:vp}))};function Cy(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function Sy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ky=vr("highlight/types"),Oy=ky.register,Ry=ky.getItem;function Ey(e,t){return Ry(e)(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?Cy(Object(source),!0).forEach((function(t){Sy(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):Cy(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({type:e},t))}function Ty(e){return function(e){if(Array.isArray(e))return Ay(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ay(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ay(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ay(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function xy(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function My(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?xy(Object(source),!0).forEach((function(t){Py(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):xy(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function Py(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Oy(dp,Yp),Oy(pp,Jp),Oy(yp,oy),Oy(mp,cy),Oy(gp,py),Oy(vp,wy);var Iy=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.layerLevel=0,this.cell=Ey(yp,e),this.fill=Ey(gp,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var n,r,o;return n=t,r=[{key:"isEnabledFor",value:function(e,t){var n=e;e===yp&&(n="current");var r=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var area,e=this.layerLevel;return this.areas.has(e)?area=this.areas.get(e):(area=Ey(pp,My({layerLevel:e},this.options)),this.areas.set(e,area)),area}},{key:"getAreas",value:function(){return Ty(this.areas.values())}},{key:"createOrGetHeader",value:function(){var header,e=this.layerLevel;return this.headers.has(e)?header=this.headers.get(e):(header=Ey(vp,My({},this.options)),this.headers.set(e,header)),header}},{key:"getHeaders",value:function(){return Ty(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var header,e=this.layerLevel;return this.activeHeaders.has(e)?header=this.activeHeaders.get(e):(header=Ey(dp,My({},this.options)),this.activeHeaders.set(e,header)),header}},{key:"getActiveHeaders",value:function(){return Ty(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Ty(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(Ey(mp,My(My({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),$(this.areas.values(),(function(e){e.clear()})),$(this.headers.values(),(function(e){e.clear()})),$(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:e,value:function(){return[this.cell,this.fill].concat(Ty(this.areas.values()),Ty(this.headers.values()),Ty(this.activeHeaders.values()),Ty(this.customSelections))[Symbol.iterator]()}}],r&&_y(n.prototype,r),o&&_y(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(Symbol.iterator),Hy=Iy;function jy(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Dy=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.ranges=[],this.createCellRange=e}var n,r,o;return n=t,r=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}},{key:"add",value:function(e){return this.ranges.push(this.createCellRange(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}],r&&jy(n.prototype,r),o&&jy(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(Symbol.iterator),Ny=Dy;function Ly(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var By=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.options=n}var t,n,r;return t=e,n=[{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(e,t),o=this.range.current().highlight,l=this.options.visualToRenderableCoords(o),c=l.row,h=l.col,f=o,d=0,y=0;if(this.runLocalHooks("beforeTransformStart",r),null!==c&&null!==h){var v=this.options.countRows(),m=this.options.countCols(),w=this.options.fixedRowsBottom(),C=this.options.minSpareRows(),S=this.options.minSpareCols(),k=this.options.autoWrapRow(),O=this.options.autoWrapCol();c+e>v-1?n&&C>0&&!(w&&c>=v-w-1)?(this.runLocalHooks("insertRowRequire",v),v=this.options.countRows()):O&&(r.row=1-v,r.col=h+r.col===m-1?1-m:1):O&&c+r.row<0&&h+r.col>=0&&(r.row=v-1,r.col=h+r.col===0?m-1:-1),h+r.col>m-1?n&&S>0?(this.runLocalHooks("insertColRequire",m),m=this.options.countCols()):k&&(r.row=c+r.row===v-1?1-v:1,r.col=1-m):k&&h+r.col<0&&c+r.row>=0&&(r.row=c+r.row===0?v-1:-1,r.col=m-1);var R=this.options.createCellCoords(c+r.row,h+r.col);d=0,y=0,R.row<0?(d=-1,R.row=0):R.row>0&&R.row>=v&&(d=1,R.row=v-1),R.col<0?(y=-1,R.col=0):R.col>0&&R.col>=m&&(y=1,R.col=m-1),f=this.options.renderableToVisualCoords(R)}return this.runLocalHooks("afterTransformStart",f,d,y),f}},{key:"transformEnd",value:function(e,t){var n=this.options.createCellCoords(e,t),r=this.range.current(),o=r.to,l=0,c=0;this.runLocalHooks("beforeTransformEnd",n);var h=this.options.visualToRenderableCoords(r.highlight),f=h.row,d=h.col;if(null!==f&&null!==d){var y=this.options.countRows(),v=this.options.countCols(),m=this.options.visualToRenderableCoords(r.to),w=m.row,C=m.col,S=this.options.createCellCoords(w+n.row,C+n.col);l=0,c=0,S.row<0?(l=-1,S.row=0):S.row>0&&S.row>=y&&(l=1,S.row=y-1),S.col<0?(c=-1,S.col=0):S.col>0&&S.col>=v&&(c=1,S.col=v-1),o=this.options.renderableToVisualCoords(S)}return this.runLocalHooks("afterTransformEnd",o,l,c),o}}],n&&Ly(t.prototype,n),r&&Ly(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(By,Mc);var Vy=By;function Fy(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Wy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wy(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wy(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Uy(e){return Uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uy(e)}var zy,Gy=[3,2],Yy=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Ky=Symbol("root"),Xy=Symbol("child");function $y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ky;if(t!==Ky&&t!==Xy)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),r=t===Ky,o=0;if(n){var l=e[0];if(0===e.length)o=1;else if(r&&l instanceof fl)o=3;else if(r&&Array.isArray(l))o=$y(l,Xy);else if(e.length>=2&&e.length<=4){var c=!e.some((function(e,t){return!Yy[t].includes(Uy(e))}));c&&(o=2)}}return o}function qy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,o=t.propToCol;if(!Gy.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=3===e,l=n?t.from.row:t[0],c=n?t.from.col:t[1],h=n?t.to.row:t[2],f=n?t.to.col:t[3];if("function"==typeof o&&("string"==typeof c&&(c=o(c)),"string"==typeof f&&(f=o(f))),at(h)&&(h=l),at(f)&&(f=c),!r){var d=l,y=c,v=h,m=f;l=Math.min(d,v),c=Math.min(y,m),h=Math.max(d,v),f=Math.max(y,m)}return[l,c,h,f]}}function Qy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&e>=0&&e<t}function Jy(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Zy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zy(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zy(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function eg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var tg=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Ny((function(e,t,n){return r.tableProps.createCellRange(e,t,n)})),this.highlight=new Hy({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(e,t){return r.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},createCellRange:function(e,t,n){return r.tableProps.createCellRange(e,t,n)}}),this.transformation=new Vy(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(t))}))}var t,n,r;return t=e,n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=at(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,l=e.row<0,c=e.col<0,h=l&&c,f=e.clone();this.selectedByCorner=h,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),f),(!r||r&&!o&&at(t))&&this.selectedRange.clear(),this.selectedRange.add(f),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!h&&c&&this.selectedByRowHeader.add(this.getLayerLevel()),!h&&l&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(yp,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().adjustCoordinates(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&($(this.highlight.getAreas(),(function(e){e.clear()})),$(this.highlight.getHeaders(),(function(e){e.clear()})),$(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),l=this.highlight.createOrGetHeader(),c=this.highlight.createOrGetActiveHeader();if(o.clear(),l.clear(),c.clear(),this.highlight.isEnabledFor(pp,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var h=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(h.from).commit().adjustCoordinates(h),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(vp,n.highlight)){var f=0===this.tableProps.countRowsTranslated(),d=0===this.tableProps.countColsTranslated(),y=n;(f||d)&&(y=n.clone()),f&&(y.from.row=-1),d&&(y.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&y.from.normalize(),l.add(y.from).commit()):l.add(y.from).add(y.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&c.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&c.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=ke(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(e||t||0!==n&&0!==r){var o=this.tableProps.createCellCoords(t?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(this.tableProps.createCellCoords(n-1,r-1)),this.finish()}}},{key:"selectCells",value:function(e){var t=this,n=$y(e);if(1===n)return!1;if(0===n)throw new Error(et(zy||(zy=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var r=qy(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),o=this.tableProps.countRows(),l=this.tableProps.countCols(),c=!e.some((function(e){var t=Jy(r(e),4),n=t[0],c=t[1],h=t[2],f=t[3];return!(Qy(n,o)&&Qy(c,l)&&Qy(h,o)&&Qy(f,l))}));return c&&(this.clear(),$(e,(function(e){var n=Jy(r(e),4),o=n[0],l=n[1],c=n[2],h=n[3];t.setRangeStartOnly(t.tableProps.createCellCoords(o,l),!1),t.setRangeEnd(t.tableProps.createCellCoords(c,h)),t.finish()}))),c}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"==typeof e?this.tableProps.propToCol(e):e,o="string"==typeof t?this.tableProps.propToCol(t):t,l=this.tableProps.countCols(),c=this.tableProps.countRows(),h=Qy(r,l)&&Qy(o,l);return h&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(c-1,o)),this.finish()),h}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),l=Qy(e,r)&&Qy(t,r);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,o-1)),this.finish()),l}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(e){e.commit()})),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().adjustCoordinates(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();r.commit(),o.commit(),l.commit()}this.highlight.useLayerLevel(t)}}}],n&&eg(t.prototype,n),r&&eg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(tg,Mc);var ng=tg;function rg(e,t){var n="string"==typeof e?cc(e):e;if(ve(n)){var r=ve(t),o={};return be(n,(function(e,n){"CELL_TYPE"===n||r&&(!r||Oe(t,n))||(o[n]=e)})),o}}function og(e){return Number.isInteger(e)&&e>=0}function ig(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function ag(e){return null==e}function lg(e){return lg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lg(e)}var sg=function(){return{activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(col){var e,t;for(e=0,t=this.countRows();e<t;e++)if(!1===lt(this.getDataAtCell(e,col)))return!1;return!0},isEmptyRow:function(e){var col,t,n,meta;for(col=0,t=this.countCols();col<t;col++)if(!1===lt(n=this.getDataAtCell(e,col)))return"object"===lg(n)&&(meta=this.getCellMeta(e,col),ge(this.getSchema()[meta.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function ug(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cg(e,t,n){return t&&ug(e.prototype,t),n&&ug(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function hg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var fg=function(){function e(t){hg(this,e),this.metaCtor=cg((function e(){hg(this,e)})),this.meta=this.metaCtor.prototype,he(this.meta,sg()),this.meta.instance=t}return cg(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){he(this.meta,e),he(this.meta,rg(e.type,e))}}]),e}();function dg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pg=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.getMetaConstructor();this.meta=new n}var t,n,r;return t=e,(n=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){he(this.meta,e),he(this.meta,rg(e.type,e))}}])&&dg(t.prototype,n),r&&dg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function yg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var gg=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}var n,r,o;return n=t,r=[{key:"obtain",value:function(e){ig((function(){return og(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)void 0===(t=this.data[n])&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ig((function(){return og(e)||ag(e)}),"Expecting an unsigned number or null/undefined argument.");for(var r=[],o=this.data.length,i=0;i<n;i++)r.push(o+i),this.data.push(void 0);(t=this.index).splice.apply(t,[ag(e)?this.index.length:e,0].concat(r))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ig((function(){return og(e)||ag(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(ag(e)?this.index.length-t:e,t),i=0;i<n.length;i++){var r=n[i];"number"==typeof r&&this.holes.add(r)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return K(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],i=0;i<this.data.length;i++){var t=this._getKeyByStorageIndex(i);-1!==t&&e.push([t,this.data[i]])}var n=0;return{next:function(){if(n<e.length){var t=e[n];return n+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:e,value:function(){return this.entries()}}],r&&yg(n.prototype,r),o&&yg(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(Symbol.iterator);function vg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var mg=["data","width"],bg=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalMeta=t,this.metas=new gg((function(){return n._createMeta()}))}var t,n,r;return t=e,n=[{key:"updateMeta",value:function(e,t){var meta=this.getMeta(e);he(meta,t),he(meta,rg(t.type,meta))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}ce(n,e);for(var i=0;i<t.length;i++)n.prototype[t[i]]=void 0;return n}(this.globalMeta.getMetaConstructor(),mg).prototype}}],n&&vg(t.prototype,n),r&&vg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wg(e){return function(e){if(Array.isArray(e))return Cg(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Cg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cg(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cg(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Sg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var kg=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.columnMeta=t,this.metas=new gg((function(){return n._createRow()}))}var t,n,r;return t=e,(n=[{key:"updateMeta",value:function(e,t,n){var meta=this.getMeta(e,t);he(meta,n),he(meta,rg(n.type,meta))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){this.metas.obtain(e).obtain(t)[n]=r}},{key:"removeMeta",value:function(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,wg(t[n].values()));return e}},{key:"getMetasAtRow",value:function(e){ig((function(){return og(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new gg((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}])&&Sg(t.prototype,n),r&&Sg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Og(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Eg=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Og(this,e),this.hot=t,this.globalMeta=new fg(t),this.tableMeta=new pg(this.globalMeta),this.columnMeta=new bg(this.globalMeta),this.cellMeta=new kg(this.columnMeta),o.forEach((function(e){return new e(n)})),this.globalMeta.updateMeta(r)}var t,n,r;return t=e,n=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){var r=n.visualRow,o=n.visualColumn,l=this.cellMeta.getMeta(e,t);return l.visualRow=r,l.visualCol=o,l.row=e,l.col=t,this.runLocalHooks("afterGetCellMeta",l),l}},{key:"getCellMetaKeyValue",value:function(e,t,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}],n&&Rg(t.prototype,n),r&&Rg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Tg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}ye(Eg,Mc);var Ag=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(function(e){return n.extendCellMeta(e)})),dr.getSingleton().add("beforeRender",(function(e){e&&n.metaSyncMemo.clear()}),this.metaManager.hot)}var t,n,r;return t=e,(n=[{key:"extendCellMeta",value:function(e){var t,n=e.row,r=e.col;if(null===(t=this.metaSyncMemo.get(n))||void 0===t||!t.has(r)){var o=e.visualRow,l=e.visualCol,c=this.metaManager.hot,h=c.colToProp(l);e.prop=h,c.runHooks("beforeGetCellMeta",o,l,e);var f,d=Oe(e,"type")?e.type:null,y=In(e.cells)?e.cells(n,r,h):null;d&&(y?y.type=null!==(f=y.type)&&void 0!==f?f:d:y={type:d}),y&&this.metaManager.updateCellMeta(n,r,y),c.runHooks("afterGetCellMeta",o,l,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}])&&Tg(t.prototype,n),r&&Tg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Mg=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(e,t,n){if(!n)throw new Error("The `".concat(e,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}var t,n,r;return t=e,n=[{key:"extendMetaProps",value:function(){var e=this;this.propDescriptors.forEach((function(t,n){var r=t.target,o=t.onChange,l=void 0===o?function(){}:o,c="string"==typeof r,h=c?r:n,f="_".concat(h);e.metaManager.globalMeta.meta[f]=e.metaManager.globalMeta.meta[h],e.installPropWatcher(n,f,l),c&&e.installPropWatcher(r,f,l)}))}},{key:"installPropWatcher",value:function(e,t,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get:function(){return this[t]},set:function(o){var l=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,o,l),this[t]=o},enumerable:!0,configurable:!0})}}],n&&xg(t.prototype,n),r&&xg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Pg=(n(678),/^(\r\n|\n\r|\r|\n)/),_g=/^[^\t\r\n]+/,Ig=/^\t/;function Hg(e){var t,n,r,o,l,c="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(c+="\t"),"string"==typeof(l=e[t][r])?l.indexOf("\n")>-1?c+='"'.concat(l.replace(/"/g,'""'),'"'):c+=l:c+=null==l?"":l;t!==n-1&&(c+="\n")}return c}function jg(e){return jg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jg(e)}function Dg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ng=wc("copyable",!1),Lg=function(){function e(t,data,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.dataSource=data,this.duckSchema=this.dataSource&&this.dataSource[0]?ue(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}var t,n,r;return t=e,n=[{key:"createMap",value:function(){var e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var i,t=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,t){var n=0,r=0,o=!1;if("function"==typeof t){var l=Se(e);n=l>0?l:this.countFirstRowKeys(),o=!0}else{var c=this.tableMeta.maxCols;n=Math.min(c,t.length)}for(i=0;i<n;i++){var h=o?t(i):t[i];if(ve(h)){if(void 0!==h.data){var f=o?r:i;this.colToPropCache[f]=h.data,this.propToColCache.set(h.data,f)}r+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Sc(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,o=this,l=t,c=n;return void 0===l&&(l=0,c=""),"object"!==jg(e)||Array.isArray(e)||be(e,(function(e,t){null===e?(r=c+t,o.colToPropCache.push(r),o.propToColCache.set(r,l),l+=1):l=o.recursiveDuckColumns(e,l,"".concat(t,"."))})),l}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&it(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(it(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,r=this.instance.countSourceRows(),o=r,l=0,c=e;("number"!=typeof c||c>=r)&&(c=r),c<this.instance.countRows()&&(o=this.instance.toPhysicalRow(c));var h=this.instance.runHooks("beforeCreateRow",c,n,source);if(!1===h||null===o)return 0;for(var f=this.tableMeta.maxRows,d=this.instance.countCols(),y=[],v=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=de(t.getSchema()):(e=[],no(d-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(c+l):fe(e={},t.getSchema()),y.push(e),l+=1};l<n&&r+l<f;)v();return this.instance.rowIndexMapper.insertIndexes(c,l),this.spliceData.apply(this,[o,0].concat(y)),this.instance.runHooks("afterCreateRow",c,l,source),this.instance.forceFullRender=!0,l}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var n=this.dataSource,r=this.tableMeta.maxCols,o=e;("number"!=typeof o||o>=this.instance.countSourceCols())&&(o=this.instance.countSourceCols());var l=this.instance.runHooks("beforeCreateCol",o,t,source);if(!1===l)return 0;var c=this.instance.countSourceCols();o<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(o));for(var h=this.instance.countSourceRows(),f=this.instance.countCols(),d=0,y=c;d<t&&f<r;){if("number"!=typeof o||o>=f)if(h>0)for(var v=0;v<h;v+=1)void 0===n[v]&&(n[v]=[]),n[v].push(null);else n.push([null]);else for(var m=0;m<h;m++)n[m].splice(y,0,null);d+=1,y+=1,f+=1}return this.instance.columnIndexMapper.insertIndexes(o,d),this.instance.runHooks("afterCreateCol",o,d,source),this.instance.forceFullRender=!0,d}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-t,r=this.visualRowsToPhysical(n,t),o=this.instance.countSourceRows();n=(o+n)%o;var l=this.instance.runHooks("beforeRemoveRow",n,r.length,r,source);if(!1===l)return!1;var c=r.length;if(this.filterData(n,c,r),n<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(r);var h=it(this.tableMeta.columns)||it(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===h&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",n,c,r,source),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,source=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var n="number"!=typeof e?-t:e;n=(this.instance.countCols()+n)%this.instance.countCols();var r=this.visualColumnsToPhysical(n,t),o=r.slice(0).sort((function(a,b){return b-a})),l=this.instance.runHooks("beforeRemoveCol",n,t,r,source);if(!1===l)return!1;for(var c=!0,h=o.length,data=this.dataSource,f=0;f<h;f++)c&&r[0]!==r[f]-f&&(c=!1);if(c)for(var d=0,y=this.instance.countSourceRows();d<y;d++)data[d].splice(r[0],t);else for(var v=0,m=this.instance.countSourceRows();v<m;v++)for(var w=0;w<h;w++)data[v].splice(o[w],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(r),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,t,r,source),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(col,e,t){for(var n=this.instance.getDataAtCol(col),r=n.slice(e,e+t),o=n.slice(e+t),l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];z(c,o);for(var i=0;i<t;)c.push(null),i+=1;return U(c),this.instance.populateFromArray(e,col,c,null,null,"spliceCol"),r}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),o=r.slice(t,t+n),l=r.slice(t+n),c=arguments.length,h=new Array(c>3?c-3:0),f=3;f<c;f++)h[f-3]=arguments[f];z(h,l);for(var i=0;i<n;)h.push(null),i+=1;return this.instance.populateFromArray(e,t,[h],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var l,c=this.instance.runHooks("beforeDataSplice",e,t,r);!1!==c&&(l=this.dataSource).splice.apply(l,[e,t].concat(r))}},{key:"filterData",value:function(e,t,n){var data=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(data)&&(data=this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,data)}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),l=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Oe(r,t))l=r[t];else if("string"==typeof t&&t.indexOf(".")>-1){var c=t.split("."),h=r;if(!h)return null;for(var i=0,f=c.length;i<f;i++)if(void 0===(h=h[c[i]]))return null;l=h}else"function"==typeof t&&(l=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var d=ke(l);this.instance.runHooks("modifyData",n,this.propToCol(t),d,"get"),d.isTouched()&&(l=d.value)}return l}},{key:"getCopyable",value:function(e,t){return Ng.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),o=n,l=this.dataSource[r],c=this.instance.runHooks("modifyRowData",r);if(l=isNaN(c)?c:l,this.instance.hasHook("modifyData")){var h=ke(o);this.instance.runHooks("modifyData",r,this.propToCol(t),h,"set"),h.isTouched()&&(o=h.value)}if(l&&l.hasOwnProperty&&Oe(l,t))l[t]=o;else if("string"==typeof t&&t.indexOf(".")>-1){var f,d=t.split("."),y=l,i=0;for(i=0,f=d.length-1;i<f;i++)void 0===y[d[i]]&&(y[d[i]]={}),y=y[d[i]];y[d[i]]=o}else"function"==typeof t?t(this.dataSource.slice(r,r+1)[0],o):l[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){for(var n,r=this.instance.countSourceRows(),o=[],l=(r+e)%r,c=t;l<r&&c;)n=this.instance.toPhysicalRow(l),o.push(n),c-=1,l+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,t){for(var n=this.instance.countCols(),r=[],o=(n+e)%n,l=t;o<n&&l;){var col=this.instance.toPhysicalColumn(o);r.push(col),l-=1,o+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!=0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,r){var o,l,c,output=[],h=this.tableMeta.maxRows,f=this.tableMeta.maxCols;if(0===h||0===f)return[];var d=r===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(h-1,0),Math.max(t.row,n.row)),v=Math.min(Math.max(f-1,0),Math.max(t.col,n.col));for(o=Math.min(t.row,n.row);o<=y;o++){c=[];var m=o>=0?this.instance.toPhysicalRow(o):o;for(l=Math.min(t.col,n.col);l<=v&&null!==m;l++)c.push(d.call(this,o,this.colToProp(l)));null!==m&&output.push(c)}return output}},{key:"getText",value:function(t,n){return Hg(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return Hg(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],r=[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}],n&&Dg(t.prototype,n),r&&Dg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Bg=Lg;function Vg(e){return Vg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vg(e)}function Fg(data,e,t,n){var r=n.hotInstance,o=n.dataMap,l=n.dataSource,c=n.internalSource,source=n.source,h=n.firstRun,f=kt(c),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":In(d.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),data=r.runHooks("before".concat(f),data,h,source);var y=new Bg(r,data,d);if(e(y),"object"===Vg(data)&&null!==data)data.push&&data.splice||(data=[data]);else{if(null!==data)throw new Error("".concat(c," only accepts array of objects or array of arrays (").concat(Vg(data)," given)"));var v,m=y.getSchema();data=[];var w,C=0;for(C=0,w=d.startRows;C<w;C++)if("object"!==r.dataType&&"function"!==r.dataType||!d.dataSchema)if("array"===r.dataType)v=de(m[0]),data.push(v);else{v=[];for(var S=0,k=d.startCols;S<k;S++)v.push(null);data.push(v)}else v=de(m),data.push(v)}Array.isArray(data[0])&&(r.dataType="array"),d.data=data,y.dataSource=data,l.data=data,l.dataType=r.dataType,l.colToProp=y.colToProp.bind(y),l.propToCol=y.propToCol.bind(y),l.countCachedColumns=y.countCachedColumns.bind(y),t(y),r.runHooks("after".concat(f),data,h,source),h||(r.runHooks("afterChange",null,c),r.render())}var Wg,Ug=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),zg=function(e){return e.map((function(e){var t=e.toLowerCase();return Ug.has(t)?Ug.get(t):t})).sort().join("+")},Gg=function(e){return e.toLowerCase()};function Yg(e){return function(e){if(Array.isArray(e))return $g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Xg(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kg(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||Xg(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xg(e,t){if(e){if("string"==typeof e)return $g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$g(e,t):void 0}}function $g(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function qg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Qg,Jg=["meta","alt","shift","control"],Zg=(Qg=new Set,{press:function(e){Qg.add(e)},release:function(e){Qg.delete(e)},releaseAll:function(){Qg.clear()},isPressed:function(e){return Qg.has(e)}});var ev=function(e){var t=e.ownerWindow,n=e.beforeKeyDown,r=e.afterKeyDown,o=bo({errorIdExists:function(e){return'The "'.concat(e,'" context name is already registered.')}}),l="grid",c=function(){return l},h=function(e){return o.getItem(e)},f=!1,d=function(e,t,n,r){var o=function(e){return Jg.includes(e)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},c=function(e){if(!1!==t(e)&&!Qn(e)){var c=Gg(e.key),h=[];o(c)?Zg.press(c):h=l(e);var f=[c].concat(h);!r(e,f)&&(ze()&&h.includes("meta")||!ze()&&h.includes("control"))&&r(e,[c].concat(l(e,!0))),n(e)}},h=function(e){var t=Gg(e.key);!1!==o(t)&&Zg.release(t)},f=function(){Zg.releaseAll()};return{mount:function(){for(var t=e;t;)t.addEventListener("keydown",c),t.addEventListener("keyup",h),t.addEventListener("blur",f),t=t.frameElement},unmount:function(){for(var t=e;t;)t.removeEventListener("keydown",c),t.removeEventListener("keyup",h),t.removeEventListener("blur",f),t=t.frameElement},isPressed:function(e){return Zg.isPressed(e)}}}(t,n,r,(function(e,t){var n=h(c()),r=!1;if(!n.hasShortcut(t))return r;for(var o=n.getShortcuts(t),l=0;l<o.length;l++){var d=o[l],y=d.callback,v=d.runOnlyIf,m=d.preventDefault,w=d.stopPropagation,C=d.captureCtrl;if(!1!==v(e)&&(f=C,r=!1===y(e,t),f=!1,m&&e.preventDefault(),w&&e.stopPropagation(),r))break}return r}));return d.mount(),{addContext:function(e){var t=function(e){var t=bo({errorIdExists:function(t){return'The "'.concat(t,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.keys,r=e.callback,o=e.group,l=e.runOnlyIf,c=void 0===l?function(){return!0}:l,h=e.captureCtrl,f=void 0!==h&&h,d=e.preventDefault,y=void 0===d||d,v=e.stopPropagation,m=void 0!==v&&v,w=e.relativeToGroup,C=e.position;if(at(o))throw new Error("You need to define the shortcut's group.");if(!1===In(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(n))throw new Error(et(Wg||(Wg=qg(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));var S={callback:r,group:o,runOnlyIf:c,captureCtrl:f,preventDefault:y,stopPropagation:m};if(it(w)){var k=[w,C];S.relativeToGroup=k[0],S.position=k[1]}n.forEach((function(e){var n=zg(e);if(t.hasItem(n)){var r=t.getItem(n),o=r.findIndex((function(e){return e.group===w}));-1!==o?"before"===C?o-=1:o+=1:o=r.length,r.splice(o,0,S)}else t.addItem(n,[S])}))},r=function(e){var n=zg(e);t.removeItem(n)};return{addShortcut:n,addShortcuts:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e){be(t,(function(n,r){!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])})),n(e)}))},getShortcuts:function(e){var n=zg(e),r=t.getItem(n);return it(r)?r.slice():[]},hasShortcut:function(e){var n=zg(e);return t.hasItem(n)},removeShortcutsByKeys:r,removeShortcutsByGroup:function(e){t.getItems().forEach((function(t){var n=Kg(t,2),o=n[0],l=n[1],c=l.filter((function(option){return option.group!==e}));0===c.length?r(function(e){return e.split("+")}(o)):(l.length=0,l.push.apply(l,Yg(c)))}))}}}(e);return o.addItem(e,t),t},getActiveContextName:c,getContext:h,setActiveContextName:function(e){l=e},isCtrlPressed:function(){return!f&&(d.isPressed("control")||d.isPressed("meta"))},destroy:function(){return d.unmount()}}};function tv(e){return tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tv(e)}function nv(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||ov(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rv(e){return function(e){if(Array.isArray(e))return iv(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ov(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ov(e,t){if(e){if("string"==typeof e)return iv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iv(e,t):void 0}}function iv(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var av="gridDefault",lv=null;function sv(e,t){var n,r,o,l,c,h=this,f=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=!1,y=this,v=new Hr(y),m=!0;$u(f)&&Xu(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var w=null!==(n=null==t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",C=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return"rtl"===C},this.isLtr=function(){return!y.isRtl()},this.getDirectionFactor=function(){return y.isLtr()?1:-1},t.language=fp(t.language);var S=new Eg(y,t,[Ag,Mg]),k=S.getTableMeta(),O=S.getGlobalMeta(),R=bo();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),qu(this)&&St(t.licenseKey,e),this.guid="ht_".concat(Rt()),this.columnIndexMapper=new Cf,this.rowIndexMapper=new Cf,o=new Ac(y),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var E=function(e){var t=e.row,n=e.col;return y._createCellCoords(t>=0?y.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?y.columnIndexMapper.getRenderableFromVisualIndex(n):n)},T=function(e){var t=e.row,n=e.col;return y._createCellCoords(t>=0?y.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?y.columnIndexMapper.getVisualFromRenderableIndex(n):n)},A=new ng(k,{countCols:function(){return y.countCols()},countRows:function(){return y.countRows()},propToCol:function(e){return r.propToCol(e)},isEditorOpened:function(){return!!y.getActiveEditor()&&y.getActiveEditor().isOpened()},countColsTranslated:function(){return h.view.countRenderableColumns()},countRowsTranslated:function(){return h.view.countRenderableRows()},getShortcutManager:function(){return y.getShortcutManager()},createCellCoords:function(e,t){return y._createCellCoords(e,t)},createCellRange:function(e,t,n){return y._createCellRange(e,t,n)},visualToRenderableCoords:E,renderableToVisualCoords:T,isDisabledCellSelection:function(e,t){return y.getCellMeta(e,t).disableVisualSelection}});this.selection=A;var x=function(e){e.hiddenIndexesChanged&&h.selection.refresh()};function M(e){var t=Sf(e);cp(t)?(y.runHooks("beforeLanguageChange",t),O.language=t,y.runHooks("afterLanguageChange",t)):kf(e)}function P(e,t){var element="className"===e?y.rootElement:y.table;if(m)Gt(element,t);else{var n=[],r=[];O[e]&&(n=Array.isArray(O[e])?O[e]:ae(O[e])),t&&(r=Array.isArray(t)?t:ae(t));var o=re(n,r),l=re(r,n);o.length&&Yt(element,o),l.length&&Gt(element,l)}O[e]=t}function _(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function I(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function H(e,source,t){if(e.length){var n=y.getActiveEditor(),o=y.runHooks("beforeChange",e,source||"edit"),l=!0;if(!1!==o){var c=new _;c.onQueueEmpty=function(e){n&&l&&n.cancelChanges(),t(e)};for(var i=e.length-1;i>=0;i--)if(null===e[i])e.splice(i,1);else{var h=nv(e[i],4),f=h[0],d=h[1],v=h[3],col=r.propToCol(d),m=y.getCellMeta(f,col);"numeric"===m.type&&"string"==typeof v&&to(v)&&(e[i][3]=I(v)),y.getCellValidator(m)&&(c.addValidatorToQueue(),y.validateCell(e[i][3],m,function(t,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){l=!1,e.splice(t,1),n.valid=!0;var o=y.getCell(n.visualRow,n.visualCol);null!==o&&Yt(o,k.invalidCellClassName)}c.removeValidatorFormQueue()}}(i,m),source))}c.checkIfQueueIsEmpty()}else n&&n.cancelChanges()}}function j(e,source){var i=e.length-1;if(!(i<0)){for(;i>=0;i--){var t=!1;if(null!==e[i]){if(null!==e[i][2]&&void 0!==e[i][2]||null!==e[i][3]&&void 0!==e[i][3]){if(k.allowInsertRow)for(;e[i][0]>y.countRows()-1;){var n=r.createRow(void 0,void 0,source);if(!(n>=1)){t=!0;break}S.createRow(null,n)}if("array"===y.dataType&&(!k.columns||0===k.columns.length)&&k.allowInsertColumn)for(;r.propToCol(e[i][1])>y.countCols()-1;){var o=r.createCol(void 0,void 0,source);if(!(o>=1)){t=!0;break}S.createColumn(null,o)}t||r.set(e[i][0],e[i][1],e[i][3])}}else e.splice(i,1)}y.forceFullRender=!0,l.adjustRowsAndCols(),y.runHooks("beforeChangeRender",e,source),c.lockEditor(),y._refreshBorders(null),c.unlockEditor(),y.view.adjustElementsSize(),y.runHooks("afterChange",e,source||"edit");var h=y.getActiveEditor();h&&it(h.refreshValue)&&h.refreshValue()}}function D(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",x),this.rowIndexMapper.addLocalHook("cacheUpdated",x),this.selection.addLocalHook("beforeSetRangeStart",(function(e){h.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){h.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){h.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=h.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=h.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=ke(!1),n=h.selection.getSelectedRange(),r=n.current(),o=r.from,l=r.to,c=n.size()-1;h.runHooks("afterSelection",o.row,o.col,l.row,l.col,t,c),h.runHooks("afterSelectionByProp",o.row,y.colToProp(o.col),l.row,y.colToProp(l.col),t,c);var f=h.selection.isSelectedByAnyHeader(),v=h.selection.selectedRange.current(),m=!0;d&&(m=!1),t.isTouched()&&(m=!t.value);var w=h.selection.isSelectedByRowHeader(),C=h.selection.isSelectedByColumnHeader();!1!==m&&(f?w?h.view.scrollViewportVertically(y.rowIndexMapper.getRenderableFromVisualIndex(e.row)):C&&h.view.scrollViewportHorizontally(y.columnIndexMapper.getRenderableFromVisualIndex(e.col)):v&&!h.selection.isMultiple()?h.view.scrollViewport(E(v.from)):h.view.scrollViewport(E(e))),w&&C?Gt(h.rootElement,["ht__selection--rows","ht__selection--columns"]):w?(Yt(h.rootElement,"ht__selection--columns"),Gt(h.rootElement,"ht__selection--rows")):C?(Yt(h.rootElement,"ht__selection--rows"),Gt(h.rootElement,"ht__selection--columns")):Yt(h.rootElement,["ht__selection--rows","ht__selection--columns"]),h._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],r=n.from,o=n.to;h.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,t),h.runHooks("afterSelectionEndByProp",r.row,y.colToProp(r.col),o.row,y.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=h.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){h.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){h.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){h.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){h.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){c.destroyEditor(),h._refreshBorders(),Yt(h.rootElement,["ht__selection--rows","ht__selection--columns"]),h.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){h.alter("insert_row",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){h.alter("insert_col",e,1,"auto")})),l={alter:function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,source=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,h=function(e){if(0===e.length)return[];var t=rv(e);return t.sort((function(e,t){var n=nv(e,1)[0],r=nv(t,1)[0];return n===r?0:n>r?1:-1})),Y(t,(function(e,t){var n=nv(t,2),r=n[0],o=n[1],l=e[e.length-1],c=nv(l,2),h=c[0]+c[1];if(r<=h){var f=Math.max(o-(h-r),0);l[1]+=f}else e.push([r,o]);return e}),[t[0]])};switch(e){case"insert_row":var f=y.countSourceRows();if(k.maxRows===f)return;if(t=it(t)?t:f,n=r.createRow(t,o,source)){S.createRow(y.toPhysicalRow(t),o);var d=A.selectedRange.current(),v=null==d?void 0:d.from,m=null==v?void 0:v.row;if(it(m)&&m>=t){var w=d.to,C=w.row,O=w.col,R=v.col;A.isSelectedByRowHeader()&&(R=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(y._createCellCoords(m+n,R),!0),A.setRangeEnd(y._createCellCoords(C+n,O))}else y._refreshBorders()}break;case"insert_col":if(n=r.createCol(t,o,source)){if(S.createColumn(y.toPhysicalColumn(t),o),Array.isArray(k.colHeaders)){var E=[t,0];E.length+=n,Array.prototype.splice.apply(k.colHeaders,E)}var T=A.selectedRange.current(),x=null==T?void 0:T.from,M=null==x?void 0:x.col;if(it(M)&&M>=t){var P=T.to,_=P.row,I=P.col,H=x.row;A.isSelectedByColumnHeader()&&(H=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(y._createCellCoords(H,M+n),!0),A.setRangeEnd(y._createCellCoords(_,I+n))}else y._refreshBorders()}break;case"remove_row":var j=function(e){var t=0;$(e,(function(e){var n=nv(e,2),o=n[0],l=n[1],c=lt(o)?y.countRows()-1:Math.max(o-t,0);if(Number.isInteger(o)&&(o=Math.max(o-t,0)),r.removeRow(o,l,source)){S.removeRow(y.toPhysicalRow(c),l);var h=y.countRows(),f=k.fixedRowsTop;f>=c+1&&(k.fixedRowsTop-=Math.min(l,f-c));var d=k.fixedRowsBottom;d&&c>=h-d&&(k.fixedRowsBottom-=Math.min(l,d)),t+=l}}))};Array.isArray(t)?j(h(t)):j([[t,o]]),l.adjustRowsAndCols(),y._refreshBorders();break;case"remove_col":var D=function(e){var t=0;$(e,(function(e){var n=nv(e,2),o=n[0],l=n[1],c=lt(o)?y.countCols()-1:Math.max(o-t,0),h=y.toPhysicalColumn(c);if(Number.isInteger(o)&&(o=Math.max(o-t,0)),r.removeCol(o,l,source)){S.removeColumn(h,l);var f=k.fixedColumnsStart;f>=c+1&&(k.fixedColumnsStart-=Math.min(l,f-c)),Array.isArray(k.colHeaders)&&(void 0===h&&(h=-1),k.colHeaders.splice(h,l)),t+=l}}))};Array.isArray(t)?D(h(t)):D([[t,o]]),l.adjustRowsAndCols(),y._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}c||l.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t=k.minRows,n=k.minSpareRows,o=k.minCols,l=k.minSpareCols;if(t){var c=y.countRows();c<t&&r.createRow(c,t-c,"auto")}if(n){var h=y.countEmptyRows(!0);if(h<n){var f=n-h,d=Math.min(f,k.maxRows-y.countSourceRows());r.createRow(y.countRows(),d,"auto")}}(o||l)&&(e=y.countEmptyCols(!0));var v=y.countCols();if(o&&!k.columns&&v<o){var m=o-v;e+=m,r.createCol(v,m,"auto")}if(l&&!k.columns&&"array"===y.dataType&&e<l){v=y.countCols();var w=l-e,C=Math.min(w,k.maxCols-v);r.createCol(v,C,"auto")}var S=y.countRows(),O=y.countCols();0!==S&&0!==O||A.deselect(),A.isSelected()&&$(A.selectedRange,(function(e){var t=!1,n=e.from.row,r=e.from.col,o=e.to.row,l=e.to.col;n>S-1?(t=!0,o>(n=S-1)&&(o=n)):o>S-1&&(t=!0,n>(o=S-1)&&(n=o)),r>O-1?(t=!0,l>(r=O-1)&&(l=r)):l>O-1&&(t=!0,r>(l=O-1)&&(r=l)),t&&y.selectCell(n,r,o,l)})),y.view&&y.view.adjustElementsSize()},populateFromArray:function(e,input,t,source,n,r,o){var l,c,h,f,d=[],v={},m=[],w=e.row,C=e.col;if(0===(c=input.length))return!1;var S=0,O=0;switch(ve(t)&&(S=t.col-C+1,O=t.row-w+1),n){case"shift_down":var R=G(input),E=R.length,T=Math.max(E,S),A=y.getData().slice(w),x=G(A).slice(C,C+T);for(h=0;h<T;h+=1)if(h<E){for(l=0,c=R[h].length;l<O-c;l+=1)R[h].push(R[h][l%c]);h<x.length?m.push(R[h].concat(x[h])):m.push(R[h].concat(new Array(A.length).fill(null)))}else m.push(R[h%E].concat(x[h]));y.populateFromArray(w,C,G(m));break;case"shift_right":var M=input.length,P=Math.max(M,O),_=y.getData().slice(w).map((function(e){return e.slice(C)}));for(l=0;l<P;l+=1)if(l<M){for(h=0,f=input[l].length;h<S-f;h+=1)input[l].push(input[l][h%f]);var I;if(l<_.length)for(var i=0;i<_[l].length;i+=1)input[l].push(_[l][i]);else(I=input[l]).push.apply(I,rv(new Array(_[0].length).fill(null)))}else input.push(input[l%c].slice(0,P).concat(_[l]));y.populateFromArray(w,C,input);break;default:v.row=e.row,v.col=e.col;var H,j={row:t&&e?t.row-e.row+1:1,col:t&&e?t.col-e.col+1:1},D=0,N=0,L=!0,B=function(e){var col=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=input[e%input.length];return null!==col?t[col%t.length]:t},V=input.length,F=t?t.row-e.row+1:0;for(c=t?F:Math.max(V,F),l=0;l<c&&!(t&&v.row>t.row&&F>V||!k.allowInsertRow&&v.row>y.countRows()-1||v.row>=k.maxRows);l++){var W=l-D,U=B(W).length,z=t?t.col-e.col+1:0;if(f=t?z:Math.max(U,z),v.col=e.col,H=y.getCellMeta(v.row,v.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!H.skipRowOnPaste){for(N=0,h=0;h<f&&!(t&&v.col>t.col&&z>U||!k.allowInsertColumn&&v.col>y.countCols()-1||v.col>=k.maxCols);h++)if(H=y.getCellMeta(v.row,v.col),"CopyPaste.paste"!==source&&"Autofill.fill"!==source||!H.skipColumnOnPaste)if(H.readOnly&&"UndoRedo.undo"!==source)v.col+=1;else{var Y=h-N,K=B(W,Y),X=y.getDataAtCell(v.row,v.col),$={row:W,col:Y};if("Autofill.fill"===source){var Q=y.runHooks("beforeAutofillInsidePopulate",$,r,input,o,{},j);Q&&(K=at(Q.value)?K:Q.value)}if(null!==K&&"object"===tv(K))if(Array.isArray(K)&&null===X&&(X=[]),null===X||"object"!==tv(X))L=!1;else ge(ue(Array.isArray(X)?X:X[0]||X),ue(Array.isArray(K)?K:K[0]||K))?K=de(K):L=!1;else null!==X&&"object"===tv(X)&&(L=!1);L&&d.push([v.row,v.col,K]),L=!0,v.col+=1}else N+=1,v.col+=1,f+=1;v.row+=1}else D+=1,v.row+=1,c+=1}y.setDataAtCell(d,null,null,source||"populateFromArray")}}},this.init=function(){o.setData(k.data),y.runHooks("beforeInit"),(Ve()||We())&&Gt(y.rootElement,"mobile"),this.updateSettings(k,!0),this.view=new oc(this),c=Wr.getInstance(y,k,A),y.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===tv(m)&&(y.runHooks("afterChange",m[0],m[1]),m=!1),y.runHooks("afterInit")},this._createCellCoords=function(e,t){return y.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return y.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,source){var r,o=y.getCellValidator(t);function l(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==t.hidden){var col=t.visualCol,o=t.visualRow,td=y.getCell(o,col,!0);if(td&&"TH"!==td.nodeName){var l=y.rowIndexMapper.getRenderableFromVisualIndex(o),c=y.columnIndexMapper.getRenderableFromVisualIndex(col);y.view._wt.getSetting("cellRenderer",l,c,td)}n(e)}else n(e)}st(o)&&(r=o,o=function(e,t){t(r.test(e))}),In(o)?(e=y.runHooks("beforeValidate",e,t.visualRow,t.prop,source),y._registerImmediate((function(){o.call(t,e,(function(n){y&&(n=y.runHooks("afterValidate",n,e,t.visualRow,t.prop,source),t.valid=n,l(n),y.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,source))}))}))):y._registerImmediate((function(){t.valid=!0,l(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,source){var i,l,c,input=D(e,t,n),h=[],f=source;for(i=0,l=input.length;i<l;i++){if("object"!==tv(input[i]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof input[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=input[i][1]>=this.countCols()?input[i][1]:r.colToProp(input[i][1]),h.push([input[i][0],c,o.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]])}f||"object"!==tv(e)||(f=t),y.runHooks("afterSetDataAtCell",h,f),H(h,f,(function(){j(h,f)}))},this.setDataAtRowProp=function(e,t,n,source){var i,r,input=D(e,t,n),l=[],c=source;for(i=0,r=input.length;i<r;i++)l.push([input[i][0],input[i][1],o.getAtCell(this.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);c||"object"!==tv(e)||(c=t),y.runHooks("afterSetDataAtRowProp",l,c),H(l,c,(function(){j(l,c)}))},this.listen=function(){y&&!y.isListening()&&(lv=y.guid,y.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(lv=null,y.runHooks("afterUnlisten"))},this.isListening=function(){return lv===y.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];y._refreshBorders(e,t)},this.populateFromArray=function(e,t,input,n,r,source,o,c,h){if("object"!==tv(input)||"object"!==tv(input[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var f="number"==typeof n?y._createCellCoords(n,r):null;return l.populateFromArray(y._createCellCoords(e,t),input,f,source,o,c,h)},this.spliceCol=function(e,t,n){for(var o,l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];return(o=r).spliceCol.apply(o,[e,t,n].concat(c))},this.spliceRow=function(e,t,n){for(var o,l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];return(o=r).spliceRow.apply(o,[e,t,n].concat(c))},this.getSelected=function(){if(A.isSelected())return X(A.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(source){var e=this;if(A.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var t=[];$(A.getSelectedRange(),(function(n){var r=n.getTopStartCorner(),o=n.getBottomEndCorner();no(r.row,o.row,(function(n){no(r.col,o.col,(function(r){e.getCellMeta(n,r).readOnly||t.push([n,r,null])}))}))})),t.length>0&&this.setDataAtCell(t,source)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(y.view){var e=y.view.getLastSize(),t=e.width,n=e.height,r=y.rootElement.getBoundingClientRect(),o=r.width,l=r.height,c=o!==t||l!==n;!1===y.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:o,height:l},c)||((c||y.view._wt.wtOverlays.scrollableElement===y.rootWindow)&&(y.view.setLastSize(o,l),y.render()),y.runHooks("afterRefreshDimensions",{width:t,height:n},{width:o,height:l},c))}},this.updateData=function(data,source){var e=this;Fg(data,(function(e){r=e}),(function(t){r=t,y.columnIndexMapper.fitToLength(e.getInitialColumnCount()),y.rowIndexMapper.fitToLength(e.countSourceRows()),l.adjustRowsAndCols()}),{hotInstance:y,dataMap:r,dataSource:o,internalSource:"updateData",source:source,firstRun:m})},this.loadData=function(data,source){Fg(data,(function(e){r=e}),(function(){S.clearCellsCache(),y.initIndexMappers(),l.adjustRowsAndCols(),m&&(m=[null,"loadData"])}),{hotInstance:y,dataMap:r,dataSource:o,internalSource:"loadData",source:source,firstRun:m})},this.getInitialColumnCount=function(){var e=k.columns,t=0;if(Array.isArray(e))t=e.length;else if(In(e))if("array"===y.dataType)for(var n=this.countSourceCols(),o=0;o<n;o+=1)e(o)&&(t+=1);else"object"!==y.dataType&&"function"!==y.dataType||(t=r.colToPropCache.length);else if(it(k.dataSchema)){var l=r.getSchema();t=Array.isArray(l)?l.length:Se(l)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,o){return at(e)?r.getAll():r.getRange(y._createCellCoords(e,t),y._createCellCoords(n,o),r.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,o){return r.getCopyableText(y._createCellCoords(e,t),y._createCellCoords(n,o))},this.getCopyableData=function(e,t){return r.getCopyable(e,r.colToProp(t))},this.getSchema=function(){return r.getSchema()},this.updateSettings=function(e){var i,t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=(m?y.loadData:y.updateData).bind(this),h=!1;if(it(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(it(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(it(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(i in e)"data"===i||("language"===i?M(e.language):"className"===i?P("className",e.className):"tableClassName"===i&&y.table?(P("tableClassName",e.tableClassName),y.view._wt.wtOverlays.syncOverlayTableClassNames()):dr.getSingleton().isRegistered(i)||dr.getSingleton().isDeprecated(i)?(In(e[i])||Array.isArray(e[i]))&&(e[i].initialHook=!0,y.addHook(i,e[i])):!n&&Oe(e,i)&&(O[i]=e[i]));void 0===e.data&&void 0===k.data?o(null,"updateSettings"):void 0!==e.data?o(e.data,"updateSettings"):void 0!==e.columns&&(r.createMap(),y.initIndexMappers());var f=y.countCols(),d=k.columns;if(d&&In(d)&&(h=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||S.clearCache(),f>0)for(i=0,t=0;i<f;i++){if(d){var v=h?d(i):d[t];v&&S.updateColumnMeta(t,v)}t+=1}it(e.cell)&&be(e.cell,(function(e){y.setCellMetaObject(e.row,e.col,e)})),y.runHooks("afterCellMetaReset");var w=y.rootElement.style.height;""!==w&&(w=parseInt(y.rootElement.style.height,10));var C=e.height;if(In(C)&&(C=C()),n){var R=y.rootElement.getAttribute("style");R&&y.rootElement.setAttribute("data-initialstyle",y.rootElement.getAttribute("style"))}if(null===C){var E=y.rootElement.getAttribute("data-initialstyle");E&&(E.indexOf("height")>-1||E.indexOf("overflow")>-1)?y.rootElement.setAttribute("style",E):(y.rootElement.style.height="",y.rootElement.style.overflow="")}else void 0!==C&&(y.rootElement.style.height=isNaN(C)?"".concat(C):"".concat(C,"px"),y.rootElement.style.overflow="hidden");if(void 0!==e.width){var T=e.width;In(T)&&(T=T()),y.rootElement.style.width=isNaN(T)?"".concat(T):"".concat(T,"px")}n||(y.view&&(y.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),y.view._wt.exportSettingsAsClassNames()),y.runHooks("afterUpdateSettings",e)),l.adjustRowsAndCols(),y.view&&!m&&(y.forceFullRender=!0,c.lockEditor(),y._refreshBorders(null),y.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),n||!y.view||""!==w&&""!==C&&void 0!==C||w===C||y.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=y.getSelectedLast();if(k.getValue){if(In(k.getValue))return k.getValue.call(y);if(e)return y.getData()[e[0][0]][k.getValue]}else if(e)return y.getDataAtCell(e[0],e[1])},this.getSettings=function(){return k},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,source,r){l.alter(e,t,n,source,r)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===r?null:y.view.getCellAtCoords(y._createCellCoords(o,r),n)},this.getCoords=function(element){var e=this.view._wt.wtTable.getCoords(element);if(null===e)return null;var t=e.row,n=e.col,r=t,o=n;return t>=0&&(r=this.rowIndexMapper.getVisualFromRenderableIndex(t)),n>=0&&(o=this.columnIndexMapper.getVisualFromRenderableIndex(n)),y._createCellCoords(r,o)},this.colToProp=function(e){return r.colToProp(e)},this.propToCol=function(e){return r.propToCol(e)},this.toVisualRow=function(e){return h.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return h.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return h.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return h.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return r.get(e,r.colToProp(t))},this.getDataAtRowProp=function(e,t){return r.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,rv(r.getRange(y._createCellCoords(0,e),y._createCellCoords(k.data.length-1,e),r.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=r.getRange(y._createCellCoords(0,r.propToCol(e)),y._createCellCoords(k.data.length-1,r.propToCol(e)),r.DESTINATION_RENDERER);return(t=[]).concat.apply(t,rv(n))},this.getSourceData=function(e,t,n,r){return void 0===e?o.getData():o.getByRange(y._createCellCoords(e,t),y._createCellCoords(n,r))},this.getSourceDataArray=function(e,t,n,r){return void 0===e?o.getData(!0):o.getByRange(y._createCellCoords(e,t),y._createCellCoords(n,r),!0)},this.getSourceDataAtCol=function(e){return o.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,source){var input=D(e,t,n),r=this.hasHook("afterSetSourceDataAtCell"),l=[];r&&$(input,(function(e){var t=nv(e,3),n=t[0],r=t[1],c=t[2];l.push([n,r,o.getAtCell(n,r),c])})),$(input,(function(e){var t=nv(e,3),n=t[0],r=t[1],l=t[2];o.setAtCell(n,r,l)})),r&&this.runHooks("afterSetSourceDataAtCell",l,source),this.render();var c=y.getActiveEditor();c&&it(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(e){return o.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return o.getAtCell(e,t)},this.getDataAtRow=function(e){return r.getRange(y._createCellCoords(e,0),y._createCellCoords(e,this.countCols()-1),r.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){var o=this,l=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],c=l[0],h=l[1],f=l[2],d=l[3],y=null,v=null;void 0===f&&(f=c),void 0===d&&(d=h);var m="mixed";return no(Math.max(Math.min(c,f),0),Math.max(c,f),(function(e){var t=!0;return no(Math.max(Math.min(h,d),0),Math.max(h,d),(function(n){var r=o.getCellMeta(e,n);return v=r.type,y?t=y===v:y=v,t})),m=t?v:"mixed",t})),m},this.removeCellMeta=function(e,t,n){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=r[0],l=r[1],c=S.getCellMetaKeyValue(o,l,n);!1!==y.runHooks("beforeRemoveCellMeta",e,t,n,c)&&(S.removeCellMeta(o,l,n),y.runHooks("afterRemoveCellMeta",e,t,n,c)),c=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&S.removeRow(this.toPhysicalRow(e),n),o.length>0&&$(o.reverse(),(function(n){S.createRow(t.toPhysicalRow(e)),$(n,(function(n,r){return t.setCellMetaObject(e,r,n)}))})),y.render()},this.setCellMetaObject=function(e,t,n){var r=this;"object"===tv(n)&&be(n,(function(n,o){r.setCellMeta(e,t,o,n)}))},this.setCellMeta=function(e,t,n,r){if(!1!==y.runHooks("beforeSetCellMeta",e,t,n,r)){var o=e,l=t;e<this.countRows()&&(o=this.toPhysicalRow(e)),t<this.countCols()&&(l=this.toPhysicalColumn(t)),S.setCellMeta(o,l,n,r),y.runHooks("afterSetCellMeta",e,t,n,r)}},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),S.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return S.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===y.dataType||k.columns)};var N=wc("renderer");this.getCellRenderer=function(e,t){return Bo(N.call(this,e,t))},this.getCellEditor=wc("editor");var L=wc("validator");this.getCellValidator=function(e,t){var n=L.call(this,e,t);return"string"==typeof n&&(n=Yo(n)),n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var r=new _;e&&(r.onQueueEmpty=e);for(var i=y.countRows()-1;i>=0;)if(void 0===t||-1!==t.indexOf(i)){for(var o=y.countCols()-1;o>=0;)void 0===n||-1!==n.indexOf(o)?(r.addValidatorToQueue(),y.validateCell(y.getDataAtCell(i,o),y.getCellMeta(i,o),(function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),o-=1):o-=1;i-=1}else i-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=k.rowHeaders,n=e;return void 0!==n&&(n=y.runHooks("modifyRowHeader",n)),void 0===n?(t=[],no(y.countRows()-1,(function(i){t.push(y.getRowHeader(i))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:In(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!k.rowHeaders},this.hasColHeaders=function(){if(void 0!==k.colHeaders&&null!==k.colHeaders)return!!k.colHeaders;for(var i=0,e=y.countCols();i<e;i++)if(y.getColHeader(i))return!0;return!1},this.getColHeader=function(e){var t=y.runHooks("modifyColHeader",e),n=k.colHeaders;if(void 0===t){for(var r=[],o=y.countCols(),i=0;i<o;i++)r.push(y.getColHeader(i));n=r}else{var l=y.toPhysicalColumn(t),c=function(e){for(var t=[],n=y.countCols(),r=0;r<n;r++)In(k.columns)&&k.columns(r)&&t.push(r);return t[e]}(l);!1===k.colHeaders?n=null:k.columns&&In(k.columns)&&k.columns(c)&&k.columns(c).title?n=k.columns(c).title:k.columns&&k.columns[l]&&k.columns[l].title?n=k.columns[l].title:Array.isArray(k.colHeaders)&&void 0!==k.colHeaders[l]?n=k.colHeaders[l]:In(k.colHeaders)?n=k.colHeaders(l):k.colHeaders&&"string"!=typeof k.colHeaders&&"number"!=typeof k.colHeaders&&(n=yc(t))}return n},this._getColWidthFromSettings=function(col){var e;col>=0&&(e=y.getCellMeta(0,col).width);if(void 0!==e&&e!==k.width||(e=k.colWidths),null!=e){switch(tv(e)){case"object":e=e[col];break;case"function":e=e(col)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(e){var t=y._getColWidthFromSettings(e);return void 0===(t=y.runHooks("modifyColWidth",t,e))&&(t=xu.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=k.rowHeights;if(null!=t){switch(tv(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=y._getRowHeightFromSettings(e);return t=y.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return o.countRows()},this.countSourceCols=function(){return o.countFirstRowKeys()},this.countRows=function(){return r.getLength()},this.countCols=function(){var e=k.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return y.view._wt.drawn?y.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return y.view._wt.drawn?y.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return y.view._wt.drawn?y.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return y.view._wt.drawn?y.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return ro(y.countRows()-1,(function(n){if(y.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(y.countRows()<1)return 0;var t=0;return ro(y.countCols()-1,(function(n){if(y.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return k.isEmptyRow.call(y,e)},this.isEmptyCol=function(e){return k.isEmptyCol.call(y,e)},this.selectCell=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!at(e)&&!at(t)&&this.selectCells([[e,t,n,r]],o,l)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(d=!0);var r=A.selectCells(e);return r&&n&&y.listen(),d=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return A.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return A.selectRows(e,t)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();d=!0,A.selectAll(t,n),d=!1};var B=function(e,t){return e.getFirstNotHiddenIndex(t,1,!0)};function V(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!n,c=!r,h=e,f=t;if(o){var d=Number.isInteger(e),v=Number.isInteger(t),m=d?B(this.rowIndexMapper,e):void 0,w=v?B(this.columnIndexMapper,t):void 0;if(null===m||null===w)return!1;h=d?y.rowIndexMapper.getRenderableFromVisualIndex(m):void 0,f=v?y.columnIndexMapper.getRenderableFromVisualIndex(w):void 0}var C=Number.isInteger(h),S=Number.isInteger(f);return C&&S?y.view.scrollViewport(y._createCellCoords(h,f),l,r,n,c):C&&!1===S?y.view.scrollViewportVertically(h,l,n):!(!S||!1!==C)&&y.view.scrollViewportHorizontally(f,r,c)},this.destroy=function(){if(y._clearTimeouts(),y._clearImmediates(),y.view&&y.view.destroy(),o&&o.destroy(),o=null,this.getShortcutManager().destroy(),S.clearCache(),qu(y)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}Xt(y.rootElement),v.destroy(),c&&c.destroy(),y.batchExecution((function(){y.rowIndexMapper.unregisterAll(),y.columnIndexMapper.unregisterAll(),R.getItems().forEach((function(e){nv(e,2)[1].destroy()})),R.clear(),y.runHooks("afterDestroy")}),!0),dr.getSingleton().destroy(y),be(y,(function(e,t,n){In(e)?n[t]=V(t):"guid"!==t&&(n[t]=null)})),y.isDestroyed=!0,r&&r.destroy(),y.rowIndexMapper=null,y.columnIndexMapper=null,r=null,l=null,A=null,c=null,y=null},this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(e){var t=kt(e);return"UndoRedo"===t?this.undoRedo:R.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:R.getId(e)},this.getInstance=function(){return y},this.addHook=function(e,t){dr.getSingleton().add(e,t,y)},this.hasHook=function(e){return dr.getSingleton().has(e,y)||dr.getSingleton().has(e)},this.addHookOnce=function(e,t){dr.getSingleton().once(e,t,y)},this.removeHook=function(e,t){dr.getSingleton().remove(e,t,y)},this.runHooks=function(e,t,n,r,o,l,c){return dr.getSingleton().run(y,e,t,n,r,o,l,c)},this.getTranslatedPhrase=function(e,t){return hp(k.language,e,t)},this.toHTML=function(){return Xr(h)},this.toTableElement=function(){var e=h.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",Xr(h)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;"function"==typeof n&&(n=setTimeout(n,t)),this.timeouts.push(n)},this._clearTimeouts=function(){$(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){$(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c.destroyEditor(e),y.view.render(),t&&A.isSelected()&&c.prepareEditor()},this.isRtl=function(){return"rtl"===y.rootWindow.getComputedStyle(y.rootElement).direction},this.isLtr=function(){return!y.isRtl()},this.getDirectionFactor=function(){return y.isLtr()?1:-1};var F=ev({beforeKeyDown:function(e){return!1!==h.isListening()&&h.runHooks("beforeKeyDown",e)},afterKeyDown:function(e){h.isDestroyed||y.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.getShortcutManager=function(){return F};var W=F.addContext("grid"),U={runOnlyIf:function(){return it(y.getSelected())&&y.countRenderedRows()>0&&y.countRenderedCols()>0},group:av};F.setActiveContextName("grid"),W.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){y.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var e=y.getSelectedRange(),t=e[e.length-1].highlight,n=t.row,r=t.col,o=y.getDataAtCell(n,r),l=new Map,i=0;i<e.length;i++)e[i].forAll((function(e,t){e>=0&&t>=0&&(e!==n||t!==r)&&(y.getCellMeta(e,t).readOnly||l.set("".concat(e,"x").concat(t),[e,t,o]))}));y.setDataAtCell(Array.from(l.values()))},runOnlyIf:function(){return y.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){A.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){A.setRangeStart(y._createCellCoords(y.rowIndexMapper.getFirstNotHiddenIndex(0,1),y.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){A.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=y.getSelectedRangeLast(),t=e.from,n=e.to,r=y.rowIndexMapper.getFirstNotHiddenIndex(0,1);A.setRangeStart(t.clone()),A.setRangeEnd(y._createCellCoords(r,n.col))},runOnlyIf:function(){return!(y.selection.isSelectedByCorner()||y.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){A.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){A.setRangeStart(y._createCellCoords(y.rowIndexMapper.getFirstNotHiddenIndex(y.countRows()-1,-1),y.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){A.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=y.getSelectedRangeLast(),t=e.from,n=e.to,r=y.rowIndexMapper.getFirstNotHiddenIndex(y.countRows()-1,-1);A.setRangeStart(t.clone()),A.setRangeEnd(y._createCellCoords(r,n.col))},runOnlyIf:function(){return!(y.selection.isSelectedByCorner()||y.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){A.transformStart(0,-1*y.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=y.getSelectedRangeLast().highlight.row,n=(e=y.columnIndexMapper).getFirstNotHiddenIndex.apply(e,rv(y.isRtl()?[y.countCols()-1,-1]:[0,1]));A.setRangeStart(y._createCellCoords(t,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){A.transformEnd(0,-1*y.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=y.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=y.columnIndexMapper).getFirstNotHiddenIndex.apply(e,rv(y.isRtl()?[y.countCols()-1,-1]:[0,1]));A.setRangeStart(n.clone()),A.setRangeEnd(y._createCellCoords(r.row,o))},runOnlyIf:function(){return!(y.selection.isSelectedByCorner()||y.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){A.transformStart(0,y.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=y.getSelectedRangeLast().highlight.row,n=(e=y.columnIndexMapper).getFirstNotHiddenIndex.apply(e,rv(y.isRtl()?[0,1]:[y.countCols()-1,-1]));A.setRangeStart(y._createCellCoords(t,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){A.transformEnd(0,y.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=y.getSelectedRangeLast(),n=t.from,r=t.to,o=(e=y.columnIndexMapper).getFirstNotHiddenIndex.apply(e,rv(y.isRtl()?[0,1]:[y.countCols()-1,-1]));A.setRangeStart(n.clone()),A.setRangeEnd(y._createCellCoords(r.row,o))},runOnlyIf:function(){return!(y.selection.isSelectedByCorner()||y.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var e=parseInt(y.getSettings().fixedColumnsStart,10),t=y.getSelectedRangeLast().highlight.row,n=y.columnIndexMapper.getFirstNotHiddenIndex(e,1);A.setRangeStart(y._createCellCoords(t,n))},runOnlyIf:function(){return y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){A.setRangeEnd(y._createCellCoords(A.selectedRange.current().from.row,y.columnIndexMapper.getFirstNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(y.getSettings().fixedRowsTop,10),t=parseInt(y.getSettings().fixedColumnsStart,10),n=y.rowIndexMapper.getFirstNotHiddenIndex(e,1),r=y.columnIndexMapper.getFirstNotHiddenIndex(t,1);A.setRangeStart(y._createCellCoords(n,r))},runOnlyIf:function(){return y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){A.setRangeStart(y._createCellCoords(y.getSelectedRangeLast().highlight.row,y.columnIndexMapper.getFirstNotHiddenIndex(y.countCols()-1,-1)))},runOnlyIf:function(){return y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){A.setRangeEnd(y._createCellCoords(A.selectedRange.current().from.row,y.columnIndexMapper.getFirstNotHiddenIndex(y.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(y.getSettings().fixedRowsBottom,10),t=y.rowIndexMapper.getFirstNotHiddenIndex(y.countRows()-e-1,-1),n=y.columnIndexMapper.getFirstNotHiddenIndex(y.countCols()-1,-1);A.setRangeStart(y._createCellCoords(t,n))},runOnlyIf:function(){return y.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){A.transformStart(-y.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var e=y.getSelectedRangeLast().to,t=Math.max(e.row-y.countVisibleRows(),0),n=y.rowIndexMapper.getFirstNotHiddenIndex(t,1);if(null!==n){var r=y._createCellCoords(n,e.col),o=e.row-y.view.getFirstFullyVisibleRow(),l=Math.max(r.row-o,0);A.setRangeEnd(r),y.scrollViewportTo(l)}}},{keys:[["PageDown"]],callback:function(){A.transformStart(y.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var e=y.getSelectedRangeLast().to,t=Math.min(e.row+y.countVisibleRows(),y.countRows()-1),n=y.rowIndexMapper.getFirstNotHiddenIndex(t,-1);if(null!==n){var r=y._createCellCoords(n,e.col),o=e.row-y.view.getFirstFullyVisibleRow(),l=Math.min(r.row-o,y.countRows()-1);A.setRangeEnd(r),y.scrollViewportTo(l)}}},{keys:[["Tab"]],callback:function(e){var t="function"==typeof k.tabMoves?k.tabMoves(e):k.tabMoves;A.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var t="function"==typeof k.tabMoves?k.tabMoves(e):k.tabMoves;A.transformStart(-t.row,-t.col)}}],U),Po().forEach((function(e){var t=_o(e);R.addItem(e,new t(h))})),dr.getSingleton().run(y,"construct")}var uv={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;$(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;be(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};me(uv,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var cv=uv;function hv(e){return hv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hv(e)}function fv(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return dv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dv(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dv(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function pv(e,p){return pv=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},pv(e,p)}function yv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vv(e);if(t){var o=vv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gv(this,n)}}function gv(e,t){if(t&&("object"===hv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function vv(e){return vv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vv(e)}function mv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bv(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wv(e,t,n){return t&&bv(e.prototype,t),n&&bv(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Cv=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Sv="baseEditor",kv=function(){function e(t){mv(this,e),this.hot=t,this.instance=t,this.state=Cv.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return wv(e,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,col,t,td,n,r){this.TD=td,this.row=e,this.col=col,this.prop=t,this.originalValue=n,this.cellProperties=r,this.state=Cv.VIRGIN}},{key:"extend",value:function(){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pv(e,t)}(n,e);var t=yv(n);function n(){return mv(this,n),t.apply(this,arguments)}return wv(n)}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,r,o,l,c=this;if(t){var h=this.hot.getSelectedLast();n=Math.max(Math.min(h[0],h[2]),0),r=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),l=Math.max(h[1],h[3])}else{var f=[this.row,this.col,null,null];n=f[0],r=f[1],o=f[2],l=f[3]}var d=this.hot.runHooks("modifyGetCellCoords",n,r);if(Array.isArray(d)){var y=fv(d,2);n=y[0],r=y[1]}var v=this.hot.getShortcutManager().getContext("editor"),m={runOnlyIf:function(){return it(c.hot.getSelected())},group:Sv};this.isInFullEditMode()&&v.addShortcuts([{keys:[["ArrowUp"]],callback:function(){c.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){c.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){c.hot.selection.transformStart(0,-1*c.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){c.hot.selection.transformStart(0,c.hot.getDirectionFactor())}}],m),this.hot.populateFromArray(n,r,e,o,l,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===Cv.VIRGIN){var n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(r,o)),this.state=Cv.EDITING,this.isInFullEditMode()){var l="string"==typeof e?e:ot(this.originalValue);this.setValue(l)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,o=this;if(n){var l=this._closeCallback;this._closeCallback=function(e){l&&l(e),n(e),o.hot.view.render()}}if(!this.isWaiting()){var c=this.hot.getShortcutManager().getContext("editor");if(c.removeShortcutsByGroup(Sv),c.removeShortcutsByGroup(Lr),this.state!==Cv.VIRGIN){if(this.state===Cv.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var h=this.getValue();r=this.hot.getSettings().trimWhitespace?[["string"==typeof h?String.prototype.trim.call(h||""):h]]:[[h]],this.state=Cv.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){o.state=Cv.FINISHED,o.discardEditor(e)})):(this.state=Cv.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=Cv.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===Cv.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Cv.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Cv.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Cv.WAITING}},{key:"getEditedCellRect",value:function(){var e,t=this.getEditedCell();if(t){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,l=this.hot.rootWindow,c=en(t),h=hn(t),f=en(this.hot.rootElement),d=hn(this.hot.rootElement),y=r.topOverlay.holder,v=r.inlineStartOverlay.holder,m=y!==l?y.scrollTop:0,w=v!==l?v.scrollLeft:0,C=l.innerWidth-f.left-d,S=(null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt).wtTable,k=S.name,O=["master","inline_start"].includes(k)?m:0,R=["master","top","bottom"].includes(k)?w:0,E=c.top===f.top?0:1,T=c.top-f.top-E-O,A=0;A=this.hot.isRtl()?l.innerWidth-c.left-h-C-1+R:c.left-f.left-1-R,["top","top_inline_start_corner"].includes(k)&&(T+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(k)&&(A+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var x=this.hot.hasColHeaders(),M=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),P=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),_=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&M<=0||M===_)&&(T+=1),P<=0&&(A+=1);var I=o.rowsRenderCalculator.startPosition,H=o.columnsRenderCalculator.startPosition,j=Math.abs(r.inlineStartOverlay.getScrollPosition()),D=r.topOverlay.getScrollPosition(),N=kn(this.hot.rootDocument),L=t.offsetTop+I-D,B=0;if(this.hot.isRtl()){var V=t.offsetLeft;B=V>=0?S.getWidth()-t.offsetLeft:Math.abs(V),B+=H-j-h}else B=t.offsetLeft+H-j;var F=cn(this.TD,this.hot.rootWindow),W=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",U=parseInt(F[W],10)>0?0:1,z=parseInt(F.borderTopWidth,10)>0?0:1,G=hn(t)+U,Y=fn(t)+z,K=On(y)?N:0,X=Rn(v)?N:0,$=this.hot.view.maximumVisibleElementWidth(B)-K+U;return{top:T,start:A,height:Y,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(L)-X+z,23),width:G,maxWidth:$}}}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),section="";return this.row<this.hot.getSettings().fixedRowsTop?section=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?section=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(section="inline-start"),section}}],[{key:"EDITOR_TYPE",get:function(){return"base"}}]),e}();function Ov(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},body=document.body,text=document.createTextNode(""),span=document.createElement("SPAN"),n=function(element,e,t){element.addEventListener(e,t,!1)},r=function(element,e,t){element.removeEventListener(e,t,!1)},o=function(n){var r,o;n?/^[a-zA-Z \.,\\\/\|0-9]$/.test(n)||(n="."):n="",void 0!==text.textContent?text.textContent=e.value+n:text.data=e.value+n,span.style.fontSize=h(e).fontSize,span.style.fontFamily=h(e).fontFamily,span.style.whiteSpace="pre",body.appendChild(span),r=span.clientWidth+2,body.removeChild(span),e.style.height=t.minHeight+"px",t.minWidth>r?e.style.width=t.minWidth+"px":r>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=r+"px",o=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>o?e.style.height=t.minHeight+"px":t.maxHeight<o?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=o+"px"},l=function(){window.setTimeout(o,0)},c=function(r,c,h){e=r,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var r=parseInt(n.minHeight);isNaN(r)||(t.minHeight=r)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var o=parseInt(n.maxHeight);isNaN(o)||(t.maxHeight=o)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(t.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var c=parseInt(n.maxWidth);isNaN(c)||(t.maxWidth=c)}span.firstChild||(span.className="autoResize",span.style.display="inline-block",span.appendChild(text))}(c),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),h&&(n(e,"change",o),n(e,"cut",l),n(e,"paste",l),n(e,"drop",l),n(e,"keydown",l),n(e,"focus",o),n(e,"compositionstart",l),n(e,"compositionupdate",l),n(e,"compositionend",l)),o()};function h(element){return element.currentStyle||document.defaultView.getComputedStyle(element)}return{init:function(e,t,n){c(e,t,n)},unObserve:function(){r(e,"change",o),r(e,"cut",l),r(e,"paste",l),r(e,"drop",l),r(e,"keydown",l),r(e,"focus",o),r(e,"compositionstart",l),r(e,"compositionupdate",l),r(e,"compositionend",l)},resize:o}}function Rv(e,t){for(var n=vn(t),r=t.value.split("\n"),o=n,l=0,i=0;i<r.length;i++){var c=r[i];0!==i&&(l+=r[i-1].length+1);var h=l+c.length;if("home"===e?o=l:"end"===e&&(o=h),n<=h)break}Cn(t,o)}function Ev(e){return Ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ev(e)}function Tv(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Av(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Av(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Av(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function xv(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mv(){return Mv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Pv(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Mv.apply(this,arguments)}function Pv(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Dv(object)););return object}function _v(e,p){return _v=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},_v(e,p)}function Iv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dv(e);if(t){var o=Dv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hv(this,n)}}function Hv(e,t){if(t&&("object"===Ev(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jv(e)}function jv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dv(e){return Dv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dv(e)}ye(kv,cv);var Nv="ht_editor_hidden",Lv="textEditor",Bv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_v(e,t)}(l,e);var t,n,r,o=Iv(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).eventManager=new Hr(jv(t)),t.autoResize=Ov(),t.TEXTAREA=void 0,t.textareaStyle=void 0,t.TEXTAREA_PARENT=void 0,t.textareaParentStyle=void 0,t.layerClass=void 0,t.createElements(),t.bindEvents(),t.hot.addHookOnce("afterDestroy",(function(){return t.destroy()})),t}return t=l,n=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(t){return e.onAfterDocumentKeyDown(t)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(e,col,t,td,n,r){var o=this.state;if(Mv(Dv(l.prototype),"prepare",this).call(this,e,col,t,td,n,r),!r.readOnly){this.refreshDimensions(!0);var c=r.allowInvalid,h=r.fragmentSelection;c&&(this.TEXTAREA.value=""),o!==Cv.FINISHED&&this.hideEditableElement(),!h&&!Ve()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===Cv.VIRGIN&&(this.TEXTAREA.value="",Mv(Dv(l.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),Cn(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Gt(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Gt(this.TEXTAREA_PARENT,"handsontableInputHolder"),zt(this.TEXTAREA_PARENT,this.layerClass)&&Yt(this.TEXTAREA_PARENT,this.layerClass),Gt(this.TEXTAREA_PARENT,Nv),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Ne()||je())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Yt(this.TEXTAREA_PARENT,this.layerClass),Gt(this.TEXTAREA_PARENT,Nv)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;no(e.length-1,(function(n){if(zt(e[n],"handsontableEditor"))return t=!0,!1})),zt(this.TEXTAREA_PARENT,Nv)&&Yt(this.TEXTAREA_PARENT,Nv),t?(this.layerClass="ht_editor_visible",Gt(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Gt(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===Cv.EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),n=t.top,r=t.start,o=t.width,l=t.maxWidth,c=t.height,h=t.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(r,"px"),this.showEditableElement();var f=cn(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=f.fontSize,this.TEXTAREA.style.fontFamily=f.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=cn(this.TEXTAREA),y=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),v=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),m=o-y,w=c-v,C=l-y,S=h-v;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,C),minHeight:Math.min(w,S),maxWidth:C,maxHeight:S},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),Fe()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return e.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:function(){return it(e.hot.getSelected())},group:Lv},r=function(){e.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"==typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(t){return!e.hot.selection.isMultiple()&&!t.altKey},relativeToGroup:Br,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return r(),!1},runOnlyIf:function(){return!e.hot.selection.isMultiple()},relativeToGroup:Br,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return r(),!1},relativeToGroup:Br,position:"before"},{keys:[["PageUp"]],callback:function(){e.hot.selection.transformStart(-e.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){e.hot.selection.transformStart(e.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(t,n){Rv(Tv(n,1)[0],e.TEXTAREA)}},{keys:[["End"]],callback:function(t,n){Rv(Tv(n,1)[0],e.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}}],n)}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager().getContext("editor");e.removeShortcutsByGroup(Lr),e.removeShortcutsByGroup(Lv),e.removeShortcutsByGroup(Sv)}},{key:"onAfterDocumentKeyDown",value:function(e){-1===[Un.ARROW_UP,Un.ARROW_RIGHT,Un.ARROW_DOWN,Un.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}],r=[{key:"EDITOR_TYPE",get:function(){return"text"}}],n&&xv(t.prototype,n),r&&xv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(kv);function Vv(e,t,n,col,r,o,l){var c=[],h=[];l.className&&Gt(t,l.className),l.readOnly&&c.push(l.readOnlyCellClassName),!1===l.valid&&l.invalidCellClassName?c.push(l.invalidCellClassName):h.push(l.invalidCellClassName),!1===l.wordWrap&&l.noWordWrapClassName&&c.push(l.noWordWrapClassName),!o&&l.placeholder&&c.push(l.placeholderCellClassName),Yt(t,h),Gt(t,c)}Vv.RENDERER_TYPE="base";function Fv(e,t,n,col,r,o,l){Vv.apply(this,[e,t,n,col,r,o,l]);var c=o;if(!c&&l.placeholder&&(c=l.placeholder),c=ot(c),e.getSettings().trimWhitespace&&(c=c.trim()),l.rendererTemplate){Xt(t);var h=e.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=l.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=e.getSourceDataAtRow(n),t.appendChild(h)}else Jt(t,c)}Fv.RENDERER_TYPE="text";var Wv={CELL_TYPE:"text",editor:Bv,renderer:Fv};function Uv(e,t){var n=new sv(e,t||{},Ku);return n.init(),n}hc(Wv),Uv.editors={BaseEditor:kv},Uv.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new sv(e,t,Ku)},Uv.DefaultSettings=sg(),Uv.hooks=dr.getSingleton(),Uv.packageName="handsontable",Uv.buildDate="13/05/2022 13:50:15",Uv.version="12.0.1",Uv.languages={dictionaryKeys:k,getLanguageDictionary:up,getLanguagesDictionaries:function(){return lp()},registerLanguageDictionary:sp,getTranslatedPhrase:hp};var zv=Uv;function Gv(e){return Gv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gv(e)}function Yv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kv(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xv(){return Xv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=$v(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Xv.apply(this,arguments)}function $v(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Zv(object)););return object}function qv(e,p){return qv=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},qv(e,p)}function Qv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zv(e);if(t){var o=Zv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jv(this,n)}}function Jv(e,t){if(t&&("object"===Gv(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zv(e){return Zv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zv(e)}var tm="handsontableEditor",nm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qv(e,t)}(l,e);var t,n,r,o=Qv(l);function l(){return Yv(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"handsontable"}}],(n=[{key:"open",value:function(){Xv(Zv(l.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Cn(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),Xv(Zv(l.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,col,t,td,n,r){Xv(Zv(l.prototype),"prepare",this).call(this,e,col,t,td,n,r);var o=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&o.setValue(n),o.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&he(c,r.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(e,t){var n=this.hot.getSettings().onBeginEditing;n&&!1===n()||Xv(Zv(l.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){Xv(Zv(l.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var r=this.htEditor.getInstance().getValue();void 0!==r&&this.setValue(r)}Xv(Zv(l.prototype),"finishEditing",this).call(this,e,t,n)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor");Xv(Zv(l.prototype),"registerShortcuts",this).call(this);var n={group:tm,relativeToGroup:Lr,position:"before"},r=function(t,n){var r=e.htEditor.getInstance();if(void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length))return n.preventDefault(),qn(n),e.hot.listen(),e.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:function(t){var n,o,l=e.htEditor.getInstance();return!l.getSelectedLast()&&l.flipped?n=l.countRows()-1:l.getSelectedLast()&&(l.flipped?(o=l.getSelectedLast()[0],n=Math.max(0,o-1)):n=(o=l.getSelectedLast()[0])-1),r(n,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(t){var n,o,l=e.htEditor.getInstance();if(l.getSelectedLast()||l.flipped){if(l.getSelectedLast())if(l.flipped)n=l.getSelectedLast()[0]+1;else if(!l.flipped){var c=l.countRows()-1;o=l.getSelectedLast()[0],n=Math.min(c,o+1)}}else n=0;return r(n,t)},preventDefault:!1}],n)}},{key:"unregisterShortcuts",value:function(){Xv(Zv(l.prototype),"unregisterShortcuts",this).call(this),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tm)}}])&&Kv(t.prototype,n),r&&Kv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Bv);function rm(e){return rm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rm(e)}function om(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function im(){return im="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=am(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},im.apply(this,arguments)}function am(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=hm(object)););return object}function lm(e,p){return lm=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},lm(e,p)}function sm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hm(e);if(t){var o=hm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return um(this,n)}}function um(e,t){if(t&&("object"===rm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return cm(e)}function cm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hm(e){return hm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hm(e)}var fm=new WeakMap,dm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lm(e,t)}(l,e);var t,n,r,o=sm(l);function l(e){var t,n,r,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=o.call(this,e),n=cm(t),c=function(e,t,n){var r,o,i,l,c=[],h=[],f=e.length,d=t.length;if(0===f){for(i=0;i<d;i++)h.push(i);return h}for(i=0;i<d;i++){if(o=At(ot(t[i])),n)l=o.indexOf(e);else{var y=this.cellProperties.locale;l=o.toLocaleLowerCase(y).indexOf(e.toLocaleLowerCase(y))}-1!==l&&(r=o.length-l-f,c.push({baseIndex:i,index:l,charsLeft:r,value:o}))}for(c.sort((function(a,b){if(-1===b.index)return-1;if(-1===a.index)return 1;if(a.index<b.index)return-1;if(b.index<a.index)return 1;if(a.index===b.index){if(a.charsLeft<b.charsLeft)return-1;if(a.charsLeft>b.charsLeft)return 1}return 0})),i=0,d=c.length;i<d;i++)h.push(c[i].baseIndex);return h},(r="sortByRelevance")in n?Object.defineProperty(n,r,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[r]=c,t.query=null,t.strippedChoices=[],t.rawChoices=[],fm.set(cm(t),{skipOne:!1,isMacOS:t.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),t}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"autocomplete"}}],(n=[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value}));return it(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){im(hm(l.prototype),"createElements",this).call(this),Gt(this.htContainer,"autocompleteEditor"),Gt(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=fm.get(this);im(hm(l.prototype),"open",this).call(this);var n=this.htEditor.getInstance(),r=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var o=kn();0===o&&t.isMacOS&&(o+=15),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)})),n.updateSettings({colWidths:r?[hn(this.TEXTAREA)-2]:void 0,width:r?hn(this.TEXTAREA)+o:void 0,renderer:function(t,n,r,col,o,l,c){Fv(t,n,r,col,o,l,c);var h,f,d=e.cellProperties,y=d.filteringCaseSensitive,v=d.allowHtml,m=d.locale,w=e.query,C=ot(l);C&&!v&&-1!==(h=!0===y?C.indexOf(w):C.toLocaleLowerCase(m).indexOf(w.toLocaleLowerCase(m)))&&(f=C.substr(h,w.length),C=C.replace(f,"<strong>".concat(f,"</strong>"))),n.innerHTML=C},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),im(hm(l.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){im(hm(l.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,source=this.cellProperties.source;this.query=e,"function"==typeof source?source.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(source)?(this.rawChoices=source,this.updateChoicesList(this.stripValuesIfNeeded(source))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=vn(this.TEXTAREA),n=mn(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,l=null,c=null,h=e;r&&(l=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),h,this.cellProperties.filteringCaseSensitive));var f=Array.isArray(l)?l.length:0;if(!1===o)f&&(c=l[0]);else{for(var d=[],i=0,y=h.length;i<y&&!(r&&f<=i);i++)f?d.push(h[l[i]]):d.push(h[i]);c=0,h=d}this.strippedChoices=h,this.htEditor.loadData(G([h])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(c),this.hot.listen(),Cn(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=en(this.TEXTAREA),t=fn(this.TEXTAREA),n=this.getDropdownHeight(),r=ln(this.hot.view._wt.wtTable.TABLE),o=r.scrollTop,l=fn(this.hot.view._wt.wtTable.THEAD),c={row:0,col:0};r!==this.hot.rootWindow&&(c=en(r));var h=e.top-c.top-l+o,f=r.scrollHeight-h-l-t,d=n>f&&h>f;return d?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:f,n),d}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var n,r=0,i=0,o=0;do{r+=o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=1}while(r<e);n=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-n,"px")),this.setDropdownHeight(r-o)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+kn(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,n=X(e,(function(e){return ot(e)}));return X(n,(function(e){return t?e:At(e)}))}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1,r=!1;return e===Un.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),e===Un.ARROW_UP&&n>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=fm.get(this);if(n.skipOne=!1,Gn(e.keyCode)||e.keyCode===Un.BACKSPACE||e.keyCode===Un.DELETE||e.keyCode===Un.INSERT){var r=10;if(e.keyCode===Un.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),r)}}}])&&om(t.prototype,n),r&&om(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(nm);function pm(e){return pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pm(e)}function ym(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vm(e,p){return vm=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},vm(e,p)}function mm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wm(e);if(t){var o=wm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bm(this,n)}}function bm(e,t){if(t&&("object"===pm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wm(e){return wm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wm(e)}var Cm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vm(e,t)}(l,e);var t,n,r,o=mm(l);function l(){return ym(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"checkbox"}}],(n=[{key:"beginEditing",value:function(e,t){if(t&&"mouseup"===t.type){var n=this.TD.querySelector('input[type="checkbox"]');zt(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}])&&gm(t.prototype,n),r&&gm(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(kv),Sm=n(891);function km(e){return km="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},km(e)}function Om(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rm(){return Rm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Em(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Rm.apply(this,arguments)}function Em(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Mm(object)););return object}function Tm(e,p){return Tm=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Tm(e,p)}function Am(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mm(e);if(t){var o=Mm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xm(this,n)}}function xm(e,t){if(t&&("object"===km(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Mm(e){return Mm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mm(e)}var Pm="date",_m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tm(e,t)}(l,e);var t,n,r,o=Am(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).defaultDateFormat="DD/MM/YYYY",t.isCellEdited=!1,t.parentDestroyed=!1,t.$datePicker=null,t}return t=l,n=[{key:"init",value:function(){var e=this;if("function"!=typeof Ze)throw new Error("You need to include moment.js to your project.");if("function"!=typeof Sm)throw new Error("You need to include Pikaday to your project.");Rm(Mm(l.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){e.parentDestroyed=!0,e.destroyElements()}))}},{key:"createElements",value:function(){Rm(Mm(l.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Gt(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new Hr(this).addEventListener(this.datePicker,"mousedown",(function(e){return e.stopPropagation()}))}},{key:"destroyElements",value:function(){var e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}},{key:"prepare",value:function(e,col,t,td,n,r){Rm(Mm(l.prototype),"prepare",this).call(this,e,col,t,td,n,r)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Rm(Mm(l.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var e,t=this;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((function(){t.instance._refreshBorders()})),Rm(Mm(l.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}Rm(Mm(l.prototype),"finishEditing",this).call(this,e,t)}},{key:"showDatepicker",value:function(e){var t,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),l=!!e&&Yn(e.keyCode);this.datePicker.style.display="block",this.$datePicker=new Sm(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+fn(this.TD),"px");var c=this.hot.rootWindow.pageXOffset;c=this.hot.isRtl()?n.right-hn(this.datePicker):n.left,this.datePickerStyle.left="".concat(c,"px"),this.originalValue?(t=this.originalValue,Ze(t,r,!0).isValid()&&this.$datePicker.setMoment(Ze(t,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),l||o||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,Ze(t,r,!0).isValid()&&this.$datePicker.setMoment(Ze(t,r),!0),l||o||this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&fe(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=function(t){var n=t;isNaN(n.getTime())||(n=Ze(n).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(n),e.hideDatepicker(),r&&r()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),o&&o()},n}}],r=[{key:"EDITOR_TYPE",get:function(){return Pm}}],n&&Om(t.prototype,n),r&&Om(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Bv);function Im(e){return Im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Im(e)}function Hm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dm(){return Dm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Nm(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Dm.apply(this,arguments)}function Nm(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Fm(object)););return object}function Lm(e,p){return Lm=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Lm(e,p)}function Bm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fm(e);if(t){var o=Fm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vm(this,n)}}function Vm(e,t){if(t&&("object"===Im(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fm(e){return Fm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fm(e)}var Wm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lm(e,t)}(l,e);var t,n,r,o=Bm(l);function l(){return Hm(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"dropdown"}}],(n=[{key:"prepare",value:function(e,col,t,td,n,r){Dm(Fm(l.prototype),"prepare",this).call(this,e,col,t,td,n,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}])&&jm(t.prototype,n),r&&jm(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dm);function Um(e){return Um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Um(e)}function zm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ym(e,p){return Ym=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Ym(e,p)}function Km(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$m(e);if(t){var o=$m(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xm(this,n)}}function Xm(e,t){if(t&&("object"===Um(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $m(e){return $m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$m(e)}dr.getSingleton().add("beforeValidate",(function(e,t,col){var n=this.getCellMeta(t,this.propToCol(col));n.editor===Wm&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));var qm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ym(e,t)}(l,e);var t,n,r,o=Km(l);function l(){return zm(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"numeric"}}],(n=null)&&Gm(t.prototype,n),r&&Gm(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Bv);function Qm(e){return Qm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qm(e)}function Jm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zm(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function eb(){return eb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=tb(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},eb.apply(this,arguments)}function tb(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=ib(object)););return object}function nb(e,p){return nb=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},nb(e,p)}function rb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ib(e);if(t){var o=ib(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ob(this,n)}}function ob(e,t){if(t&&("object"===Qm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ib(e){return ib=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ib(e)}var ab=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nb(e,t)}(l,e);var t,n,r,o=rb(l);function l(){return Jm(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"password"}}],(n=[{key:"createElements",value:function(){eb(ib(l.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Xt(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}])&&Zm(t.prototype,n),r&&Zm(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Bv);function lb(e){return lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lb(e)}function sb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ub(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cb(){return cb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=hb(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},cb.apply(this,arguments)}function hb(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=yb(object)););return object}function fb(e,p){return fb=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},fb(e,p)}function db(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yb(e);if(t){var o=yb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pb(this,n)}}function pb(e,t){if(t&&("object"===lb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yb(e){return yb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yb(e)}var gb="ht_editor_visible",vb="selectEditor",mb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fb(e,t)}(l,e);var t,n,r,o=db(l);function l(){return sb(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"select"}}],(n=[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Gt(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(e){this.select.value=e}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",zt(this.select,gb)&&Yt(this.select,gb),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var e=this;this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return e.refreshDimensions()})),this.addHook("afterRowResize",(function(){return e.refreshDimensions()}))}},{key:"prepare",value:function(e,col,t,td,n,r){var o=this;cb(yb(l.prototype),"prepare",this).call(this,e,col,t,td,n,r);var c,h=this.cellProperties.selectOptions;c="function"==typeof h?this.prepareOptions(h(this.row,this.col,this.prop)):this.prepareOptions(h),Xt(this.select),be(c,(function(e,t){var n=o.hot.rootDocument.createElement("OPTION");n.value=t,Qt(n,e),o.select.appendChild(n)}))}},{key:"prepareOptions",value:function(e){var t={};if(Array.isArray(e))for(var i=0,n=e.length;i<n;i++)t[e[i]]=e[i];else"object"===lb(e)&&(t=e);return t}},{key:"refreshValue",value:function(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Cv.EDITING)if(this.TD=this.getEditedCell(),this.TD){var e=this.getEditedCellRect(),t=e.top,n=e.start,r=e.width,o=e.height,l=this.select.style;l.height="".concat(o,"px"),l.width="".concat(r,"px"),l.top="".concat(t,"px"),l[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),l.margin="0px",Gt(this.select,gb)}else this.close()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor"),n={group:vb};!1!==this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var t=e.select.selectedIndex-1;t>=0&&(e.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var t=e.select.selectedIndex+1;t<=e.select.length-1&&(e.select[t].selected=!0)}}],n)}},{key:"unregisterShortcuts",value:function(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(vb)}}])&&ub(t.prototype,n),r&&ub(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(kv);function bb(e){return bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bb(e)}function wb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cb(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sb(){return Sb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=kb(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Sb.apply(this,arguments)}function kb(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Tb(object)););return object}function Ob(e,p){return Ob=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Ob(e,p)}function Rb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tb(e);if(t){var o=Tb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Eb(this,n)}}function Eb(e,t){if(t&&("object"===bb(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Tb(e){return Tb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tb(e)}var Ab=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ob(e,t)}(l,e);var t,n,r,o=Rb(l);function l(){return wb(this,l),o.apply(this,arguments)}return t=l,r=[{key:"EDITOR_TYPE",get:function(){return"time"}}],(n=[{key:"prepare",value:function(e,col,t,td,n,r){Sb(Tb(l.prototype),"prepare",this).call(this,e,col,t,td,n,r),this.TEXTAREA.dir="ltr"}}])&&Cb(t.prototype,n),r&&Cb(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Bv);function xb(e,t,n,col,r,o,l){Vv.apply(this,[e,t,n,col,r,o,l]),Qt(t,null==o?"":o,!1)}xb.RENDERER_TYPE="html";function Mb(e,t,n,col,r,o,l){var c=e.rootDocument,h=l.allowHtml?xb:Fv,f=c.createElement("DIV");if(f.className="htAutocompleteArrow",f.appendChild(c.createTextNode(String.fromCharCode(9660))),h.apply(this,[e,t,n,col,r,o,l]),t.firstChild||t.appendChild(c.createTextNode(String.fromCharCode(160))),t.insertBefore(f,t.firstChild),Gt(t,"htAutocomplete"),!e.acArrowListener){var d=new Hr(e);e.acArrowListener=function(r){zt(r.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,col),t)},d.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){d.destroy()}))}}Mb.RENDERER_TYPE="autocomplete";var Pb=new WeakMap,_b=new WeakMap,Ib="data-row",Hb="data-col",jb="checkboxRenderer",Db="checkbox";function Nb(e,t,n,col,r,o,l){var c=e.rootDocument;Vv.apply(this,[e,t,n,col,r,o,l]),function(e){var t=_b.get(e);if(!t){var n=e.rootElement;(t=new Hr(e)).addEventListener(n,"click",(function(t){return function(e,t){var n=e.target;if(!Lb(n))return;if(!n.hasAttribute(Ib)||!n.hasAttribute(Hb))return;var r=parseInt(n.getAttribute(Ib),10),col=parseInt(n.getAttribute(Hb),10);t.getCellMeta(r,col).readOnly&&e.preventDefault()}(t,e)})),t.addEventListener(n,"mouseup",(function(t){return function(e,t){var n=e.target;if(!Lb(n))return;if(!n.hasAttribute(Ib)||!n.hasAttribute(Hb))return;setTimeout(t.listen,10)}(t,e)})),t.addEventListener(n,"change",(function(t){return function(e,t){var n=e.target;if(!Lb(n))return;if(!n.hasAttribute(Ib)||!n.hasAttribute(Hb))return;var r=parseInt(n.getAttribute(Ib),10),col=parseInt(n.getAttribute(Hb),10),o=t.getCellMeta(r,col);if(!o.readOnly){var l=null;l=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(r,col,l)}}(t,e)})),_b.set(e,t)}}(e);var h,f,input=function(e){var input=e.createElement("input");return input.className="htCheckboxRendererInput",input.type="checkbox",input.setAttribute("autocomplete","off"),input.setAttribute("tabindex","-1"),input.cloneNode(!1)}(c),d=l.label,y=!1;if(void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1),Xt(t),o===l.checkedTemplate||ot(o).toLocaleLowerCase(l.locale)===ot(l.checkedTemplate).toLocaleLowerCase(l.locale)?input.checked=!0:o===l.uncheckedTemplate||ot(o).toLocaleLowerCase(l.locale)===ot(l.uncheckedTemplate).toLocaleLowerCase(l.locale)?input.checked=!1:lt(o)?Gt(input,"noValue"):(input.style.display="none",Gt(input,"htBadValue"),y=!0),input.setAttribute(Ib,n),input.setAttribute(Hb,col),!y&&d){var v="";if(d.value)v="function"==typeof d.value?d.value.call(this,n,col,r,o):d.value;else if(d.property){var m=e.getDataAtRowProp(n,d.property);v=null!==m?m:""}var label=function(e,text,t){var label=e.createElement("label");return label.className="htCheckboxRendererLabel ".concat(t?"fullWidth":""),label.appendChild(e.createTextNode(text)),label.cloneNode(!0)}(c,v,!0!==d.separated);"before"===d.position?d.separated?(t.appendChild(label),t.appendChild(input)):(label.appendChild(input),input=label):d.position&&"after"!==d.position||(d.separated?(t.appendChild(input),t.appendChild(label)):(label.insertBefore(input,label.firstChild),input=label))}function w(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getSelectedRange();if(n)for(var r=0;r<n.length;r++){for(var o=n[r].getTopStartCorner(),l=o.row,c=o.col,h=n[r].getBottomEndCorner(),f=h.row,d=h.col,y=[],v=l;v<=f;v+=1)for(var m=c;m<=d;m+=1){var w=e.getCellMeta(v,m);if("checkbox"!==w.type)return;if(!0!==w.readOnly){void 0===w.checkedTemplate&&(w.checkedTemplate=!0),void 0===w.uncheckedTemplate&&(w.uncheckedTemplate=!1);var C=e.getDataAtCell(v,m);!1===t?[w.checkedTemplate,w.checkedTemplate.toString()].includes(C)?y.push([v,m,w.uncheckedTemplate]):[w.uncheckedTemplate,w.uncheckedTemplate.toString(),null,void 0].includes(C)&&y.push([v,m,w.checkedTemplate]):y.push([v,m,w.uncheckedTemplate])}}y.length>0&&e.setDataAtCell(y)}}function C(){var t=e.getSelectedRange();if(t){for(var n=0;n<t.length;n++)for(var r=t[n].getTopStartCorner(),o=t[n].getBottomEndCorner(),l=r.row;l<=o.row;l++)for(var c=r.col;c<=o.col;c++){var h=e.getCellMeta(l,c);if("checkbox"!==h.type)return!1;var f=e.getCell(l,c);if(null==f)return!0;if(f.querySelectorAll("input[type=checkbox]").length>0&&!h.readOnly)return!0}return!1}}(!d||d&&!d.separated)&&t.appendChild(input),y&&t.appendChild(c.createTextNode("#bad-value#")),Pb.has(e)||(Pb.set(e,!0),h=e.getShortcutManager().getContext("grid"),f={group:jb},h.addShortcuts([{keys:[["space"]],callback:function(){return w(),!C()}},{keys:[["enter"]],callback:function(){return w(),!C()},runOnlyIf:function(){return e.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return w(!0),!C()},relativeToGroup:Br,position:"before"}],f))}function Lb(element){return"INPUT"===element.tagName&&"checkbox"===element.getAttribute("type")}dr.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,n){var label=t.label,r=t.type,o=t.row,l=t.column,c=t.prop;if(r===Db){if(label){var h=label.value,f=label.property,d=n;if(h)d="function"==typeof h?h(o,l,c,n):h;else if(f){var y=this.getDataAtRowProp(o,f);d=null!==y?y:n}e=d}return e}})),Nb.RENDERER_TYPE=Db;var Bb=n(892);function Vb(e,t,n,col,r,o,l){var c=o;if(eo(c)){var h=l.numericFormat,f=h&&h.culture||"-",d=h&&h.pattern,y=l.className||"",v=y.length?y.split(" "):[];if(void 0!==f&&!Bb.languages()[f]){var m=f.replace("-",""),w=Bb.allLanguages?Bb.allLanguages[f]:Bb[m];w&&Bb.registerLanguage(w)}Bb.setLanguage(f),c=Bb(c).format(d||"0"),v.indexOf("htLeft")<0&&v.indexOf("htCenter")<0&&v.indexOf("htRight")<0&&v.indexOf("htJustify")<0&&v.push("htRight"),v.indexOf("htNumeric")<0&&v.push("htNumeric"),l.className=v.join(" "),t.dir="ltr"}Fv(e,t,n,col,r,c,l)}Vb.RENDERER_TYPE="numeric";function Fb(e,t,n,col,r,o,l){Fv.apply(this,[e,t,n,col,r,o,l]);var c=l.hashLength||t.innerHTML.length,h=l.hashSymbol||"*",f="";no(c-1,(function(){f+=h})),Qt(t,f)}Fb.RENDERER_TYPE="password";function Wb(e,t,n,col,r,o,l){Fv.apply(this,[e,t,n,col,r,o,l]),t.dir="ltr"}Wb.RENDERER_TYPE="time";function Ub(e,t){var n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,zb(n,t)):zb(n,t)(this.source):t(!0)}function zb(e,t){var n=e;return function(source){for(var e=!1,s=0,r=source.length;s<r;s++)if(n===source[s]){e=!0;break}t(e)}}Ub.VALIDATOR_TYPE="autocomplete";n(784);function Gb(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}function Yb(e,t){var n=Er(Pm,this.instance),r=e,o=!0;null==r&&(r="");var l=Ze(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),c=Ze(new Date(r)).isValid()||l;if(this.allowEmpty&&""===r&&(c=!0,l=!0),c||(o=!1),!c&&l&&(o=!0),c&&!l)if(!0===this.correctFormat){var h=function(e,t){var n,r=Ze(Gb(e)),o=Ze(e,t),l=e.search(/[A-z]/g)>-1;n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||l?r:o;return n.format(t)}(r,this.dateFormat),f=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(f,d,h,"dateValidator"),o=!0}else o=!1;t(o)}Yb.VALIDATOR_TYPE="date";function Kb(e,t){var n=e;null==n&&(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&eo(e))}Kb.VALIDATOR_TYPE="numeric";var Xb=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function $b(e,t){var n=this.timeFormat||"h:mm:ss a",r=!0,o=e;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var l=/^\d{1,2}$/.test(o);l&&(o+=":00");var c=Ze(o,Xb,!0).isValid()?Ze(o):Ze(o,n),h=c.isValid(),f=Ze(o,n,!0).isValid()&&!l;if(this.allowEmpty&&""===o&&(h=!0,f=!0),h||(r=!1),!h&&f&&(r=!0),h&&!f)if(!0===this.correctFormat){var d=c.format(n),y=this.instance.toVisualRow(this.row),v=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(y,v,d,"timeValidator"),r=!0}else r=!1;t(r)}$b.VALIDATOR_TYPE="time";var qb={CELL_TYPE:"autocomplete",editor:dm,renderer:Mb,validator:Ub},Qb={CELL_TYPE:"checkbox",editor:Cm,renderer:Nb},Jb={CELL_TYPE:"date",editor:_m,renderer:Mb,validator:Yb},Zb={CELL_TYPE:"dropdown",editor:Wm,renderer:Mb,validator:Ub},ew={CELL_TYPE:"handsontable",editor:nm,renderer:Mb},tw={CELL_TYPE:"numeric",editor:qm,renderer:Vb,validator:Kb,dataType:"number"},nw={CELL_TYPE:"password",editor:ab,renderer:Fb,copyable:!1},rw={CELL_TYPE:"time",editor:Ab,renderer:Wb,validator:$b};n(785);function ow(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return iw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iw(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iw(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function aw(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lw(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}var sw=new Map([["plugin",function(e){return!!_o(e)}],["cell-type",sc],["editor",kr],["renderer",No],["validator",zo]]),uw=new WeakMap,cw=[],hw=null,fw=new WeakSet,dw=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),lw(this,fw),me(this,"hot",t,{writable:!1}),uw.set(this,{hooks:{}}),hw=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}var t,n,r;return t=e,n=[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var t=this.constructor.PLUGIN_DEPS,n=Array.isArray(t)?t:[];if(n.length>0){var r=[];if(n.forEach((function(e){var t=ow(e.split(":"),2),n=t[0],o=t[1];if(!sw.has(n))throw new Error('Unknown plugin dependency type "'.concat(n,'" was found.'));sw.get(n)(o)||r.push(" - ".concat(o," (").concat(n,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");cw.push(o)}}if(hw||(hw=Po()),hw.indexOf("UndoRedo")>=0&&hw.splice(hw.indexOf("UndoRedo"),1),hw.indexOf(this.pluginName)>=0&&hw.splice(hw.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()})),0===hw.length){if(cw.length>0){var l=["".concat(cw.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){uw.get(this).hooks[e]=uw.get(this).hooks[e]||[];var n=uw.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),uw.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;$(uw.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=uw.get(this).hooks;be(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){$(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){var t=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,fw,pw).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),be(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}],r=[{key:"PLUGIN_KEY",get:function(){return"base"}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}],n&&aw(t.prototype,n),r&&aw(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function pw(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if("boolean"==typeof t)return t;for(var i=0;i<t.length;i++)if(void 0!==e[t[i]])return!0;return!1}function yw(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return gw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gw(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gw(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function vw(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var mw=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var t,n,r;return t=e,n=[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var t=this.hot.getColHeader(0);if(null!=t){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),$(this.rows,(function(t){e(t.row,fn(t.table)-1)}))}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),$(this.columns,(function(t){var n=t.table.getBoundingClientRect().width;e(t.col,Math.ceil(n))}))}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){$(n.strings,(function(n){t.appendChild(e.createColElement(n.col))}))})),t}},{key:"createRow",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),th=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,th),r.appendChild(th)),this.samples.forEach((function(o){$(o.strings,(function(o){var l=o.col,c=t.hot.getCellMeta(e,l);c.col=l,c.row=e;var h=t.hot.getCellRenderer(c),td=n.createElement("td");td.setAttribute("ghost-table",1),h(t.hot,td,e,l,t.hot.colToProp(l),o.value,c),r.appendChild(td)}))})),r}},{key:"appendColumnHeadersRow",value:function(){var e=this,t=this.hot.rootDocument,n=t.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){var th=t.createElement("th");r.push([-1,th]),n.appendChild(th)}this.samples.forEach((function(e){$(e.strings,(function(e){var o=e.col,th=t.createElement("th");r.push([o,th]),n.appendChild(th)}))})),this.table.tHead.appendChild(n),$(r,(function(t){var n=yw(t,2),r=n[0],th=n[1];e.hot.view.appendColHeader(r,th)}))}},{key:"createCol",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(o){$(o.strings,(function(o){var l=o.row,c=t.hot.getCellMeta(l,e);c.col=e,c.row=l;var h=t.hot.getCellRenderer(c),td=n.createElement("td"),tr=n.createElement("tr");td.setAttribute("ghost-table",1),h(t.hot,td,l,e,t.hot.colToProp(e),o.value,c),tr.appendChild(td),r.appendChild(tr)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var col=this.hot.rootDocument.createElement("col");return col.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(e),"px"),col}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),table=t.createElement("table"),r=t.createElement("thead"),o=t.createElement("tbody"),l=t.createElement("colgroup"),tr=t.createElement("tr"),th=t.createElement("th");return this.isVertical()&&table.appendChild(l),this.isHorizontal()&&(tr.appendChild(th),r.appendChild(tr),table.style.tableLayout="auto",table.style.width="auto"),table.appendChild(r),this.isVertical()&&o.appendChild(tr),table.appendChild(o),Gt(table,e),n.appendChild(table),{fragment:n,table:table,tHead:r,tBody:o,colGroup:l,tr:tr,th:th}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),r=t.createElement("div"),o="htGhostTable htAutoSize ".concat(e.trim());return Gt(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}],n&&vw(t.prototype,n),r&&vw(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),bw=mw;function ww(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Cw=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}var t,n,r;return t=e,r=[{key:"SAMPLE_COUNT",get:function(){return 3}}],(n=[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,n){var r=this,o=new Map,l="number"==typeof n?{from:n,to:n}:n;return no(l.from,l.to,(function(n){var l=r.generateSample(e,t,n);o.set(n,l)})),o}},{key:"generateSample",value:function(e,t,n){var r=this;if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");var o=new Map,l="row"===e?"col":"row",c=[];return no(t.from,t.to,(function(t){var h,f="row"===e?r.dataFactory(n,t):r.dataFactory(t,n),d=f.value,y=f.bundleSeed,v="string"==typeof y&&y.length>0;h=v?y:ve(d)?"".concat(Object.keys(d).length):Array.isArray(d)?"".concat(d.length):"".concat(ot(d).length),o.has(h)||o.set(h,{needed:r.getSampleCount(),strings:[]});var m=o.get(h);m.needed&&(!(c.indexOf(d)>-1)||r.allowDuplicates||v)&&(m.strings.push(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({value:d},l,t)),c.push(d),m.needed-=1)})),o}}])&&ww(t.prototype,n),r&&ww(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Sw=Cw;function kw(e){return kw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kw(e)}function Ow(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return Rw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rw(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rw(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ew(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tw(){return Tw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Aw(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Tw.apply(this,arguments)}function Aw(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Iw(object)););return object}function xw(e,p){return xw=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},xw(e,p)}function Mw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Iw(e);if(t){var o=Iw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pw(this,n)}}function Pw(e,t){if(t&&("object"===kw(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _w(e)}function _w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iw(e){return Iw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Iw(e)}dr.getSingleton().register("modifyAutoColumnSizeSeed");var Hw="autoColumnSize",jw=new WeakMap,Dw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xw(e,t)}(l,e);var t,n,r,o=Mw(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=o.call(this,e),jw.set(_w(t),{cachedColumnHeaders:[]}),t.ghostTable=new bw(t.hot),t.samplesGenerator=new Sw((function(e,n){var r=t.hot.getCellMeta(e,n),o="";r.spanned||(o=t.hot.getDataAtCell(e,n));var l="";return t.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=t.hot.runHooks("modifyAutoColumnSizeSeed",l,r,o)),{value:o,bundleSeed:l}})),t.firstCalculation=!0,t.inProgress=!1,t.measuredColumns=0,t.columnWidthsMap=new uh,t.hot.columnIndexMapper.registerMap("autoColumnSize",t.columnWidthsMap),t.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)})),t}return t=l,n=[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeChangeRender",(function(t){return e.onBeforeChange(t)})),this.addHook("afterFormulasValuesUpdate",(function(t){return e.onAfterFormulasValuesUpdate(t)})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyColWidth",(function(t,col){return e.getColumnWidth(col,t)})),this.addHook("afterInit",(function(){return e.onAfterInit()})),Tw(Iw(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),Tw(Iw(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this;Tw(Iw(l.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)}))}},{key:"calculateVisibleColumnsWidth",value:function(){if(this.hot.countRows()){var e=this.hot.renderCall,t=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==t&&-1!==n&&this.calculateColumnsWidth({from:t,to:n},void 0,e)}}},{key:"calculateColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof t?{from:t,to:t}:t,l="number"==typeof n?{from:n,to:n}:n;no(o.from,o.to,(function(t){var n=e.hot.toPhysicalColumn(t);null===n&&(n=t),(r||null===e.columnWidthsMap.getValueAtIndex(n)&&!e.hot._getColWidthFromSettings(n))&&$(e.samplesGenerator.generateColumnSamples(t,l),(function(t){var n=Ow(t,2),r=n[0],o=n[1];return e.ghostTable.addColumn(r,o)}))})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){e.ghostTable.getWidths((function(t,n){var r=e.hot.toPhysicalColumn(t);e.columnWidthsMap.setValueAtIndex(r,n)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0,r=this.hot.countCols()-1,o=null;this.inProgress=!0;var c=function c(){if(!e.hot)return L(o),void(e.inProgress=!1);e.calculateColumnsWidth({from:n,to:Math.min(n+l.CALCULATION_STEP,r)},t),(n=n+l.CALCULATION_STEP+1)<r?o=H(c):(L(o),e.inProgress=!1,e.hot.view.adjustElementsSize())},h=this.getSyncCalculationLimit();this.firstCalculation&&h>=0&&(this.calculateColumnsWidth({from:0,to:h},t),this.firstCalculation=!1,n=h+1),n<r?c():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoColumnSize,t=e&&Oe(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Oe(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings().autoColumnSize,t=l.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return ve(e)&&(Et(t=e.syncLimit)?t=oo(n,t):t>>=0),Math.min(t,n)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"==typeof r&&(r=Math.max(r,xu.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=jw.get(this).cachedColumnHeaders;return Y(e,(function(e,n,r){var o=t.length;return(o-1<r||t[r]!==n)&&e.push(r),o-1<r?t.push(n):t[r]=n,e}),[])}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((function(){$(t,(function(t){e.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!K(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){e.hot&&e.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(e){var t=this,n=X(e,(function(e){var n=Ow(e,2)[1];return t.hot.toPhysicalColumn(t.hot.propToCol(n))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(e,t,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){jw.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(e){var t=X(K(e,(function(e){var t;return it(null===(t=e.address)||void 0===t?void 0:t.col)})),(function(e){return e.address.col}));this.clearCache(Array.from(new Set(t)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Tw(Iw(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Hw}},{key:"PLUGIN_PRIORITY",get:function(){return 10}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}],n&&Ew(t.prototype,n),r&&Ew(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw),Nw={horizontal:"horizontal",vertical:"vertical"};function Lw(e){return Lw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lw(e)}function Bw(e){return function(e){if(Array.isArray(e))return Ww(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fw(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vw(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||Fw(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fw(e,t){if(e){if("string"==typeof e)return Ww(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ww(e,t):void 0}}function Ww(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Uw(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zw(){return zw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Gw(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},zw.apply(this,arguments)}function Gw(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=qw(object)););return object}function Yw(e,p){return Yw=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Yw(e,p)}function Kw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qw(e);if(t){var o=qw(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xw(this,n)}}function Xw(e,t){if(t&&("object"===Lw(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $w(e)}function $w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qw(e){return qw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qw(e)}dr.getSingleton().register("modifyAutofillRange"),dr.getSingleton().register("beforeAutofill"),dr.getSingleton().register("afterAutofill");var Qw="autofill",Jw=["fillHandle"],Zw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yw(e,t)}(l,e);var t,n,r,o=Kw(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).eventManager=new Hr($w(t)),t.addingStarted=!1,t.mouseDownOnCellCorner=!1,t.mouseDragOutside=!1,t.handleDraggedCells=0,t.directions=[],t.autoInsertRow=!1,t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return Qw}},{key:"PLUGIN_PRIORITY",get:function(){return 20}},{key:"SETTING_KEYS",get:function(){return[Qw].concat(Jw)}}],(n=[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.onAfterCellCornerMouseDown(t)})),this.addHook("afterOnCellCornerDblClick",(function(t){return e.onCellCornerDblClick(t)})),this.addHook("beforeOnCellMouseOver",(function(t,n){return e.onBeforeCellMouseOver(n)})),zw(qw(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),zw(qw(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),zw(qw(l.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var e=this,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),r=n.row,o=n.col,l=t.getBottomEndCorner(),c=l.row,h=l.col,f=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:o,endRow:c,endCol:h}]),d=[],y=[],data=[];return $(f,(function(e){for(var t=e.startRow;t<=e.endRow;t+=1)-1===d.indexOf(t)&&d.push(t);for(var n=e.startCol;n<=e.endCol;n+=1)-1===y.indexOf(n)&&y.push(n)})),$(d,(function(t){var n=[];$(y,(function(r){n.push(e.hot.getCopyableData(t,r))})),data.push(n)})),data}},{key:"fillIn",value:function(){var e=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=Vw(this.hot.selection.highlight.getFill().getVisualCorners(),4),n=t[0],r=t[1],o=t[2],l=t[3],c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),f=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var d=[h.row,h.col,f.row,f.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,n),Math.min(h.col,r),Math.max(f.row,o),Math.max(f.col,l)],d),v=function(e,t,n){var r,o,l;return t[0]===e[0]&&t[1]<e[1]?(l="left",r=n(t[0],t[1]),o=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(l="right",r=n(t[0],e[3]+1),o=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(l="up",r=n(t[0],t[1]),o=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(l="down",r=n(e[2]+1,t[1]),o=n(t[2],t[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:l,startOfDragCoords:r,endOfDragCoords:o}}(d,y,(function(t,n){return e.hot._createCellCoords(t,n)})),m=v.directionOfDrag,w=v.startOfDragCoords,C=v.endOfDragCoords;if(w&&w.row>-1&&w.col>-1){var S=this.getSelectionData(),k=c.clone(),O=this.hot._createCellRange(w,w,C),R=this.hot.runHooks("beforeAutofill",S,k,O,m);if(!1===R)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var E=function(e,t,data,n){var r=data.length,o=data?data[0].length:0,l=[],c=t.row-e.row,h=t.col-e.col;if(-1!==["down","up"].indexOf(n)){for(var f=[],col=0;col<h;col++){var d=parseInt(data[0][col],10),y=parseInt(data[r-1][col],10),v=("down"===n?y-d:d-y)/(r-1)||0;f.push(v)}l.push(f)}if(-1!==["right","left"].indexOf(n))for(var m=0;m<c;m++){var w=parseInt(data[m][0],10),C=parseInt(data[m][o-1],10),S=("right"===n?C-w:w-C)/(o-1)||0;l.push([S])}return l}(w,C,S,m),T=R,A=R;if(["up","left"].indexOf(m)>-1&&(1!==A.length||0!==A[0].length))if(T=[],"up"===m)for(var x=C.row-w.row+1,M=x%A.length,i=0;i<x;i++)T.push(A[(i+(A.length-M))%A.length]);else for(var P=C.col-w.col+1,_=P%A[0].length,I=0;I<A.length;I++){T.push([]);for(var H=0;H<P;H++)T[I].push(A[I][(H+(A[I].length-_))%A[I].length])}this.hot.populateFromArray(w.row,w.col,T,C.row,C.col,"".concat(this.pluginName,".fill"),null,m,E),this.setSelection(y),this.hot.runHooks("afterAutofill",T,k,O,m),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}},{key:"getCoordsOfDragAndDropBorders",value:function(e){var t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner(),r=e;if(this.directions.includes(Nw.vertical)&&this.directions.includes(Nw.horizontal)){var o=t.getTopStartCorner();(n.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(Nw.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(Nw.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(e){var t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var e=this;this.hot._registerTimeout((function(){e.hot.alter("insert_row",void 0,1,"".concat(e.pluginName,".fill")),e.addingStarted=!1}),200)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(e){for(var t,data=this.hot.getData(),n=this.hot.countRows(),r=e[2]+1;r<n;r++){for(var o=e[1];o<=e[3];o++)if(data[r][o])return-1;var l=data[r][e[1]-1],c=data[r][e[3]+1];(l||c)&&(t=r)}return t}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}},{key:"setSelection",value:function(e){var t;(t=this.hot).selectCell.apply(t,Bw(X(e,(function(e){return Math.max(e,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(e){var t=this.hot.rootDocument.documentElement,n=en(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+fn(this.hot.table),r=en(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+hn(this.hot.table);return e.clientY>n&&e.clientX<=r}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)}))}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(e){var t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var e=function(e){var t={};return!0===e?(t.directions=Object.keys(Nw),t.autoInsertRow=!0):ve(e)?(it(e.autoInsertRow)?e.direction===Nw.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,it(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(Nw)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}},{key:"destroy",value:function(){zw(qw(l.prototype),"destroy",this).call(this)}}])&&Uw(t.prototype,n),r&&Uw(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function eC(e){return eC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eC(e)}function tC(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return nC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nC(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nC(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function rC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oC(){return oC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=iC(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},oC.apply(this,arguments)}function iC(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=uC(object)););return object}function aC(e,p){return aC=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},aC(e,p)}function lC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uC(e);if(t){var o=uC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sC(this,n)}}function sC(e,t){if(t&&("object"===eC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function uC(e){return uC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uC(e)}var cC="autoRowSize",hC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aC(e,t)}(l,e);var t,n,r,o=lC(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).rowHeightsMap=void 0,t.headerHeight=null,t.ghostTable=new bw(t.hot),t.samplesGenerator=new Sw((function(e,col){var n;return e>=0?n=t.hot.getDataAtCell(e,col):-1===e&&(n=t.hot.getColHeader(col)),{value:n}})),t.firstCalculation=!0,t.inProgress=!1,t.measuredRows=0,t.rowHeightsMap=new uh,t.hot.rowIndexMapper.registerMap("autoRowSize",t.rowHeightsMap),t.addHook("beforeRowResize",(function(e,n,r){return t.onBeforeRowResize(e,n,r)})),t}return t=l,n=[{key:"isEnabled",value:function(){var e=this.hot.getSettings().autoRowSize;return!0===e||ve(e)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeChangeRender",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeColumnResize",(function(){return e.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(t){return e.onBeforeViewRender(t)})),this.addHook("modifyRowHeight",(function(t,n){return e.getRowHeight(n,t)})),this.addHook("modifyColumnHeaderHeight",(function(){return e.getColumnHeaderHeight()})),oC(uC(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this;this.headerHeight=null,oC(uC(l.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(t,n,r){return e.onBeforeRowResize(t,n,r)}))}},{key:"calculateRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof t?{from:t,to:t}:t,l="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var c=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(c.get(-1))}no(o.from,o.to,(function(t){(r||null===e.rowHeightsMap.getValueAtIndex(t))&&$(e.samplesGenerator.generateRowSamples(t,l),(function(t){var n=tC(t,2),r=n[0],o=n[1];return e.ghostTable.addRow(r,o)}))})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){e.ghostTable.getHeights((function(t,n){t<0?e.headerHeight=n:e.rowHeightsMap.setValueAtIndex(e.hot.toPhysicalRow(t),n)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0,r=this.hot.countRows()-1,o=null;this.inProgress=!0;var c=function c(){if(!e.hot)return L(o),void(e.inProgress=!1);e.calculateRowsHeight({from:n,to:Math.min(n+l.CALCULATION_STEP,r)},t),(n=n+l.CALCULATION_STEP+1)<r?o=H(c):(L(o),e.inProgress=!1,e.hot.view.adjustElementsSize(!0),e.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&e.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},h=this.getSyncCalculationLimit();this.firstCalculation&&h>=0&&(this.calculateRowsHeight({from:0,to:h},t),this.firstCalculation=!1,n=h+1),n<r?c():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoRowSize,t=e&&Oe(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&Oe(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Zt(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=this.hot.getSettings().autoRowSize,t=l.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return ve(e)&&(Et(t=e.syncLimit)?t=oo(n,t):t>>=0),Math.min(t,n)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),r=t;return null!==n&&n>(t||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(e){var t=this,n="number"==typeof e?{from:e,to:e}:e,r=n.from,o=n.to;this.hot.batchExecution((function(){no(Math.min(r,o),Math.max(r,o),(function(e){t.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!K(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(e){return null===e})).length}},{key:"onBeforeViewRender",value:function(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,e),t){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-t,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){e.hot&&e.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.ghostTable.clean(),oC(uC(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return cC}},{key:"PLUGIN_PRIORITY",get:function(){return 40}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}],n&&rC(t.prototype,n),r&&rC(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw),fC=new Map([["indexesSequence",{getListWithInsertedItems:Dc,getListWithRemovedItems:Nc}],["physicallyIndexed",{getListWithInsertedItems:Qc,getListWithRemovedItems:Jc}]]),dC=function(e){if(!1===fC.has(e))throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return fC.get(e)};function pC(e){return pC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pC(e)}function yC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gC(){return gC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=vC(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},gC.apply(this,arguments)}function vC(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=CC(object)););return object}function mC(e,p){return mC=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},mC(e,p)}function bC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=CC(e);if(t){var o=CC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wC(this,n)}}function wC(e,t){if(t&&("object"===pC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function CC(e){return CC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},CC(e)}var SC=dC("physicallyIndexed"),kC=SC.getListWithInsertedItems,OC=SC.getListWithRemovedItems,RC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mC(e,t)}(l,e);var t,n,r,o=bC(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,(function(e){return e}))}return t=l,(n=[{key:"insert",value:function(e,t){var n=Bc(this.indexedValues,t);this.indexedValues=kC(n,e,t,this.initValueOrFn),gC(CC(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=OC(this.indexedValues,e);this.indexedValues=Lc(t,e),gC(CC(l.prototype),"remove",this).call(this,e)}}])&&yC(t.prototype,n),r&&yC(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ic);function EC(e){return EC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},EC(e)}function TC(e){return function(e){if(Array.isArray(e))return AC(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return AC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AC(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AC(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function xC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function MC(){return MC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=PC(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},MC.apply(this,arguments)}function PC(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=jC(object)););return object}function _C(e,p){return _C=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},_C(e,p)}function IC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jC(e);if(t){var o=jC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HC(this,n)}}function HC(e,t){if(t&&("object"===EC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jC(e){return jC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jC(e)}var DC=dC("physicallyIndexed"),NC=DC.getListWithInsertedItems,LC=DC.getListWithRemovedItems;function BC(e){return BC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BC(e)}function VC(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FC(){return FC="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=WC(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},FC.apply(this,arguments)}function WC(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=YC(object)););return object}function UC(e,p){return UC=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},UC(e,p)}function zC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=YC(e);if(t){var o=YC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GC(this,n)}}function GC(e,t){if(t&&("object"===BC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function YC(e){return YC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},YC(e)}var KC="bindRowsWithHeaders",XC=new Map([["loose",RC],["strict",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_C(e,t)}(l,e);var t,n,r,o=IC(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),o.call(this,(function(e){return e}))}return t=l,(n=[{key:"insert",value:function(e,t){var n=this;this.indexedValues=NC(this.indexedValues,e,t,(function(e,t){return n.getNextValue(t)})),MC(jC(l.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=LC(this.indexedValues,e),MC(jC(l.prototype),"remove",this).call(this,e)}},{key:"getNextValue",value:function(e){return Math.max.apply(Math,TC(this.getValues()))+1+e}}])&&xC(t.prototype,n),r&&xC(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ic)]]),$C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UC(e,t)}(l,e);var t,n,r,o=zC(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).headerIndexes=null,t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return KC}},{key:"PLUGIN_PRIORITY",get:function(){return 210}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof t&&(t="loose");var n=XC.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",(function(t){return e.onModifyRowHeader(t)})),FC(YC(l.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),FC(YC(l.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}},{key:"destroy",value:function(){FC(YC(l.prototype),"destroy",this).call(this)}}])&&VC(t.prototype,n),r&&VC(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function qC(e){return qC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qC(e)}function QC(e){return function(e){if(Array.isArray(e))return JC(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return JC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JC(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JC(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ZC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tS(){return tS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=nS(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},tS.apply(this,arguments)}function nS(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=lS(object)););return object}function rS(e,p){return rS=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},rS(e,p)}function oS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lS(e);if(t){var o=lS(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iS(this,n)}}function iS(e,t){if(t&&("object"===qC(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return aS(e)}function aS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lS(e){return lS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lS(e)}function sS(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function uS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cS(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,fS(e,t,"get"))}function hS(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,fS(e,t,"set"),n),n}function fS(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var dS="collapsibleColumns",pS=["nestedHeaders"],yS=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),gS=new WeakMap,vS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rS(e,t)}(l,e);var t,n,r,o=oS(l);function l(){var e;ZC(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return uS(aS(e=o.call.apply(o,[this].concat(n))),"nestedHeadersPlugin",null),uS(aS(e),"eventManager",new Hr(aS(e))),uS(aS(e),"headerStateManager",null),sS(aS(e),gS,{writable:!0,value:null}),e}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[dS]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.hot.getSettings().nestedHeaders||er("You need to configure the Nested Headers plugin in order to use collapsible headers."),hS(this,gS,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("afterGetColHeader",(function(col,t){return e.onAfterGetColHeader(col,t)})),this.addHook("beforeOnCellMouseDown",(function(t,n,r){return e.onBeforeOnCellMouseDown(t,n,r)})),tS(lS(l.prototype),"enablePlugin",this).call(this),this.updatePlugin())}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var e=this.hot.getSettings().collapsibleColumns;"boolean"==typeof e?this.headerStateManager.mapState((function(e){return{collapsible:e.origColspan>1}})):Array.isArray(e)&&(this.headerStateManager.mapState((function(){return{collapsible:!1}})),this.headerStateManager.mergeStateWith(e))}tS(lS(l.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),hS(this,gS,null),this.nestedHeadersPlugin=null,this.clearButtons(),tS(lS(l.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(button){button&&button.parentNode.removeChild(button)};no(0,e-1,(function(i){var e=t.childNodes[i],l=n.childNodes[i],c=r?r.childNodes[i]:null;no(0,e.childNodes.length-1,(function(t){var button=e.childNodes[t].querySelector(".collapsibleIndicator");o(button),l&&l.childNodes[t]&&(button=l.childNodes[t].querySelector(".collapsibleIndicator"),o(button)),r&&c&&c.childNodes[t]&&(button=c.childNodes[t].querySelector(".collapsibleIndicator"),o(button))}))}))}}},{key:"expandSection",value:function(e){this.toggleCollapsibleSection([e],"expand")}},{key:"collapseSection",value:function(e){this.toggleCollapsibleSection([e],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(e){var t=this,n=this.headerStateManager.mapNodes((function(n){var r=n.collapsible,o=n.origColspan,l=n.headerLevel,c=n.columnIndex,h=n.isCollapsed;if(!0===r&&o>1&&(h&&"expand"===e||!h&&"collapse"===e))return{row:t.headerStateManager.levelToRowCoords(l),col:c}}));this.toggleCollapsibleSection(n,e)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(e,t){var n=this;if(!yS.has(t))throw new Error("Unsupported action is passed (".concat(t,")."));if(Array.isArray(e)){var r=K(e,(function(e){return e.row<0})),o=r.length>0;$(r,(function(e){var r,l=e.row,c=e.col,h=null!==(r=n.headerStateManager.getHeaderSettings(l,c))&&void 0!==r?r:{},f=h.collapsible,d=h.isCollapsed;if(!f||d&&"collapse"===t||!d&&"expand"===t)return o=!1,!1}));var l=[],c=[];o&&$(r,(function(e){var r=e.row,o=e.col,h=n.headerStateManager.triggerNodeModification(t,r,o),f=h.colspanCompensation,d=h.affectedColumns,y=h.rollbackModification;f>0&&(c.push.apply(c,QC(d)),l.push(y))}));var h=this.getCollapsedColumns(),f=[];"collapse"===t?f=ne([].concat(QC(h),c)):"expand"===t&&(f=K(h,(function(e){return!c.includes(e)})));var d=yS.get(t);if(!1!==this.hot.runHooks(d.beforeHook,h,f,o)){this.hot.batchExecution((function(){$(c,(function(e){cS(n,gS).setValueAtIndex(n.hot.toPhysicalColumn(e),d.hideColumn)}))}),!0);var y=this.getCollapsedColumns().length!==h.length;this.hot.runHooks(d.afterHook,h,f,o,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else $(l,(function(e){e()}))}}},{key:"getCollapsedColumns",value:function(){return cS(this,gS).getHiddenIndexes()}},{key:"generateIndicator",value:function(e,t){var n=this.hot.rootDocument.createElement("div"),r=this.headerStateManager.getHeaderSettings(e,t);return Gt(n,"collapsibleIndicator"),r.isCollapsed?(Gt(n,"collapsed"),Jt(n,"+")):(Gt(n,"expanded"),Jt(n,"-")),n}},{key:"onAfterGetColHeader",value:function(e,t){var n,r=t.parentNode,o=r.parentNode,l=-1*o.childNodes.length+Array.prototype.indexOf.call(o.childNodes,r),c=null!==(n=this.headerStateManager.getHeaderSettings(l,e))&&void 0!==n?n:{},h=c.collapsible,f=c.origColspan;if(h&&f>1&&e>=this.hot.getSettings().fixedColumnsStart){var button=this.generateIndicator(l,e);t.querySelector("div:first-child").appendChild(button)}}},{key:"onBeforeOnCellMouseDown",value:function(e,t){zt(e.target,"collapsibleIndicator")&&(zt(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):zt(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),qn(e))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){hS(this,gS,null),tS(lS(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return dS}},{key:"PLUGIN_PRIORITY",get:function(){return 290}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[dS].concat(pS)}}],n&&eS(t.prototype,n),r&&eS(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function mS(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function bS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wS(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return CS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CS(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CS(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function SS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var kS=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],OS=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.sortingStates=new Ph,this.sortEmptyCells=false,this.indicator=true,this.headerAction=true,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}var t,n,r;return t=e,n=[{key:"updateAllColumnsProperties",value:function(e){var t=this;ve(e)&&be(e,(function(e,n){kS.includes(n)&&(t[n]=e)}))}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getSortOrderOfColumn",value:function(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((function(t){return wS(t,1)[0]===e}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(e){return ve(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}},{key:"getSortStates",value:function(){var e=this;return null===this.sortingStates?[]:this.sortingStates.getEntries().map((function(t){var n=wS(t,2),r=n[0],o=n[1];return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?mS(Object(source),!0).forEach((function(t){bS(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):mS(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({column:e.hot.toVisualColumn(r)},o)}))}},{key:"getColumnSortState",value:function(e){var t=this.getSortOrderOfColumn(e);if(it(t))return{column:e,sortOrder:t}}},{key:"setSortStates",value:function(e){this.sortingStates.clear();for(var i=0;i<e.length;i+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[i].column),{sortOrder:e[i].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}],n&&SS(t.prototype,n),r&&SS(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),RS="asc",ES="desc";function TS(e){if(e.some((function(e){return!1===function(e){if(!1===ve(e))return!1;var t=e.column,n=e.sortOrder;return Number.isInteger(t)&&[RS,ES].includes(n)}(e)})))return!1;var t=e.map((function(e){return e.column}));return new Set(t).size===t.length}function AS(e){if(e!==ES)return e===RS?ES:RS}function xS(e){return e.querySelector(".".concat("colHeader"))}function MS(e,t){if(e<0||!t.parentNode)return!1;var n=t.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(t.parentNode)-n.length}function PS(e,t,n){return-1===e&&t>=0&&!1===Jn(n)}var _S="indicatorDisabled",IS="columnSorting",HS="sortAction",jS=new Map([[RS,"ascending"],[ES,"descending"]]);function DS(e,t,n,r){var o=[IS];if(r&&o.push(HS),!1===n)return o.push(_S),o;var l=e.getSortOrderOfColumn(t);return it(l)&&o.push(jS.get(l)),o}function NS(){return Array.from(jS.values()).concat(HS,_S,IS)}function LS(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function BS(e,t,n){return t&&LS(e.prototype,t),n&&LS(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var FS=BS((function e(data){VS(this,e),this.data=data,this.next=null,this.prev=null})),WS=function(){function e(){VS(this,e),this.first=null,this.last=null}return BS(e,[{key:"push",value:function(data){var e=new FS(data);if(null===this.first)this.first=e,this.last=e;else{var t=this.last;this.last=e,e.prev=t,t.next=e}}},{key:"unshift",value:function(data){var e=new FS(data);if(null===this.first)this.first=e,this.last=e;else{var t=this.first;this.first=e,e.next=t,t.prev=e}}},{key:"inorder",value:function(e){for(var t=this.first;t;)e(t),t=t.next}},{key:"remove",value:function(data){if(null===this.first)return!1;for(var e,t,n=this.first;n;){if(n.data===data)return e=n.next,t=n.prev,e&&(e.prev=t),t&&(t.next=e),n===this.first&&(this.first=e),n===this.last&&(this.last=t),!0;n=n.next}return!1}},{key:"hasCycle",value:function(){for(var e=this.first,t=this.first;;){if(null===e)return!1;if(null===(e=e.next))return!1;if((e=e.next)===(t=t.next))return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var e=this.last;return this.last=this.last.prev,e}},{key:"shift",value:function(){if(null===this.first)return null;var e=this.first;return this.first=this.first.next,e}},{key:"recursiveReverse",value:function(){if(this.first){!function e(t,n){n&&(e(n,n.next),n.next=t)}(this.first,this.first.next),this.first.next=null;var e=this.first;this.first=this.last,this.last=e}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var e,t=this.first.next,n=this.first;t;)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}}}]),e}(),US=function(a,b){var e=a.toString(),t=b.toString();return e===t?0:e<t?-1:1};function zS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:US,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(Math.abs(r-n)<=1)return[];var o=Math.ceil((n+r)/2);return zS(e,t,n,o),zS(e,t,o,r),GS(e,t,n,o,r)}function GS(e,t,n,r,o){for(var l=new WS,c=new WS,h=r-n,f=o-r,d=Math.max(h,f),y=o-n,v=0;v<d;v+=1)v<h&&l.push(e[n+v]),v<f&&c.push(e[r+v]);for(var i=0;i<y;)l.first&&c.first?t(l.first.data,c.first.data)>0?e[n+i]=c.shift().data:e[n+i]=l.shift().data:l.first?e[n+i]=l.shift().data:e[n+i]=c.shift().data,i+=1;return e}var YS=-1;function KS(e,t,n){var r=t.locale;return function(t,o){var l=n.sortEmptyCells;return"string"==typeof t&&(t=t.toLocaleLowerCase(r)),"string"==typeof o&&(o=o.toLocaleLowerCase(r)),t===o?0:lt(t)?lt(o)?0:l&&"asc"===e?YS:1:lt(o)?l&&"asc"===e?1:YS:isNaN(t)&&!isNaN(o)?"asc"===e?1:YS:!isNaN(t)&&isNaN(o)?"asc"===e?YS:1:(isNaN(t)||isNaN(o)||(t=parseFloat(t),o=parseFloat(o)),t<o?"asc"===e?YS:1:t>o?"asc"===e?1:YS:0)}}var XS="default";var $S=vr("sorting.compareFunctionFactory"),qS=$S.register,QS=$S.getItem,JS=$S.hasItem,ZS=vr("sorting.mainSortComparator"),ek=ZS.register,tk=ZS.getItem;function nk(e){return JS(e)?QS(e):QS(XS)}function rk(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ok(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ok(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ok(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ik(e){return ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ik(e)}qS("numeric",(function(e,t,n){return function(t,r){var o=parseFloat(t),l=parseFloat(r),c=n.sortEmptyCells;if(o===l||isNaN(o)&&isNaN(l))return 0;if(c){if(lt(t))return"asc"===e?YS:1;if(lt(r))return"asc"===e?1:YS}return isNaN(o)?1:isNaN(l)?YS:o<l?"asc"===e?YS:1:o>l?"asc"===e?1:YS:0}})),qS("checkbox",(function(e,t,n){var r=t.checkedTemplate,o=t.uncheckedTemplate,l=n.sortEmptyCells;return function(c,h){var f=lt(c),d=lt(h),y=f?o:c,v=d?o:h,m=y===o||y===r,w=v===o||v===r;if(!1===l){if(f&&!1===d)return 1;if(!1===f&&d)return YS}return!1===m&&w?"asc"===e?YS:1:m&&!1===w?"asc"===e?1:YS:!1===m&&!1===w?KS(e,t,n)(c,h):y===o&&v===r?"asc"===e?YS:1:y===r&&v===o?"asc"===e?1:YS:0}})),qS("date",(function(e,t,n){return function(r,o){var l=n.sortEmptyCells;if(r===o)return 0;if(lt(r))return lt(o)?0:l&&"asc"===e?YS:1;if(lt(o))return l&&"asc"===e?1:YS;var c=t.dateFormat,h=Ze(r,c),f=Ze(o,c);return h.isValid()?f.isValid()?f.isAfter(h)?"asc"===e?YS:1:f.isBefore(h)?"asc"===e?1:YS:0:YS:1}})),qS(XS,KS);var ak=["column"],lk=["column"];function sk(e){return function(e){if(Array.isArray(e))return uk(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return uk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uk(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uk(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ck(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function hk(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ck(Object(source),!0).forEach((function(t){fk(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ck(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function fk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dk(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function pk(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yk(){return yk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=gk(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},yk.apply(this,arguments)}function gk(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=wk(object)););return object}function vk(e,p){return vk=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},vk(e,p)}function mk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wk(e);if(t){var o=wk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bk(this,n)}}function bk(e,t){if(t&&("object"===ik(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wk(e){return wk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wk(e)}var Ck="columnSorting",Sk="append",kk="replace";ek(Ck,(function(e,t){return function(n,r){var o,l,c,h,f,d,y=rk(n).slice(1),v=rk(r).slice(1);return l=e[o=0],c=t[o],h=y[o],f=v[o],((d=c.columnSorting).compareFunctionFactory?d.compareFunctionFactory:nk(c.type))(l,c,d)(h,f)}})),dr.getSingleton().register("beforeColumnSort"),dr.getSingleton().register("afterColumnSort");var Ok=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vk(e,t)}(l,e);var t,n,r,o=mk(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).columnStatesManager=null,t.columnMetaCache=null,t.pluginKey=Ck,t.indexesSequenceCache=null,t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnStatesManager=new OS(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new uh((function(t){var n=e.hot.toVisualColumn(t);return null===n&&(n=t),e.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(t,n){return e.onAfterGetColHeader(t,n)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(t,n){return e.onAfterOnCellMouseDown(t,n)})),this.addHook("afterInit",(function(){return e.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.hot.view&&this.loadOrSortBySettings(),yk(wk(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this,t=function(t,n){var r=xS(n);!1!==MS(t,n)&&null!==r&&e.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((function(){null!==e.indexesSequenceCache&&(e.hot.rowIndexMapper.setIndexesSequence(e.indexesSequenceCache.getValues()),e.hot.rowIndexMapper.unregisterMap(e.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,yk(wk(l.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){var t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Xc),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(e){return it(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(e){var t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}},{key:"areValidSortConfigs",value:function(e){var t=this.hot.countCols();return TS(e)&&e.every((function(e){var n=e.column;return n<=t&&n>=0}))}},{key:"saveAllSortSettings",value:function(e){var t=this,n=this.columnStatesManager.getAllColumnsProperties();n.initialConfig=X(e,(function(e){var n=e.column,r=dk(e,ak);return hk({column:t.hot.toPhysicalColumn(n)},r)})),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var e=this,t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var n=t.value;return it(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=X(n.initialConfig,(function(t){var n=t.column,r=dk(t,lk);return hk({column:e.hot.toVisualColumn(n)},r)}))),n}},{key:"getColumnNextConfig",value:function(e){var t=this.columnStatesManager.getSortOrderOfColumn(e);if(it(t)){var n=AS(t);return it(n)?{column:e,sortOrder:n}:void 0}var r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:AS()}}},{key:"getNextSortConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sk,n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,o=this.getSortConfig(),l=this.getColumnNextConfig(e);if(r){if(at(l))return[].concat(sk(o.slice(0,n)),sk(o.slice(n+1)));if(t===Sk)return[].concat(sk(o.slice(0,n)),sk(o.slice(n+1)),[l]);if(t===kk)return[].concat(sk(o.slice(0,n)),[l],sk(o.slice(n+1)))}return it(l)?o.concat(l):o}},{key:"getPluginColumnConfig",value:function(e){if(ve(e)){var t=e[this.pluginKey];if(ve(t))return t}return{}}},{key:"getMergedPluginSettings",value:function(e){var t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns[e])):In(o.columns)?Object.assign(n,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(n,t)}},{key:"getFirstCellSettings",value:function(e){var t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}},{key:"getNumberOfRowsToSort",value:function(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}},{key:"sortByPresetSortStates",value:function(e){var t=this;if(0!==e.length){for(var n=[],r=this.hot.countRows(),o=function(n){return X(e,(function(e){return t.hot.getDataAtCell(n,e.column)}))},l=0;l<this.getNumberOfRowsToSort(r);l+=1)n.push([this.hot.toPhysicalRow(l)].concat(o(l)));var c=X(n,(function(e){return e[0]}));!function(e,t){for(var n=tk(t),r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];zS(e,n.apply(void 0,o))}(n,this.pluginKey,X(e,(function(e){return e.sortOrder})),X(e,(function(e){return t.getFirstCellSettings(e.column)})));for(var h=n.length;h<r;h+=1)n.push([h].concat(o(h)));var f=X(n,(function(e){return e[0]})),d=new Map(X(c,(function(e,t){return[e,f[t]]}))),y=X(this.hot.rowIndexMapper.getIndexesSequence(),(function(e){return d.has(e)?d.get(e):e}));this.hot.rowIndexMapper.setIndexesSequence(y)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var e=this.getAllSavedSortSettings();if(ve(e))this.sortBySettings(e);else{var t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}},{key:"sortBySettings",value:function(e){if(ve(e)){this.columnStatesManager.updateAllColumnsProperties(e);var t=e.initialConfig;(Array.isArray(t)||ve(t))&&this.sort(t)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(e,t){var n=xS(t);if(!1!==MS(e,t)&&null!==n){var r=this.getFirstCellSettings(e)[this.pluginKey],o=r.indicator,l=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,o,l)}}},{key:"updateHeaderClasses",value:function(e){if(Yt(e,NS()),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Gt(e,DS.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(e){yk(wk(l.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),it(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}},{key:"onAfterLoadData",value:function(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&"SPAN"===e.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){!1!==PS(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==PS(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}},{key:"destroy",value:function(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),yk(wk(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return Ck}},{key:"PLUGIN_PRIORITY",get:function(){return 50}}],n&&pk(t.prototype,n),r&&pk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);n(897);function Rk(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ek,Tk=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}var t,n,r;return t=e,n=[{key:"getEndpoint",value:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var t=this,n=[],r=e;if(r||"function"!=typeof this.settings)return r||(r=this.settings),$(r,(function(e){var r={};t.assignSetting(e,r,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,r,"reversedRowCoords",!1),t.assignSetting(e,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,r,"sourceColumn",e.destinationColumn),t.assignSetting(e,r,"type","sum"),t.assignSetting(e,r,"forceNumeric",!1),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"customFunction",null),t.assignSetting(e,r,"readOnly",!0),t.assignSetting(e,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(e,t,n){if("function"===this.settingsType){var r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();$(o,(function(o){"row"===r&&o.destinationRow>=t&&("insert_row"===e?o.alterRowOffset=n:"remove_row"===e&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=t&&("insert_col"===e?o.alterColumnOffset=n:"remove_col"===e&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,t,n,r,source){var o=this,l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var c=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,f=this.getAllEndpoints(),d=0===e.indexOf("move_row"),y=t;$(f,(function(e){"row"===c&&e.destinationRow>=y&&(e.alterRowOffset=h*n),"col"===c&&e.destinationColumn>=y&&(e.alterColumnOffset=h*n)})),this.resetAllEndpoints(f,!d),$(f,d?function(e){o.extendEndpointRanges(e,y,r[0],r.length),o.recreatePhysicalRanges(e),o.clearOffsetInformation(e)}:function(e){o.shiftEndpointCoordinates(e,y)}),l&&this.refreshAllEndpoints()}else{var v=function e(){return o.hot.removeHook("beforeViewRender",e),o.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",v)}}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,t,n,r){$(e.ranges,(function(e){e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(e){var t=this,n=e.ranges,r=[],o=[];$(n,(function(e){var n=[];if(e[1])for(var i=e[0];i<=e[1];i++)n.push(t.hot.toPhysicalRow(i));else n.push(t.hot.toPhysicalRow(e[0]));o.push(n)})),$(o,(function(e){var t=[];$(e,(function(n,o){0===o?t.push(n):e[o]!==e[o-1]+1&&(t.push(e[o-1]),r.push(t),(t=[]).push(n)),o===e.length-1&&(t.push(n),r.push(t))}))})),e.ranges=r}},{key:"shiftEndpointCoordinates",value:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,$(e.ranges,(function(element){$(element,(function(n,r){n>=t&&(element[r]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.some((function(t){var n=t.alterRowOffset||0,r=t.alterColumnOffset||0;return t.destinationRow+n>=e.hot.countRows()||t.destinationColumn+r>=e.hot.countCols()}));r||(this.cellsToSetCache=[],$(t,(function(t){e.resetEndpointValue(t,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],$(this.getAllEndpoints(),(function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var t=this,n=[];this.cellsToSetCache=[],$(e,(function(e,r,o){"".concat(e[2]||"")!=="".concat(e[3])&&$(t.getAllEndpoints(),(function(e,l){t.hot.propToCol(o[r][1])===e.sourceColumn&&-1===n.indexOf(l)&&n.push(l)}))})),$(n,(function(e){t.refreshEndpoint(t.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.alterRowOffset||0,r=e.alterColumnOffset||0,o=[this.hot.toVisualRow(e.destinationRow),this.hot.toVisualColumn(e.destinationColumn)],l=o[0],c=o[1];if(null!==c&&null!==l){var h=this.hot.getCellMeta(l,c);h.readOnly=!1,h.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}},{key:"setEndpointValue",value:function(e,source){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=-1*e.alterRowOffset||0,r=-1*e.alterColumnOffset||0,o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var l=this.hot.toVisualRow(e.destinationRow+n);if(null!==l){var c=this.hot.getCellMeta(l,e.destinationColumn+r);"init"!==source&&c.readOnly===e.readOnly||(c.readOnly=e.readOnly,c.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),t?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){er("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}],n&&Rk(t.prototype,n),r&&Rk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ak=Tk;function xk(e){return xk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xk(e)}function Mk(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pk(){return Pk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=_k(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Pk.apply(this,arguments)}function _k(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Dk(object)););return object}function Ik(e,p){return Ik=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Ik(e,p)}function Hk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dk(e);if(t){var o=Dk(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jk(this,n)}}function jk(e,t){if(t&&("object"===xk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Dk(e){return Dk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dk(e)}var Nk="columnSummary",Lk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ik(e,t)}(l,e);var t,n,r,o=Hk(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).endpoints=null,t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new Ak(this,this.settings),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(t,n,source){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,source)})),this.addHook("beforeCreateCol",(function(t,n,source){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,source)})),this.addHook("beforeRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterCreateRow",(function(t,n,source){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,source)})),this.addHook("afterCreateCol",(function(t,n,source){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,source)})),this.addHook("afterRemoveRow",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return e.onAfterRowMove.apply(e,arguments)})),Pk(Dk(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}},{key:"calculateSum",value:function(e){var t=this,n=0;return be(e.ranges,(function(r){n+=t.getPartialSum(r,e.sourceColumn)})),n}},{key:"getPartialSum",value:function(e,col){var t=0,i=e[1]||e[0],n=null,r=0;do{n=this.getCellValue(i,col)||0;var o=("".concat(n).split(".")[1]||[]).length||1;o>r&&(r=o),t+=n||0,i-=1}while(i>=e[0]);return Math.round(t*Math.pow(10,r))/Math.pow(10,r)}},{key:"calculateMinMax",value:function(e,t){var n=this,r=null;return be(e.ranges,(function(o){var l=n.getPartialMinMax(o,e.sourceColumn,t);if(null===r&&null!==l&&(r=l),null!==l)switch(t){case"min":r=Math.min(r,l);break;case"max":r=Math.max(r,l)}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(e,col,t){var n,r=null,i=e[1]||e[0];do{if(n=this.getCellValue(i,col)||null,null===r)r=n;else if(null!==n)switch(t){case"min":r=Math.min(r,n);break;case"max":r=Math.max(r,n)}i-=1}while(i>=e[0]);return r}},{key:"countEmpty",value:function(e,col){var t=0,i=e[1]||e[0];do{this.getCellValue(i,col)||(t+=1),i-=1}while(i>=e[0]);return t}},{key:"countEntries",value:function(e){var t=this,n=0;return be(e.ranges,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,l=t.countEmpty(r,e.sourceColumn);n+=o,n-=l})),n}},{key:"calculateAverage",value:function(e){return this.calculateSum(e)/this.countEntries(e)}},{key:"getCellValue",value:function(e,col){var t=this.hot.toVisualRow(e),n=this.hot.toVisualColumn(col),r=this.hot.getSourceDataAtCell(e,col),o="";if(null!==t&&null!==n&&(o=this.hot.getCellMeta(t,n).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof r&&(r=r.replace(/,/,".")),r=parseFloat(r)),isNaN(r)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(et(Ek||(Ek=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),e,col));return r}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(e,source){e&&"ColumnSummary.reset"!==source&&"ColumnSummary.set"!==source&&"loadData"!==source&&this.endpoints.refreshChangedEndpoints(e)}},{key:"onAfterRowMove",value:function(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}],r=[{key:"PLUGIN_KEY",get:function(){return Nk}},{key:"PLUGIN_PRIORITY",get:function(){return 220}}],n&&Mk(t.prototype,n),r&&Mk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function Bk(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Vk=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootDocument=t,this.isRtl=n,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}var t,n,r;return t=e,n=[{key:"setPosition",value:function(e,t){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(t,"px")}},{key:"setSize",value:function(e,t){if(e&&t){var input=this.getInputElement();input.style.width="".concat(e,"px"),input.style.height="".concat(t,"px")}}},{key:"getSize",value:function(){return{width:hn(this.editor),height:fn(this.editor)}}},{key:"resetSize",value:function(){var input=this.getInputElement();input.style.width="",input.style.height=""}},{key:"setReadOnlyState",value:function(e){this.getInputElement().readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Gt(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Gt(t,e.CLASS_EDITOR),Gt(n,e.CLASS_INPUT),t.appendChild(n),this.container.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}],r=[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}],n&&Bk(t.prototype,n),r&&Bk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Fk=Vk,Wk="---------";function Uk(e){return zt(e,"htSeparator")}function zk(e){return zt(e,"htDisabled")}function Gk(e){return zt(e,"htSelectionDisabled")}function Yk(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function Kk(e,t){var n={};return $(e,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&(n[e]||(n[e]=[]),n[e][col]=t(e,col))}))})),n}function Xk(e,t,n,r,o){$(e,(function(e){e.forAll((function(e,col){e>=0&&col>=0&&function(e,col,t,n,r,o){var l=r(e,col),c=n;l.className&&(c="vertical"===t?function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(t)}(l.className,n):function(e,t){if(-1!==e.indexOf(t))return e;var n=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(t)}(l.className,n));o(e,col,"className",c)}(e,col,t,n,r,o)}))}))}function $k(e,t){var n=!1;return Array.isArray(e)&&$(e,(function(e){return e.forAll((function(e,col){if(e>=0&&col>=0&&t(e,col))return n=!0,!1})),n})),n}function qk(label){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(label)}function Qk(e,t){for(var n=e.slice(0);0<n.length&&n[0].name===t;)n.shift();return n}function Jk(e,t){var n=e.slice(0);return n.reverse(),(n=Qk(n,t)).reverse(),n}function Zk(e){var t=[];return $(e,(function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}function eO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var tO=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}var t,n,r;return t=e,n=[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===e.wasLastActionShow&&e.runLocalHooks("hide")}),250)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Dn((function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)}),t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}],n&&eO(t.prototype,n),r&&eO(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(tO,Mc);var nO=tO;function rO(e){return rO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rO(e)}function oO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function aO(){return aO="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=lO(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},aO.apply(this,arguments)}function lO(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=fO(object)););return object}function sO(e,p){return sO=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},sO(e,p)}function uO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fO(e);if(t){var o=fO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cO(this,n)}}function cO(e,t){if(t&&("object"===rO(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hO(e)}function hO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fO(e){return fO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fO(e)}var dO="comments",pO=new WeakMap,yO="comment",gO="value",vO="style",mO="readOnly",bO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sO(e,t)}(l,e);var t,n,r,o=uO(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).editor=null,t.displaySwitch=null,t.eventManager=null,t.range={},t.preventEditorAutoSwitch=!1,pO.set(hO(t),{tempEditorDimensions:{},cellBelowCursor:null}),t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.editor||(this.editor=new Fk(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Hr(this)),this.displaySwitch||(this.displaySwitch=new nO(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addToContextMenu(t)})),this.addHook("afterRenderer",(function(t,n,col,r,o,l){return e.onAfterRenderer(t,l)})),this.addHook("afterScrollHorizontally",(function(){return e.hide()})),this.addHook("afterScrollVertically",(function(){return e.hide()})),this.addHook("afterBeginEditing",(function(){return e.hide()})),this.displaySwitch.addLocalHook("hide",(function(){return e.hide()})),this.displaySwitch.addLocalHook("show",(function(t,col){return e.showAtCell(t,col)})),this.registerListeners(),aO(fO(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),aO(fO(l.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){aO(fO(l.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this,t=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(t,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return e.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(t){return e.onEditorMouseDown(t)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(t){return e.onEditorMouseUp(t)}))}},{key:"setRange",value:function(e){this.range=e}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(e){var t=Dt(e.target,"TD","TBODY");return!!(t&&zt(t,"htCommentCell")&&Dt(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(e){return this.editor.getInputElement()===e.target}},{key:"setComment",value:function(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue(),n="";null!=e?n=e:null!=t&&(n=t);var r=this.range.from.row,col=this.range.from.col;this.updateCommentMeta(r,col,oO({},gO,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}},{key:"removeComment",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,yO),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}},{key:"getComment",value:function(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,gO)}},{key:"getCommentAtCell",value:function(e,t){return this.getCommentMeta(e,t,gO)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.range.from,t=e.row,col=e.col;if(t<0||t>this.hot.countSourceRows()-1||col<0||col>this.hot.countSourceCols()-1)return!1;var meta=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(meta.comment?meta.comment.value:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n||this.range.from&&this.editor.isVisible()){var r=this.hot,o=r.rowIndexMapper,l=r.columnIndexMapper,c=this.range.from,h=c.row,f=c.col,d=o.getRenderableFromVisualIndex(h),y=l.getRenderableFromVisualIndex(f),v=null===d;null===d&&(d=o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(h,-1))),null===y&&(y=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(f,-1)));var m=null===d,w=null===y;d=null!==(e=d)&&void 0!==e?e:0,y=null!==(t=y)&&void 0!==t?t:0;var C=this.hot,S=C.rootWindow,k=C.view._wt,O=k.wtTable,R=k.wtOverlays,E=k.wtViewport,T=R.scrollableElement,A=O.getCell({row:d,col:y}),x=en(A),M=w?0:O.getStretchedColumnWidth(y),P=v&&!m?fn(A):0,_=x.top,I=x.left;E.hasVerticalScroll()&&T!==S&&(_-=R.topOverlay.getScrollPosition()),E.hasHorizontalScroll()&&T!==S&&(I-=R.inlineStartOverlay.getScrollPosition()*(this.hot.isRtl()?-1:1));var H=_+P,j=I;this.hot.isRtl()?j-=this.editor.getSize().width:j+=M;var D=this.getCommentMeta(h,f,vO),N=this.getCommentMeta(h,f,mO);D?this.editor.setSize(D.width,D.height):this.editor.resetSize(),this.editor.setReadOnlyState(N),this.editor.setPosition(j,H)}}},{key:"checkSelectionCommentsConsistency",value:function(){var e=this.hot.getSelectedRangeLast();if(!e)return!1;var t=!1,n=e.getTopStartCorner();return this.getCommentMeta(n.row,n.col,gO)&&(t=!0),t}},{key:"updateCommentMeta",value:function(e,t,n){var r,o=this.hot.getCellMeta(e,t).comment;o?fe(r=de(o),n):r=n,this.hot.setCellMeta(e,t,yO,r)}},{key:"getCommentMeta",value:function(e,t,n){var r=this.hot.getCellMeta(e,t);if(r.comment)return r.comment[n]}},{key:"onMouseDown",value:function(e){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){var t=Dt(e.target,"TD","TBODY"),n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}},{key:"onMouseOver",value:function(e){var t=pO.get(this),n=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||zt(e.target,"wtBorder")||t.cellBelowCursor===e.target)&&this.editor)if(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){var r=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(r)}else Lt(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(e,t){t.comment&&t.comment.value&&Gt(e,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(e){pO.get(this).tempEditorDimensions={width:hn(e.target),height:fn(e.target)}}},{key:"onEditorMouseUp",value:function(e){var t=pO.get(this),n=hn(e.target),r=fn(e.target);n===t.tempEditorDimensions.width+1&&r===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,oO({},vO,{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll((function(t,n){t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll((function(t,n){if(t>=0&&n>=0){var r=!!e.getCommentMeta(t,n,mO);e.updateCommentMeta(t,n,oO({},mO,!r))}}))}},{key:"addToContextMenu",value:function(e){var t=this,n=function(){return t.hot.rowIndexMapper.getRenderableIndexesLength()>0&&t.hot.columnIndexMapper.getRenderableIndexesLength()>0};e.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(Kf):t.hot.getTranslatedPhrase(Yf)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(Xf)},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var e=this,label=this.getTranslatedPhrase($f);return $k(this.getSelectedRangeLast(),(function(t,col){var n=e.getCellMeta(t,col).comment;if(n&&(n=n.readOnly),n)return!0}))&&(label=qk(label)),label},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return!n()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner()&&t.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var e=this.hot.getSettings().comments;if(ve(e))return e.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),aO(fO(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return dO}},{key:"PLUGIN_PRIORITY",get:function(){return 60}}],n&&iO(t.prototype,n),r&&iO(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function wO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var CO=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.commands={},this.commonCallback=null}var t,n,r;return t=e,n=[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var l=e.split(":"),c=l[0],h=2===l.length?l[1]:null,f=this.commands[c];if(!f)throw new Error("Menu command '".concat(c,"' not exists."));if(h&&f.submenu&&(f=SO(h,f.submenu.items)),!0!==f.disabled&&("function"!=typeof f.disabled||!0!==f.disabled.call(this.hot))&&!Oe(f,"submenu")){var d=[];"function"==typeof f.callback&&d.push(f.callback),"function"==typeof this.commonCallback&&d.push(this.commonCallback),r.unshift(l.join(":")),$(d,(function(e){return e.apply(t.hot,r)}))}}}],n&&wO(t.prototype,n),r&&wO(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function SO(e,t){var n;return $(t,(function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1})),n}var kO=CO,OO="alignment";var RO="clear_column";var EO="col_left";var TO="col_right";var AO="make_read_only";var xO="redo";function MO(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return PO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PO(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var _O="remove_col";function IO(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return HO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HO(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HO(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var jO="remove_row";var DO="row_above";var NO="row_below";var LO="no_items";var BO,VO="undo";function FO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var WO=[DO,NO,EO,TO,RO,jO,_O,VO,xO,AO,OO,Wk,LO],UO=(FO(BO={},Wk,(function(){return{name:Wk}})),FO(BO,LO,(function(){return{key:LO,name:function(){return this.getTranslatedPhrase(xf)},disabled:!0,isCommand:!1}})),FO(BO,DO,(function(){return{key:DO,name:function(){return this.getTranslatedPhrase(Mf)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;n||(r=t[Math.max(t.length-1,0)].start.row);this.alter("insert_row",r,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){return!Yk(this)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),FO(BO,NO,(function(){return{key:NO,name:function(){return this.getTranslatedPhrase(Pf)},callback:function(e,t){var n=this.selection.isSelectedByCorner(),r=0;if(n)r=this.countRows();else{var o,l=t[Math.max(t.length-1,0)],c=null==l||null===(o=l.end)||void 0===o?void 0:o.row;r=it(c)?c+1:0}this.alter("insert_row",r,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){return!Yk(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),FO(BO,EO,(function(){return{key:EO,name:function(){return this.getTranslatedPhrase(_f)},callback:function(){var e=this.selection.isSelectedByCorner(),t=this.isRtl()?this.countCols():0;if(!e){var n=this.getSelectedRangeLast();if(it(n)){var col=n.getTopLeftCorner().col;t=this.isRtl()?col+1:col}}this.alter("insert_col",t,1,"ContextMenu.columnLeft"),e&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!Yk(this)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}})),FO(BO,TO,(function(){return{key:TO,name:function(){return this.getTranslatedPhrase(If)},callback:function(){var e=this.selection.isSelectedByCorner(),t=this.isRtl()?0:this.countCols();if(!e){var n=this.getSelectedRangeLast();if(it(n)){var col=n.getTopRightCorner().col;t=this.isRtl()?col:col+1}}this.alter("insert_col",t,1,"ContextMenu.columnRight"),e&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!Yk(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}})),FO(BO,RO,(function(){return{key:RO,name:function(){return this.getTranslatedPhrase(Bf)},callback:function(e,t){var n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){return!Yk(this)||!this.selection.isSelectedByColumnHeader()}}})),FO(BO,jO,(function(){return{key:jO,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=IO(e[0],3);n[0]-n[2]!=0&&(t=1)}return this.getTranslatedPhrase(Hf,t)},callback:function(){this.alter("remove_row",function(e){var t=$y(e);if(0===t||1===t)return[];var n=qy(t),r=new Set;return $(e,(function(e){var t=Fy(n(e),3),o=t[0],l=t[2],c=Math.max(o,0),h=l-c+1;$(Array.from(new Array(h),(function(e,i){return c+i})),(function(e){r.has(e)||r.add(e)}))})),Y(Array.from(r).sort((function(a,b){return a-b})),(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){if(!Yk(this))return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveRow}}})),FO(BO,_O,(function(){return{key:_O,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var n=MO(e[0],4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(jf,t)},callback:function(){this.alter("remove_col",function(e){var t=$y(e);if(0===t||1===t)return[];var n=qy(t),r=new Set;return $(e,(function(e){var t=Fy(n(e),4),o=t[1],l=t[3],c=Math.max(o,0),h=l-c+1;$(Array.from(new Array(h),(function(e,i){return c+i})),(function(e){r.has(e)||r.add(e)}))})),Y(Array.from(r).sort((function(a,b){return a-b})),(function(e,t,n,r){return 0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;if(!Yk(this))return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveColumn}}})),FO(BO,VO,(function(){return{key:VO,name:function(){return this.getTranslatedPhrase(Df)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}})),FO(BO,xO,(function(){return{key:xO,name:function(){return this.getTranslatedPhrase(Nf)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}})),FO(BO,AO,(function(){return{key:AO,name:function(){var e=this,label=this.getTranslatedPhrase(Lf);return $k(this.getSelectedRange(),(function(t,col){return e.getCellMeta(t,col).readOnly}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=$k(t,(function(t,col){return e.getCellMeta(t,col).readOnly}));$(t,(function(t){t.forAll((function(t,col){t>=0&&col>=0&&e.setCellMeta(t,col,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}})),FO(BO,OO,(function(){return{key:OO,name:function(){return this.getTranslatedPhrase(qf)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(OO,":left"),name:function(){var e=this,label=this.getTranslatedPhrase(Qf);return $k(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htLeft"))return!0}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Kk(t,(function(t,col){return e.getCellMeta(t,col).className})),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,t,r,o),Xk(t,r,o,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(OO,":center"),name:function(){var e=this,label=this.getTranslatedPhrase(Jf);return $k(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htCenter"))return!0}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Kk(t,(function(t,col){return e.getCellMeta(t,col).className})),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,t,r,o),Xk(t,r,o,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(OO,":right"),name:function(){var e=this,label=this.getTranslatedPhrase(Zf);return $k(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htRight"))return!0}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Kk(t,(function(t,col){return e.getCellMeta(t,col).className})),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,t,r,o),Xk(t,r,o,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(OO,":justify"),name:function(){var e=this,label=this.getTranslatedPhrase(ed);return $k(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htJustify"))return!0}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Kk(t,(function(t,col){return e.getCellMeta(t,col).className})),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,t,r,o),Xk(t,r,o,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{name:Wk},{key:"".concat(OO,":top"),name:function(){var e=this,label=this.getTranslatedPhrase(nd);return $k(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htTop"))return!0}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Kk(t,(function(t,col){return e.getCellMeta(t,col).className})),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,t,r,o),Xk(t,r,o,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(OO,":middle"),name:function(){var e=this,label=this.getTranslatedPhrase(rd);return $k(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htMiddle"))return!0}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Kk(t,(function(t,col){return e.getCellMeta(t,col).className})),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,t,r,o),Xk(t,r,o,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1},{key:"".concat(OO,":bottom"),name:function(){var e=this,label=this.getTranslatedPhrase(od);return $k(this.getSelectedRange(),(function(t,col){var n=e.getCellMeta(t,col).className;if(n&&-1!==n.indexOf("htBottom"))return!0}))&&(label=qk(label)),label},callback:function(){var e=this,t=this.getSelectedRange(),n=Kk(t,(function(t,col){return e.getCellMeta(t,col).className})),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,t,r,o),Xk(t,r,o,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),this.render()},disabled:!1}]}}})),BO);function zO(){var e={};return be(UO,(function(t,n){e[n]=t()})),e}function GO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var KO=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;GO(this,e),this.hot=t,this.predefinedItems=zO(),this.defaultOrderPattern=n}var t,n,r;return t=e,n=[{key:"setPredefinedItems",value:function(e){var t=this,n={};this.defaultOrderPattern.length=0,be(e,(function(e,r){var o="";e.name===Wk?(n[Wk]=e,o=Wk):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,n[r]=e,o=e.key):(n[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var pattern=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return XO(pattern,this.defaultOrderPattern,this.predefinedItems)}}],n&&YO(t.prototype,n),r&&YO(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function XO(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],pattern=e;return pattern&&pattern.items?pattern=pattern.items:Array.isArray(pattern)||(pattern=t),ve(pattern)?be(pattern,(function(e,t){var o=n["string"==typeof e?e:t];o||(o=e),ve(e)?he(o,e):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),r.push(o)})):$(pattern,(function(e,t){var o=n[e];!o&&WO.indexOf(e)>=0||(o||(o={name:e,key:"".concat(t)}),ve(e)&&he(o,e),void 0===o.key&&(o.key=t),r.push(o))})),r}var $O=KO;function qO(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var QO=function(){function e(object,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n,r,o,l,c,h,f=tn(t),d=nn(t);this.rootWindow=t,this.type=this.getSourceType(object),"literal"===this.type?(n=parseInt(object.top,10),o=parseInt(object.left,10),c=object.height||0,h=object.width||0,r=n,l=o,n+=f,o+=d):"event"===this.type&&(n=parseInt(object.pageY,10),o=parseInt(object.pageX,10),c=object.target.clientHeight,h=object.target.clientWidth,r=n-f,l=o-d),this.top=n,this.topRelative=r,this.left=o,this.leftRelative=l,this.scrollTop=f,this.scrollLeft=d,this.cellHeight=c,this.cellWidth=h}var t,n,r;return t=e,n=[{key:"getSourceType",value:function(object){var e="literal";return object instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(element){return this.topRelative>=element.offsetHeight}},{key:"fitsBelow",value:function(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+element.offsetHeight<=e}},{key:"fitsOnRight",value:function(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+element.offsetWidth<=e}},{key:"fitsOnLeft",value:function(element){return this.leftRelative>=element.offsetWidth}}],n&&qO(t.prototype,n),r&&qO(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),JO=QO;function ZO(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function eR(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ZO(Object(source),!0).forEach((function(t){tR(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ZO(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function tR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var rR="menu",oR=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new Hr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var t,n,r;return t=e,n=[{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"mousedown",(function(t){return e.onDocumentMouseDown(t)})),this.eventManager.addEventListener(t.document,"contextmenu",(function(t){return e.onDocumentContextMenu(t)})),t=Ht(t)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(area){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[area]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var t=Dn((function(t){return e.openSubMenu(t)}),300),n=this.options.minWidth||215,r=!1,o=K(this.menuItems,(function(t){return t.key===LO&&(r=!0),function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}(t,e.hot)}));if(o.length<1&&!r)o.push(zO().no_items);else if(0===o.length)return;o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wk,n=e.slice(0);return Zk(n=Jk(n=Qk(n,t),t))}(o,Wk);var l=!1,c={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(e){return it(e)&&e<n?n:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(t,n,r,col,o,l){return e.menuItemRenderer(t,n,r,col,o,l)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(n,r){e.isAllSubMenusClosed()?t(r.row):e.openSubMenu(r.row)},rowHeights:function(e){return o[e].name===Wk?1:23},afterOnCellContextMenu:function(t){t.preventDefault(),Ue()&&l&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(t){e.hasSelectedItem()&&(l=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(t))},afterOnCellMouseUp:function(t){Ue()&&Jn(t)||!l||!e.hasSelectedItem()||(Ve()||We()?setTimeout((function(){return e.close(!0)}),325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new sv(this.container,c),this.hotMenu.addHook("afterInit",(function(){return e.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection.apply(e,arguments)})),this.hotMenu.init(),this.hotMenu.listen();var h=this.hotMenu.getShortcutManager(),f=h.addContext("menu"),d=eR(eR({},{group:rR}),{},{runOnlyIf:function(t){return!1===xn(t.target)||!1===e.container.contains(t.target)}});h.setActiveContextName("menu"),f.addShortcuts([{keys:[["Escape"]],callback:function(){e.keyEvent=!0,e.close(),e.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectNextCell(t[0],t[1]):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.selectPrevCell(t[0],t[1]):e.selectLastCell(),e.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var t=e.hotMenu.getSelectedLast();if(e.keyEvent=!0,t){var menu=e.openSubMenu(t[0]);menu&&menu.selectFirstCell()}e.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t&&e.isSubMenu()&&(e.close(),e.parentMenu&&e.parentMenu.hotMenu.listen()),e.keyEvent=!1}},{keys:[["Enter"]],callback:function(t){var n=e.hotMenu.getSelectedLast();e.keyEvent=!0,e.hotMenu.getSourceDataAtRow(n[0]).submenu||(e.executeCommand(t),e.close(!0)),e.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(-e.hotMenu.countVisibleRows(),0):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var t=e.hotMenu.getSelectedLast();e.keyEvent=!0,t?e.hotMenu.selection.transformStart(e.hotMenu.countVisibleRows(),0):e.selectLastCell(),e.keyEvent=!1}}],d),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!n||!function(e){return zt(e,"htSubmenu")}(n))return!1;var r=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;$(this.hotMenu.getData(),(function(t,n){return e.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hasSelectedItem()){var t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),!this.isCommandPassive(t)){var n=this.hot.getSelectedRange(),r=n?function(e){return X(e,(function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}}))}(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}}}},{key:"isCommandPassive",value:function(e){var t=e.isCommand,n=e.name,r=e.disabled,o=e.submenu,l=!0===r||"function"==typeof r&&!0===r.call(this.hot);return!1===t||n===Wk||!0===l||o}},{key:"setPosition",value:function(e){var cursor=new JO(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(cursor.fitsBelow(this.container)?this.setPositionBelowCursor(cursor):cursor.fitsAbove(this.container)?this.setPositionAboveCursor(cursor):this.setPositionBelowCursor(cursor),this.hot.isLtr()?this.setHorizontalPositionForLtr(cursor):this.setHorizontalPositionForRtl(cursor)):(this.setPositionBelowCursor(cursor),this.setPositionOnRightOfCursor(cursor))}},{key:"setHorizontalPositionForRtl",value:function(cursor){cursor.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(cursor):this.setPositionOnRightOfCursor(cursor)}},{key:"setHorizontalPositionForLtr",value:function(cursor){cursor.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(cursor):this.setPositionOnLeftOfCursor(cursor)}},{key:"setPositionAboveCursor",value:function(cursor){var e=this.offset.above+cursor.top-this.container.offsetHeight;this.isSubMenu()&&(e=cursor.top+cursor.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(cursor){var e=this.offset.below+cursor.top+1;this.isSubMenu()&&(e=cursor.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(cursor){var e=cursor.left;if(this.isSubMenu()){var t=this.parentMenu.container.getBoundingClientRect().right;e+=cursor.cellWidth+t-(cursor.left+cursor.cellWidth)}else e+=this.offset.right;this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(cursor){var e=this.offset.left+cursor.left-this.container.offsetWidth;if(this.isSubMenu()){var t=this.parentMenu.container.getBoundingClientRect().left;e-=cursor.left-t}this.container.style.left="".concat(e,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);Uk(e)||zk(e)||Gk(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);Uk(t)||zk(t)||Gk(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}},{key:"selectNextCell",value:function(e,col){var t=e+1,n=t<this.hotMenu.countRows()?this.hotMenu.getCell(t,col):null;n&&(Uk(n)||zk(n)||Gk(n)?this.selectNextCell(t,col):this.hotMenu.selectCell(t,col))}},{key:"selectPrevCell",value:function(e,col){var t=e-1,n=t>=0?this.hotMenu.getCell(t,col):null;n&&(Uk(n)||zk(n)||Gk(n)?this.selectPrevCell(t,col):this.hotMenu.selectCell(t,col))}},{key:"menuItemRenderer",value:function(e,t,n,col,r,o){var l,c=this,h=e.getSourceDataAtRow(n),f=this.hot.rootDocument.createElement("div"),d=function(e){return e.disableSelection},y=o;"function"==typeof y&&(y=y.call(this.hot)),Xt(t),Gt(f,"htItemWrapper"),t.appendChild(f),l=h,new RegExp(Wk,"i").test(l.name)?Gt(t,"htSeparator"):"function"==typeof h.renderer?(Gt(t,"htCustomMenuRenderer"),t.appendChild(h.renderer(e,f,n,col,r,y))):Qt(f,y),function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(c.hot)}(h)?(Gt(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):d(h)?(Gt(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):function(e){return Oe(e,"submenu")}(h)?(Gt(t,"htSubmenu"),d(h)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,col,void 0,void 0,!1,!1)}))):(Yt(t,["htSubmenu","htDisabled"]),d(h)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(n,col,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=t;return r&&(In(r)&&(r=null===(r=r.call(this.hot))||at(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),e=n.querySelector(".".concat(this.options.className,".").concat(r))),e||(Gt(e=n.createElement("div"),"htMenu ".concat(this.options.className)),r&&Gt(e,r),this.options.container.appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view._wt.wtTable,data=this.hotMenu.getSettings().data,t=e.hider.style,n=e.holder.style,r=parseInt(t.width,10),o=Y(data,(function(e,t){return e+(t.name===Wk?1:26)}),0);n.width="".concat(r+3,"px"),n.height="".concat(o+3,"px"),t.height=n.height}},{key:"onAfterSelection",value:function(e,t,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Lt(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Lt(e.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&zt(e.target,"htCore")&&Lt(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}],n&&nR(t.prototype,n),r&&nR(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(oR,Mc);var iR=oR;function aR(e){return aR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aR(e)}function lR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sR(){return sR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=uR(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},sR.apply(this,arguments)}function uR(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=pR(object)););return object}function cR(e,p){return cR=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},cR(e,p)}function hR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pR(e);if(t){var o=pR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fR(this,n)}}function fR(e,t){if(t&&("object"===aR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return dR(e)}function dR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pR(e){return pR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pR(e)}var yR="contextMenu";dr.getSingleton().register("afterContextMenuDefaultOptions"),dr.getSingleton().register("beforeContextMenuShow"),dr.getSingleton().register("afterContextMenuShow"),dr.getSingleton().register("afterContextMenuHide"),dr.getSingleton().register("afterContextMenuExecute");var gR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cR(e,t)}(l,e);var t,n,r,o=hR(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).eventManager=new Hr(dR(t)),t.commandExecutor=new kO(t.hot),t.itemsFactory=null,t.menu=null,t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().contextMenu;"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new iR(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),this.addHook("afterOnCellContextMenu",(function(t){return e.onAfterOnCellContextMenu(t)})),sR(pR(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sR(pR(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),sR(pR(l.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(e){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect(),o=r.top,l=r.left;t=o-tn(e.view),n=l-nn(e.view)}else t=-1*tn(this.menu.hotMenu.rootWindow),n=-1*nn(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(e){var t;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"prepareMenuItems",value:function(){var e=this;this.itemsFactory=new $O(this.hot,l.DEFAULT_ITEMS);var t=this.hot.getSettings().contextMenu,n={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);var r=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),$(r,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}},{key:"onAfterOnCellContextMenu",value:function(e){var t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders,element=e.target;this.close(),zt(element,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),(n||r||function(element){return"TD"===element.nodeName||"TD"===element.parentNode.nodeName}(element)||zt(element,"current")&&zt(element,"wtBorder"))&&this.open(e))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),sR(pR(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return yR}},{key:"PLUGIN_PRIORITY",get:function(){return 70}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[DO,NO,Wk,EO,TO,Wk,jO,_O,Wk,VO,xO,Wk,AO,Wk,OO]}}],n&&lR(t.prototype,n),r&&lR(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function vR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}gR.SEPARATOR={name:Wk};var mR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={}}var t,n,r;return t=e,(n=[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}])&&vR(t.prototype,n),r&&vR(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function bR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wR(e,t,n){return t&&bR(e.prototype,t),n&&bR(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var CR=wR((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clipboardData=new mR}));function SR(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var kR=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Hr(this),this.listenersCount=new WeakSet,this.container=t}var t,n,r;return t=e,(n=[{key:"useSecondaryElement",value:function(){var e=function(e){var t=TR.get(e);if(t)return t.parentElement||e.appendChild(t),t;var element=(e.defaultView?e:e.ownerDocument).createElement("textarea");return TR.set(e,element),element.setAttribute("data-hot-input",""),element.className="HandsontableCopyPaste",element.tabIndex=-1,element.autocomplete="off",element.wrap="hard",element.value=" ",e.appendChild(element),element}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),ER(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(element){this.listenersCount.has(element)||(this.listenersCount.add(element),ER(this.eventManager,element,this)),this.mainElement=element}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Ve()||Pn(this.mainElement)}}])&&SR(t.prototype,n),r&&SR(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(kR,Mc);var OR=new WeakMap;var RR=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function ER(e,element,t){e.addEventListener(element,"copy",RR("copy",t)),e.addEventListener(element,"cut",RR("cut",t)),e.addEventListener(element,"paste",RR("paste",t))}var TR=new WeakMap;function AR(e){if(e instanceof kR){var t=OR.get(e.container);if((t=isNaN(t)?0:t)>0&&(t-=1),function(e){e.eventManager.clear()}(e),t<=0){t=0;var n=TR.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),TR.delete(e.container)),e.mainElement=null}OR.set(e.container,t)}}function xR(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return MR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MR(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MR(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function PR(e){return PR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PR(e)}function _R(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function IR(){return IR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=HR(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},IR.apply(this,arguments)}function HR(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=BR(object)););return object}function jR(e,p){return jR=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},jR(e,p)}function DR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=BR(e);if(t){var o=BR(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NR(this,n)}}function NR(e,t){if(t&&("object"===PR(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return LR(e)}function LR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BR(e){return BR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},BR(e)}dr.getSingleton().register("afterCopyLimit"),dr.getSingleton().register("modifyCopyableRange"),dr.getSingleton().register("beforeCut"),dr.getSingleton().register("afterCut"),dr.getSingleton().register("beforePaste"),dr.getSingleton().register("afterPaste"),dr.getSingleton().register("beforeCopy"),dr.getSingleton().register("afterCopy");var VR="copyPaste",FR=["fragmentSelection"],WR=new WeakMap,UR=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),zR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jR(e,t)}(l,e);var t,n,r,o=DR(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).columnsLimit=Infinity,t.copyableRanges=[],t.focusableElement=void 0,t.pasteMode="overwrite",t.rowsLimit=Infinity,t.uiContainer=t.hot.rootDocument.body,WR.set(LR(t),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[VR]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t,n,r,o=this.hot.getSettings(),c=o[VR],h=o.fragmentSelection;WR.get(this).isFragmentSelectionEnabled=!!h,"object"===PR(c)&&(this.pasteMode=c.pasteMode||this.pasteMode,this.rowsLimit=isNaN(c.rowsLimit)?this.rowsLimit:c.rowsLimit,this.columnsLimit=isNaN(c.columnsLimit)?this.columnsLimit:c.columnsLimit,this.uiContainer=c.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=(t=this.uiContainer,n=new kR(t),r=OR.get(t),r=isNaN(r)?0:r,OR.set(t,r+1),n),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),IR(BR(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),IR(BR(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&AR(this.focusableElement),IR(BR(l.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){WR.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){WR.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){var t=this,n=[],r=[],o=[];return $(e,(function(e){no(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),no(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),$(r,(function(e){var r=[];$(o,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),Hg(n)}},{key:"getRangedData",value:function(e){var t=this,n=[],r=[],o=[];return $(e,(function(e){no(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),no(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),$(r,(function(e){var r=[];$(o,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new CR;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){var t=e.getTopStartCorner(),n=e.getBottomEndCorner(),r=t.row,o=t.col,l=n.row,c=n.col,h=Math.min(l,r+this.rowsLimit-1),f=Math.min(c,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:h,endCol:f}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),l===h&&c===f||this.hot.runHooks("afterCopyLimit",l-r+1,c-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var e=this.hot.getActiveEditor(),t=e?e.TEXTAREA:void 0;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){for(var n=e.length,r=e[0].length,o=[],l=t.getTopStartCorner(),c=l.row,h=l.col,f=t.getBottomEndCorner(),d=f.row,y=f.col,v=c,m=h,w=c,C=h;o.length<n||v<=d;){var S=this.hot.getCellMeta(v,h),k=S.skipRowOnPaste,O=S.visualRow;if(v=O+1,!0!==k){w=O,m=h;for(var R=[],E=o.length%n;R.length<r||m<=y;){var T=this.hot.getCellMeta(c,m),A=T.skipColumnOnPaste,x=T.visualCol;if(m=x+1,!0!==A){C=x;var M=R.length%r;R.push(e[E][M])}}o.push(R)}}return this.hot.populateFromArray(c,h,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,h,w,C]}}},{key:"onCopy",value:function(e){var t=WR.get(this);if((this.hot.isListening()||t.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var r=Hg(n);if(e&&e.clipboardData){var o=$r(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[UR,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",n,this.copyableRanges)}e.preventDefault()}}},{key:"onCut",value:function(e){var t=WR.get(this);if((this.hot.isListening()||t.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var r=Hg(n);if(e&&e.clipboardData){var o=$r(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[UR,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&void 0!==e.clipboardData){var n=xt(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});t=n&&/(<table)|(<TABLE)/g.test(n)?qr(n,this.hot.rootDocument).data:e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=function(e){var t=[[""]];if(0===e.length)return t;for(var n,r=0,o=0;e.length>0&&n!==e.length;)if(n=e.length,e.match(Ig))e=e.replace(Ig,""),r+=1,t[o][r]="";else if(e.match(Pg))e=e.replace(Pg,""),r=0,t[o+=1]=[""];else{var l="";if(e.startsWith('"')){for(var c=0,h=!0;h;){var f=e.slice(0,1);'"'===f&&(c+=1),l+=f,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&c%2==0)&&(h=!1)}l=l.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var d=e.match(_g);l=d?d[0]:"",e=e.slice(l.length)}t[o][r]=l}return t}(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var r=xR(this.populateValues(t),4),o=r[0],l=r[1],c=r[2],h=r[3];this.hot.selectCell(o,l,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name:function(){return this.getTranslatedPhrase(Vf)},callback:function(){t.copy()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}),function(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(Ff)},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var e=WR.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),e&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&bn()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(AR(this.focusableElement),this.focusableElement=null),IR(BR(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return VR}},{key:"SETTING_KEYS",get:function(){return[VR].concat(FR)}},{key:"PLUGIN_PRIORITY",get:function(){return 80}}],n&&_R(t.prototype,n),r&&_R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function GR(e,col){return"border_row".concat(e,"col").concat(col)}function YR(e){var t,n;(it(e.start)||it(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(it(e.end)||it(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function KR(e){return it(e.start)&&(e.left=e.start),it(e.end)&&(e.right=e.end),e}function XR(e,col){return{id:GR(e,col),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:col,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function $R(e,t){var n=!1;return $(e.getSelectedRange(),(function(r){r.forAll((function(r,o){if(!(r<0||o<0)){var l=e.getCellMeta(r,o).borders;if(l){if(!t)return n=!0,!1;if(!Oe(l[t],"hide")||!1===l[t].hide)return n=!0,!1}}}))})),n}function qR(label){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(label)}var QR=new Map([["left","start"],["right","end"]]);function JR(e){var t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var label=this.getTranslatedPhrase(ld);return $R(this,t)&&(label=qR(label)),label},callback:function(n,r){var o=$R(this,t);e.prepareBorder(r,t,o)}}}function ZR(e){return{key:"borders:bottom",name:function(){var label=this.getTranslatedPhrase(sd);return $R(this,"bottom")&&(label=qR(label)),label},callback:function(t,n){var r=$R(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function eE(e){var t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var label=this.getTranslatedPhrase(ud);return $R(this,t)&&(label=qR(label)),label},callback:function(n,r){var o=$R(this,t);e.prepareBorder(r,t,o)}}}function tE(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(cd)},callback:function(t,n){e.prepareBorder(n,"noBorders")},disabled:function(){return!$R(this)}}}function nE(e){return nE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nE(e)}function rE(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return oE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oE(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oE(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function iE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lE(){return lE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=sE(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},lE.apply(this,arguments)}function sE(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=dE(object)););return object}function uE(e,p){return uE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},uE(e,p)}function cE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dE(e);if(t){var o=dE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hE(this,n)}}function hE(e,t){if(t&&("object"===nE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fE(e)}function fE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dE(e){return dE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dE(e)}function pE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yE="customBorders",gE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uE(e,t)}(l,e);var t,n,r,o=cE(l);function l(){var e;iE(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return pE(fE(e=o.call.apply(o,[this].concat(n))),"savedBorders",[]),e}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return yE}},{key:"PLUGIN_PRIORITY",get:function(){return 90}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("init",(function(){return e.onAfterInit()})),lE(dE(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),lE(dE(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),lE(dE(l.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(e,t){var n=this,r=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),o=YR(t));var l=qy($y(e));$(e,(function(e){for(var t=rE(l(e),4),c=t[0],h=t[1],f=t[2],d=t[3],y=function(e){for(var t=function(col){$(r,(function(t){var r,l;n.prepareBorderFromCustomAdded(e,col,o,(r=t,null!==(l=QR.get(r))&&void 0!==l?l:r))}))},col=h;col<=d;col+=1)t(col)},v=c;v<=f;v+=1)y(v)})),this.hot.view.render()}},{key:"getBorders",value:function(e){var t=this;if(!Array.isArray(e))return this.savedBorders;var n=qy($y(e)),r=[];return $(e,(function(e){for(var o=rE(n(e),4),l=o[0],c=o[1],h=o[2],f=o[3],d=function(e){for(var n=function(col){$(t.savedBorders,(function(t){t.row===e&&t.col===col&&r.push(KR(t))}))},col=c;col<=f;col+=1)n(col)},y=l;y<=h;y+=1)d(y)})),r}},{key:"clearBorders",value:function(e){var t=this;e?this.setBorders(e):($(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange(),t.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);var n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}},{key:"prepareBorderFromCustomAdded",value:function(e,t,n,r){var o=this.hot.countRows(),l=this.hot.countCols();if(!(e>=o||t>=l)){var c,h,f=XR(e,t);n&&(c=f,Oe(h=n,"border")&&h.border&&(c.border=h.border),Oe(h,"top")&&it(h.top)&&(h.top?(ve(h.top)||(h.top={width:1,color:"#000"}),c.top=h.top):(h.top={hide:!0},c.top=h.top)),Oe(h,"bottom")&&it(h.bottom)&&(h.bottom?(ve(h.bottom)||(h.bottom={width:1,color:"#000"}),c.bottom=h.bottom):(h.bottom={hide:!0},c.bottom=h.bottom)),Oe(h,"start")&&it(h.start)&&(h.start?(ve(h.start)||(h.start={width:1,color:"#000"}),c.start=h.start):(h.start={hide:!0},c.start=h.start)),Oe(h,"end")&&it(h.end)&&(h.end?(ve(h.end)||(h.end={width:1,color:"#000"}),c.end=h.end):(h.end={hide:!0},c.end=h.end)),f=c,$(this.hot.selection.highlight.customSelections,(function(e){if(f.id===e.settings.id)return Object.assign(e.settings,n),f.id=e.settings.id,f.top=e.settings.top,f.bottom=e.settings.bottom,f.start=e.settings.start,f.end=e.settings.end,!1}))),this.hot.setCellMeta(e,t,"borders",KR(f)),this.insertBorderIntoSettings(f,r)}}},{key:"prepareBorderFromCustomAddedRange",value:function(e,t){var n=this,r=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);no(e.from.row,r,(function(r){no(e.from.col,o,(function(o){var l=XR(r,o),c=0;r===e.from.row&&Oe(t,"top")&&(c+=1,l.top=t.top),r===e.to.row&&Oe(t,"bottom")&&(c+=1,l.bottom=t.bottom),o===e.from.col&&Oe(t,"start")&&(c+=1,l.start=t.start),o===e.to.col&&Oe(t,"end")&&(c+=1,l.end=t.end),c>0&&(n.hot.setCellMeta(r,o,"borders",KR(l)),n.insertBorderIntoSettings(l))}))}))}},{key:"removeAllBorders",value:function(e,t){var n=GR(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}},{key:"setBorder",value:function(e,t,n,r){var o=this.hot.getCellMeta(e,t).borders;o=o&&void 0!==o.border?YR(o):XR(e,t),r?(o[n]={hide:!0},4===this.countHide(o)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",KR(o)))):(o[n]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",KR(o)))}},{key:"prepareBorder",value:function(e,t,n){var r=this;$(e,(function(e){var o=e.start,l=e.end;if(o.row===l.row&&o.col===l.col)"noBorders"===t?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":no(o.col,l.col,(function(e){no(o.row,l.row,(function(t){r.removeAllBorders(t,e)}))}));break;case"top":no(o.col,l.col,(function(e){r.setBorder(o.row,e,t,n)}));break;case"bottom":no(o.col,l.col,(function(e){r.setBorder(l.row,e,t,n)}));break;case"start":no(o.row,l.row,(function(e){r.setBorder(e,o.col,t,n)}));break;case"end":no(o.row,l.row,(function(e){r.setBorder(e,l.col,t,n)}))}}))}},{key:"createCustomBorders",value:function(e){var t=this;$(e,(function(e){var n=YR(e);e.range?t.prepareBorderFromCustomAddedRange(e.range,n):t.prepareBorderFromCustomAdded(e.row,e.col,n)}))}},{key:"countHide",value:function(e){return Y([e.top,e.bottom,e.start,e.end],(function(e,t){var n=e;return t&&t.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(e){var t=X(this.hot.selection.highlight.customSelections,(function(e){return e.settings.id})).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}},{key:"clearNullCellRange",value:function(){var e=this;$(this.hot.selection.highlight.customSelections,(function(t,n){if(null===t.cellRange)return e.hot.selection.highlight.customSelections[n].destroy(),e.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var e=this;$(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange()}))}},{key:"spliceBorder",value:function(e){var t=X(this.savedBorders,(function(e){return e.id})).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}},{key:"checkSavedBorders",value:function(e){var t=this,n=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),n=!0):$(this.savedBorders,(function(r,o){if(e.id===r.id)return t.savedBorders[o]=e,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(e,t,n){var r=!1;return $(this.hot.selection.highlight.customSelections,(function(o){if(e.id===o.settings.id)return be(o.instanceBorders,(function(e){e.toggleHiddenClass(t,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(e,t,n){var r=this.countHide(e),o=!1;return 4===r?(this.removeAllBorders(e.row,e.col),o=!0):$(this.hot.selection.highlight.customSelections,(function(r){if(e.id===r.settings.id)return r.visualCellRange=t,r.commit(),n&&be(r.instanceBorders,(function(t){t.changeBorderStyle(n,e)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var e=this.hot.getSettings().customBorders;if(Array.isArray(e)){var t=de(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(e){var t=e.some((function(e){return it(e.left)||it(e.right)})),n=function(e){return e.some((function(e){return it(e.start)||it(e.end)}))}(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;this.hot.getSettings().customBorders&&e.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(id)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(t=this,{key:"borders:top",name:function(){var label=this.getTranslatedPhrase(ad);return $R(this,"top")&&(label=qR(label)),label},callback:function(e,n){var r=$R(this,"top");t.prepareBorder(n,"top",r)}}),JR(this),ZR(this),eE(this),tE(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){lE(dE(l.prototype),"destroy",this).call(this)}}])&&aE(t.prototype,n),r&&aE(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function vE(e){return vE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vE(e)}function mE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bE(){return bE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=wE(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},bE.apply(this,arguments)}function wE(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=RE(object)););return object}function CE(e,p){return CE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},CE(e,p)}function SE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=RE(e);if(t){var o=RE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kE(this,n)}}function kE(e,t){if(t&&("object"===vE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return OE(e)}function OE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RE(e){return RE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},RE(e)}var EE="dragToScroll",TE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CE(e,t)}(l,e);var t,n,r,o=SE(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).eventManager=new Hr(OE(t)),t.boundaries=null,t.callback=null,t.listening=!1,t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return EE}},{key:"PLUGIN_PRIORITY",get:function(){return 100}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(t){return e.setupListening(t)})),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.setupListening(t)})),this.registerEvents(),bE(RE(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),bE(RE(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),bE(RE(l.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(e){this.boundaries=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"check",value:function(e,t){var n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"contextmenu",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mouseup",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mousemove",(function(t){return e.onMouseMove(t)})),t=Ht(t)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(e){if(!Jn(e)){var t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(e){this.isListening()&&this.check(e.clientX,e.clientY)}},{key:"destroy",value:function(){bE(RE(l.prototype),"destroy",this).call(this)}}])&&mE(t.prototype,n),r&&mE(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function AE(e){return AE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AE(e)}function xE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ME(){return ME="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=PE(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},ME.apply(this,arguments)}function PE(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=DE(object)););return object}function _E(e,p){return _E=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},_E(e,p)}function IE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=DE(e);if(t){var o=DE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HE(this,n)}}function HE(e,t){if(t&&("object"===AE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jE(e)}function jE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DE(e){return DE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},DE(e)}dr.getSingleton().register("afterDropdownMenuDefaultOptions"),dr.getSingleton().register("beforeDropdownMenuShow"),dr.getSingleton().register("afterDropdownMenuShow"),dr.getSingleton().register("afterDropdownMenuHide"),dr.getSingleton().register("afterDropdownMenuExecute");var NE="dropdownMenu",LE="changeType",BE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_E(e,t)}(l,e);var t,n,r,o=IE(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).eventManager=new Hr(jE(t)),t.commandExecutor=new kO(t.hot),t.itemsFactory=null,t.menu=null,t.hot.addHook("afterGetColHeader",(function(col,e){return t.onAfterGetColHeader(col,e)})),t}return t=l,n=[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new $O(this.hot,l.DEFAULT_ITEMS);var t=this.hot.getSettings().dropdownMenu,n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),ME(DE(l.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",n),e.itemsFactory.setPredefinedItems(n.items);var r=e.itemsFactory.getItems(t);e.menu&&e.menu.destroy(),e.menu=new iR(e.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||e.hot.rootDocument.body}),e.hot.runHooks("beforeDropdownMenuSetItems",r),e.menu.setMenuItems(r),e.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),e.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),e.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),e.menu.addLocalHook("executeCommand",(function(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(r))})),$(r,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ME(DE(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),ME(DE(l.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"open",value:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(r))}},{key:"setListening",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(e){if(e.stopPropagation(),zt(e.target,LE)&&!this.menu.isOpened()){var t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect();t=r.top,n=r.left}var rect=e.target.getBoundingClientRect();this.open({left:rect.left+n,top:rect.top+e.target.offsetHeight+3+t,width:rect.width,height:rect.height})}}},{key:"onAfterGetColHeader",value:function(col,e){var t=e.parentNode;if(t){var n=t.parentNode.childNodes,r=Array.prototype.indexOf.call(n,t);if(!(col<0||r!==n.length-1)){var o=e.querySelector(".".concat(LE));if(!this.enabled||!o)if(this.enabled){var button=this.hot.rootDocument.createElement("button");button.className=LE,button.onclick=function(){return!1},e.firstChild.insertBefore(button,e.firstChild.firstChild)}else o&&o.parentNode.removeChild(o)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),ME(DE(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return NE}},{key:"PLUGIN_PRIORITY",get:function(){return 230}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[EO,TO,Wk,_O,Wk,RO,Wk,AO,Wk,OO]}}],n&&xE(t.prototype,n),r&&xE(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function VE(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return FE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FE(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FE(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function WE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}BE.SEPARATOR={name:Wk};var UE=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.options={}}var t,n,r;return t=e,(n=[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),n=t.startRow,r=t.startCol,o=t.endRow,l=t.endCol,c=this.options,data=[];return no(n,o,(function(t){var n=[];!c.exportHiddenRows&&e._isHiddenRow(t)||(no(r,l,(function(r){!c.exportHiddenColumns&&e._isHiddenColumn(r)||n.push(e.hot.getDataAtCell(t,r))})),data.push(n))})),data}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,l=this.hot.getRowHeader();no(r,o,(function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(l[n])}))}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,l=this.hot.getColHeader();no(r,o,(function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(l[n])}))}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,n=VE(this.options.range,4),r=n[0],o=void 0===r?0:r,l=n[1],c=void 0===l?0:l,h=n[2],f=void 0===h?t:h,d=n[3],y=void 0===d?e:d;return{startRow:o=Math.max(o,0),startCol:c=Math.max(c,0),endRow:f=Math.min(f,t),endCol:y=Math.min(y,e)}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}])&&WE(t.prototype,n),r&&WE(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function zE(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var GE=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataProvider=t,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}var t,n,r;return t=e,r=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}],(n=[{key:"_mergeOptions",value:function(t){var n=pe(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=he(pe(e.DEFAULT_OPTIONS),n),(n=he(n,t)).filename=Tt(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}])&&zE(t.prototype,n),r&&zE(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),YE=GE;function KE(e){return KE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KE(e)}function XE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qE(e,p){return qE=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},qE(e,p)}function QE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ZE(e);if(t){var o=ZE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return JE(this,n)}}function JE(e,t){if(t&&("object"===KE(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ZE(e){return ZE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ZE(e)}var eT=String.fromCharCode(13),tT=String.fromCharCode(34),nT=String.fromCharCode(10),rT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qE(e,t)}(l,e);var t,n,r,o=QE(l);function l(){return XE(this,l),o.apply(this,arguments)}return t=l,n=[{key:"export",value:function(){var e=this,t=this.options,data=this.dataProvider.getData(),n=this.dataProvider.getColumnHeaders(),r=n.length>0,o=this.dataProvider.getRowHeaders(),l=o.length>0,c=t.bom?String.fromCharCode(65279):"";return r&&(n=X(n,(function(t){return e._escapeCell(t,!0)})),l&&(c+=t.columnDelimiter),c+=n.join(t.columnDelimiter),c+=t.rowDelimiter),$(data,(function(n,r){r>0&&(c+=t.rowDelimiter),l&&(c+=e._escapeCell(o[r])+t.columnDelimiter),c+=n.map((function(t){return e._escapeCell(t)})).join(t.columnDelimiter)})),c}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ot(e);return""!==n&&(t||n.indexOf(eT)>=0||n.indexOf(tT)>=0||n.indexOf(nT)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],r=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}],n&&$E(t.prototype,n),r&&$E(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(YE);var oT,iT,aT,lT=(aT=rT,(iT="csv")in(oT={})?Object.defineProperty(oT,iT,{value:aT,enumerable:!0,configurable:!0,writable:!0}):oT[iT]=aT,oT);function sT(e,t,n){return"function"==typeof lT[e]?new lT[e](t,n):null}function uT(e){return uT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uT(e)}function cT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fT(e,p){return fT=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},fT(e,p)}function dT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yT(e);if(t){var o=yT(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pT(this,n)}}function pT(e,t){if(t&&("object"===uT(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yT(e){return yT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yT(e)}var gT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fT(e,t)}(l,e);var t,n,r,o=dT(l);function l(){return cT(this,l),o.apply(this,arguments)}return t=l,n=[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}},{key:"exportAsBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,l=this._createTypeFormatter(e,t),c=this._createBlob(l),h=o.URL||o.webkitURL,a=r.createElement("a"),f="".concat(l.options.filename,".").concat(l.options.fileExtension);if(void 0!==a.download){var d=h.createObjectURL(c);a.style.display="none",a.setAttribute("href",d),a.setAttribute("download",f),r.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),r.body.removeChild(a),setTimeout((function(){h.revokeObjectURL(d)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,f)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!lT[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return sT(e,new UE(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}],r=[{key:"PLUGIN_KEY",get:function(){return"exportFile"}},{key:"PLUGIN_PRIORITY",get:function(){return 240}}],n&&hT(t.prototype,n),r&&hT(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function vT(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var mT=function(){function e(t,n){var r=n.id,o=n.stateless,l=void 0===o||o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.id=r,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=l?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ph)}var t,n,r;return t=e,(n=[{key:"reset",value:function(){$(this.elements,(function(e){return e.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(e){this.state&&this.setState(this.state.getValueAtIndex(e))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(e){this.state&&this.state.setValueAtIndex(e,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),$(this.elements,(function(e){return e.destroy()})),this.state=null,this.elements=null,this.hot=null}}])&&vT(t.prototype,n),r&&vT(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(mT,Mc);var bT=mT,wT={};function CT(e,t){if(!wT[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var n=wT[e],r=n.condition,o=n.descriptor,l=t;return o.inputValuesDecorator&&(l=o.inputValuesDecorator(l)),function(e){return r.apply(e.meta.instance,[].concat([e],[l]))}}function ST(e){if(!wT[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return wT[e].descriptor}function kT(e,t,n){n.key=e,wT[e]={condition:t,descriptor:n}}var OT="none";kT(OT,(function(){return!0}),{name:wd,inputsCount:0,showOperators:!1});var RT="empty";kT(RT,(function(e){return lt(e.value)}),{name:Cd,inputsCount:0,showOperators:!0});var ET="not_empty";function TT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return AT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT(ET,(function(e,t){return!CT(RT,t)(e)}),{name:Sd,inputsCount:0,showOperators:!0});var xT="eq";kT(xT,(function(e,t){var n=TT(t,1)[0];return ot(e.value).toLocaleLowerCase(e.meta.locale)===ot(n)}),{name:kd,inputsCount:1,showOperators:!0});var MT="neq";function PT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return _T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _T(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _T(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT(MT,(function(e,t){return!CT(xT,t)(e)}),{name:Od,inputsCount:1,showOperators:!0});function IT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return HT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function HT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT("gt",(function(e,t){var n=PT(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>n}),{name:Md,inputsCount:1,showOperators:!0});function jT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return DT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT("gte",(function(e,t){var n=IT(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>=n}),{name:Pd,inputsCount:1,showOperators:!0});function NT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return LT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT("lt",(function(e,t){var n=jT(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<n}),{name:_d,inputsCount:1,showOperators:!0});function BT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return VT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT("lte",(function(e,t){var n=NT(t,1)[0];return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<=n}),{name:Id,inputsCount:1,showOperators:!0});var FT="date_after";function WT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return UT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function UT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT(FT,(function(e,t){var n=BT(t,1)[0],r=Ze(e.value,e.meta.dateFormat),o=Ze(n,e.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)>=0}),{name:Dd,inputsCount:1,showOperators:!0});var zT="date_before";function GT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return YT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT(zT,(function(e,t){var n=WT(t,1)[0],r=Ze(e.value,e.meta.dateFormat),o=Ze(n,e.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)<=0}),{name:Nd,inputsCount:1,showOperators:!0});var KT="between";kT(KT,(function(e,t){var n=GT(t,2),r=n[0],o=n[1];if("numeric"===e.meta.type){var l=parseFloat(r,10),c=parseFloat(o,10);r=Math.min(l,c),o=Math.max(l,c)}else if("date"===e.meta.type){var h=CT(zT,[o]),f=CT(FT,[r]);return h(e)&&f(e)}return e.value>=r&&e.value<=o}),{name:Hd,inputsCount:2,showOperators:!0});var XT="not_between";function $T(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return qT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT(XT,(function(e,t){return!CT(KT,t)(e)}),{name:jd,inputsCount:2,showOperators:!0});var QT="begins_with";kT(QT,(function(e,t){var n=$T(t,1)[0];return ot(e.value).toLocaleLowerCase(e.meta.locale).startsWith(ot(n))}),{name:Rd,inputsCount:1,showOperators:!0});n(908);function JT(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return ZT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZT(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ZT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var eA="ends_with";function tA(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return nA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nA(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nA(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}kT(eA,(function(e,t){var n=JT(t,1)[0];return ot(e.value).toLocaleLowerCase(e.meta.locale).endsWith(ot(n))}),{name:Ed,inputsCount:1,showOperators:!0});var rA="contains";kT(rA,(function(e,t){var n=tA(t,1)[0];return ot(e.value).toLocaleLowerCase(e.meta.locale).indexOf(ot(n))>=0}),{name:Td,inputsCount:1,showOperators:!0});var oA="not_contains";kT(oA,(function(e,t){return!CT(rA,t)(e)}),{name:Ad,inputsCount:1,showOperators:!0});var iA="date_tomorrow";kT(iA,(function(e){var t=Ze(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ze().subtract(-1,"days").startOf("day"),"d")}),{name:Bd,inputsCount:0});var aA="date_today";kT(aA,(function(e){var t=Ze(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ze().startOf("day"),"d")}),{name:Ld,inputsCount:0});var lA,sA="date_yesterday";function uA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}kT(sA,(function(e){var t=Ze(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ze().subtract(1,"days").startOf("day"),"d")}),{name:Vd,inputsCount:0});var cA="text",hA=(uA(lA={},"numeric",[OT,Wk,RT,ET,Wk,xT,MT,Wk,"gt","gte","lt","lte",KT,XT]),uA(lA,cA,[OT,Wk,RT,ET,Wk,xT,MT,Wk,QT,eA,Wk,rA,oA]),uA(lA,"date",[OT,Wk,RT,ET,Wk,xT,MT,Wk,zT,FT,KT,Wk,iA,aA,sA]),lA);function fA(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var dA="built",pA="building",yA=["click","input","keydown","keypress","keyup","focus","blur","change"],gA=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.eventManager=new Hr(this),this.options=he(e.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}var t,n,r;return t=e,n=[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===pA?this._element:this.buildState===dA?(this.update(),this._element):(this.buildState=pA,this.build(),this.buildState=dA,this._element)}},{key:"isBuilt",value:function(){return this.buildState===dA}},{key:"translateIfPossible",value:function(e){return"string"==typeof e&&e.startsWith(md)?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,t=function(element,t){e.eventManager.addEventListener(element,t,(function(n){return e.runLocalHooks(t,n,e)}))};if(this.buildState||(this.buildState=pA),this.options.className&&Gt(this._element,this.options.className),this.options.children.length)$(this.options.children,(function(element){return e._element.appendChild(element.element)}));else if(this.options.wrapIt){var element=this.hot.rootDocument.createElement(this.options.tagName);be(this.options,(function(t,n){void 0!==element[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(element[n]=e.translateIfPossible(t))})),this._element.appendChild(element),$(yA,(function(e){return t(element,e)}))}else $(yA,(function(n){return t(e._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],r=[{key:"DEFAULTS",get:function(){return pe({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}],n&&fA(t.prototype,n),r&&fA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(gA,Mc);var vA=gA;function mA(e){return mA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mA(e)}function bA(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wA(){return wA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=CA(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},wA.apply(this,arguments)}function CA(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=EA(object)););return object}function SA(e,p){return SA=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},SA(e,p)}function kA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=EA(e);if(t){var o=EA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OA(this,n)}}function OA(e,t){if(t&&("object"===mA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return RA(e)}function RA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EA(e){return EA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},EA(e)}var TA=new WeakMap,AA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SA(e,t)}(l,e);var t,n,r,o=kA(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,e,he(l.DEFAULTS,t)),TA.set(RA(n),{}),n.registerHooks(),n}return t=l,r=[{key:"DEFAULTS",get:function(){return pe({placeholder:"",type:"text",tagName:"input"})}}],(n=[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()})),this.addLocalHook("keyup",(function(t){return e.onKeyup(t)}))}},{key:"build",value:function(){wA(EA(l.prototype),"build",this).call(this);var e=TA.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,Gt(this._element,"htUIInput"),Gt(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var input=TA.get(this).input;input.type=this.options.type,input.placeholder=this.translateIfPossible(this.options.placeholder),input.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&TA.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(e){this.options.value=e.target.value}}])&&bA(t.prototype,n),r&&bA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(vA);function xA(e){return xA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xA(e)}function MA(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function PA(){return PA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=_A(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},PA.apply(this,arguments)}function _A(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=NA(object)););return object}function IA(e,p){return IA=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},IA(e,p)}function HA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=NA(e);if(t){var o=NA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jA(this,n)}}function jA(e,t){if(t&&("object"===xA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return DA(e)}function DA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NA(e){return NA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},NA(e)}var LA=new WeakMap,BA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IA(e,t)}(l,e);var t,n,r,o=HA(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,e,he(l.DEFAULTS,t)),LA.set(DA(n),{}),n.menu=null,n.items=[],n.registerHooks(),n}return t=l,r=[{key:"DEFAULTS",get:function(){return pe({className:"htUISelect",wrapIt:!1})}}],(n=[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()}))}},{key:"setItems",value:function(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(e){var t=this;return $(e,(function(e){e.name=t.translateIfPossible(e.name)})),e}},{key:"build",value:function(){var e=this;PA(NA(l.prototype),"build",this).call(this),this.menu=new iR(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var caption=new vA(this.hot,{className:"htUISelectCaption"}),t=new vA(this.hot,{className:"htUISelectDropdown"}),n=LA.get(this);n.caption=caption,n.captionElement=caption.element,n.dropdown=t,$([caption,t],(function(element){return e._element.appendChild(element.element)})),this.menu.addLocalHook("select",(function(t){return e.onMenuSelect(t)})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuClosed()})),this.update()}},{key:"update",value:function(){var e;this.isBuilt()&&(e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(wd),LA.get(this).captionElement.textContent=e,PA(NA(l.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var rect=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?rect.left-5:rect.left-31,top:rect.top-1,width:rect.width,height:rect.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(e){e.name!==Wk&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var e=LA.get(this),caption=e.caption,t=e.dropdown;caption&&caption.destroy(),t&&t.destroy(),PA(NA(l.prototype),"destroy",this).call(this)}}])&&MA(t.prototype,n),r&&MA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(vA);function VA(e){return VA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VA(e)}function FA(e){return function(e){if(Array.isArray(e))return WA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return WA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WA(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function WA(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function UA(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zA(){return zA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=GA(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},zA.apply(this,arguments)}function GA(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=$A(object)););return object}function YA(e,p){return YA=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},YA(e,p)}function KA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$A(e);if(t){var o=$A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return XA(this,n)}}function XA(e,t){if(t&&("object"===VA(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $A(e){return $A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$A(e)}var qA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YA(e,t)}(l,e);var t,n,r,o=KA(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.addSeparator=t.addSeparator,n.elements.push(new BA(n.hot,{menuContainer:t.menuContainer})),n.elements.push(new AA(n.hot,{placeholder:Qd})),n.elements.push(new AA(n.hot,{placeholder:Jd})),n.registerHooks(),n}return t=l,n=[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",(function(t){return e.onConditionSelect(t)})),this.getSelectElement().addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),$(this.getInputElements(),(function(input){input.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}))}},{key:"setState",value:function(e){var t=this;if(this.reset(),e){var n=pe(e.command);n.name.startsWith(bd)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),$(e.args,(function(e,r){if(r>n.inputsCount-1)return!1;var element=t.getInputElement(r);element.setValue(e),element[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return element.focus()}),10)}))}}},{key:"getState",value:function(){var e=this.getSelectElement().getValue()||ST(OT),t=[];return $(this.getInputElements(),(function(element,n){e.inputsCount>n&&t.push(element.getValue())})),{command:e,args:t}}},{key:"updateState",value:function(e,t){var n=ST(e?e.name:OT);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||$(this.getInputElements(),(function(element){return element.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(element){return element instanceof BA}))[0]}},{key:"getInputElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter((function(element){return element instanceof AA}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,col,o,l){Gt(n.parentNode,"htFiltersMenuCondition"),e.addSeparator&&Gt(n.parentNode,"border");var label=e.hot.rootDocument.createElement("div");return Gt(label,"htFiltersMenuLabel"),label.textContent=l,n.appendChild(label),n.parentNode.hasAttribute("ghost-table")||$(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e,t=this.hot.getPlugin("filters").getSelectedColumn(),n=t&&t.visualIndex,r=function(e){var t=[],n=e;return hA[n]||(n=cA),$(hA[n],(function(e){var option;option=e===Wk?{name:Wk}:pe(ST(e)),t.push(option)})),t}((e=this.hot).getDataType.apply(e,FA(this.hot.getSelectedLast()||[0,n])));$(this.getInputElements(),(function(element){return element.hide()})),this.getSelectElement().setItems(r),zA($A(l.prototype),"reset",this).call(this),this.getSelectElement().setValue(r[0])}},{key:"onConditionSelect",value:function(e){$(this.getInputElements(),(function(element,t){element[e.inputsCount>t?"show":"hide"](),0===t&&setTimeout((function(){return element.focus()}),10)})),this.runLocalHooks("change",e)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(e){$n(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),qn(e)):$n(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),qn(e))}}],n&&UA(t.prototype,n),r&&UA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(bT),QA=qA,JA={};function ZA(e){if(!JA[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=JA[e].func;return function(e,n){return t(e,n)}}function ex(e,t,n){JA[e]={name:t,func:n}}var tx="conjunction";ex(tx,Ud,(function(e,t){return e.every((function(e){return e.func(t)}))}));var nx="disjunction";ex(nx,zd,(function(e,t){return e.some((function(e){return e.func(t)}))}));var rx="disjunctionWithExtraCondition";function ox(e){return ox="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ox(e)}function ix(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ax(){return ax="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=lx(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},ax.apply(this,arguments)}function lx(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=fx(object)););return object}function sx(e,p){return sx=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},sx(e,p)}function ux(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fx(e);if(t){var o=fx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cx(this,n)}}function cx(e,t){if(t&&("object"===ox(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hx(e)}function hx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fx(e){return fx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fx(e)}ex(rx,zd,(function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((function(e){return e.func(t)}))&&e[e.length-1].func(t)}));var dx,px=new WeakMap,yx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sx(e,t)}(l,e);var t,n,r,o=ux(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,e,he(l.DEFAULTS,t)),px.set(hx(n),{}),n}return t=l,n=[{key:"build",value:function(){ax(fx(l.prototype),"build",this).call(this);var e=px.get(this);e.input=this._element.firstChild;var label=this.hot.rootDocument.createElement("label");label.textContent=this.translateIfPossible(this.options.label.textContent),label.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=label,this._element.appendChild(label),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=px.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=e,this.update()}},{key:"focus",value:function(){this.isBuilt()&&px.get(this).input.focus()}}],r=[{key:"DEFAULTS",get:function(){return pe({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}],n&&ix(t.prototype,n),r&&ix(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(vA),gx=yx;function vx(e){return vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vx(e)}function mx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bx(e,p){return bx=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},bx(e,p)}function wx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sx(e);if(t){var o=Sx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cx(this,n)}}function Cx(e,t){if(t&&("object"===vx(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Sx(e){return Sx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sx(e)}var kx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bx(e,t)}(l,e);var t,n,r,o=wx(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.buildOperatorsElement(),n}return t=l,n=[{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Gt(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||$(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var e=this,t=[tx,nx];$(t,(function(n){var r,o=new gx(e.hot,{name:"operator",label:{htmlFor:n,textContent:(r=n,JA[r].name)},value:n,checked:n===t[0],id:n});o.addLocalHook("change",(function(t){return e.onRadioInputChange(t)})),e.elements.push(o)}))}},{key:"setChecked",value:function(e){if(this.elements.length<e)throw Error(et(dx||(dx=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Radio button with index "," doesn't exist."])),e));$(this.elements,(function(element,t){element.setChecked(t===e)}))}},{key:"getActiveOperationId",value:function(){var e=this.elements.find((function(element){return element instanceof gx&&element.isChecked()}));return e?e.getValue():tx}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&$(this.elements,(function(element){element.setChecked(element.getValue()===e)}))}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tx,t=arguments.length>1?arguments[1]:void 0,n=e;n===rx&&(n=nx),this.state.setValueAtIndex(t,n)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(e){this.setState(e.target.value)}}],n&&mx(t.prototype,n),r&&mx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(bT),Ox=kx;F();function Rx(e,t){var n=e;return""===n&&(n="(".concat(t,")")),n}var Ex=new Set([1]).has(1),Tx=Ex&&"function"==typeof Array.from;function Ax(e){var t=e;return Ex&&(t=new Set(t)),function(e){return Ex?t.has(e):!!~t.indexOf(e)}}function xx(e){return null==e?"":e}function Mx(e){var t=e;return t=(t=Tx?Array.from(new Set(t)):ne(t)).sort((function(a,b){return"number"==typeof a&&"number"==typeof b?a-b:a===b?0:a>b?1:-1}))}function Px(base,e,t,n){var r,o=[],l=base===e;return l||(r=Ax(e)),$(base,(function(e){var c=!1;(l||r(e))&&(c=!0);var h={checked:c,value:e,visualValue:Rx(e,t)};n&&n(h),o.push(h)})),o}n(909);function _x(e){return _x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_x(e)}function Ix(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hx(){return Hx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=jx(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Hx.apply(this,arguments)}function jx(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Vx(object)););return object}function Dx(e,p){return Dx=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Dx(e,p)}function Nx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vx(e);if(t){var o=Vx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lx(this,n)}}function Lx(e,t){if(t&&("object"===_x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Bx(e)}function Bx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vx(e){return Vx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vx(e)}var Fx=new WeakMap,Wx=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dx(e,t)}(l,e);var t,n,r,o=Nx(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,e,he(l.DEFAULTS,t)),Fx.set(Bx(n),{}),n}return t=l,r=[{key:"DEFAULTS",get:function(){return pe({href:"#",tagName:"a"})}}],(n=[{key:"build",value:function(){Hx(Vx(l.prototype),"build",this).call(this),Fx.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(Fx.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}])&&Ix(t.prototype,n),r&&Ix(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(vA);function Ux(e){return Ux="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ux(e)}function zx(e){return function(e){if(Array.isArray(e))return Gx(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Gx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gx(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gx(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Yx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kx(){return Kx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Xx(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Kx.apply(this,arguments)}function Xx(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Zx(object)););return object}function $x(e,p){return $x=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},$x(e,p)}function qx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zx(e);if(t){var o=Zx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qx(this,n)}}function Qx(e,t){if(t&&("object"===Ux(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Jx(e)}function Jx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zx(e){return Zx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zx(e)}var eM=new WeakMap,tM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$x(e,t)}(l,e);var t,n,r,o=qx(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,e,he(l.DEFAULTS,t)),eM.set(Jx(n),{}),n.searchInput=new AA(n.hot,{placeholder:qd,className:"htUIMultipleSelectSearch"}),n.selectAllUI=new Wx(n.hot,{textContent:Yd,className:"htUISelectAll"}),n.clearAllUI=new Wx(n.hot,{textContent:Kd,className:"htUIClearAll"}),n.items=[],n.itemsBox=null,n.registerHooks(),n}return t=l,n=[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)})),this.searchInput.addLocalHook("input",(function(t){return e.onInput(t)})),this.selectAllUI.addLocalHook("click",(function(t){return e.onSelectAllClick(t)})),this.clearAllUI.addLocalHook("click",(function(t){return e.onClearAllClick(t)}))}},{key:"setItems",value:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(e){this.locale=e}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return zx(this.items)}},{key:"getValue",value:function(){return e=this.items,t=[],$(e,(function(e){e.checked&&t.push(e.value)})),t;var e,t}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;Kx(Zx(l.prototype),"build",this).call(this);var t=this.hot.rootDocument,n=t.createElement("div"),r=new vA(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(r.element),this._element.appendChild(n);var o=function(n){e._element&&(e.itemsBox&&e.itemsBox.destroy(),Gt(n,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(n,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(e,t,col,n,r,o){e.title=o.instance.getDataAtRowProp(t,o.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return e.itemsBox.container.scrollWidth-kn(t)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:e.hot.isRtl()?"rtl":"ltr"}),e.itemsBox.init(),e.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:function(t){e.runLocalHooks("keydown",t,e)},group:"multipleSelect.itemBox"}))};o(n),setTimeout((function(){return o(n)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){var e,t,n;this.isBuilt()&&(this.itemsBox.loadData((e=this.items,t=this.options.value,n=Ax(t),X(e,(function(e){return e.checked=n(e.value),e})))),Kx(Zx(l.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Kx(Zx(l.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(e){var t,n=this,r=e.target.value.toLocaleLowerCase(this.getLocale());t=""===r?zx(this.items):K(this.items,(function(e){return"".concat(e.value).toLocaleLowerCase(n.getLocale()).indexOf(r)>=0})),this.itemsBox.loadData(t)}},{key:"onInputKeyDown",value:function(e){this.runLocalHooks("keydown",e,this),Ln($n,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(qn(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(e){var t=[];e.preventDefault(),$(this.itemsBox.getSourceData(),(function(e,n){e.checked=!0,t.push(Cc(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}},{key:"onClearAllClick",value:function(e){var t=[];e.preventDefault(),$(this.itemsBox.getSourceData(),(function(e,n){e.checked=!1,t.push(Cc(e,n)[0])})),this.itemsBox.setSourceDataAtCell(t)}}],r=[{key:"DEFAULTS",get:function(){return pe({className:"htUIMultipleSelect",value:[]})}}],n&&Yx(t.prototype,n),r&&Yx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(vA),nM=tM;function rM(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return oM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oM(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var iM="by_value";function aM(e){return aM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aM(e)}function lM(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return sM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sM(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function uM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cM(){return cM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=hM(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},cM.apply(this,arguments)}function hM(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=yM(object)););return object}function fM(e,p){return fM=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},fM(e,p)}function dM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yM(e);if(t){var o=yM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pM(this,n)}}function pM(e,t){if(t&&("object"===aM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yM(e){return yM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yM(e)}kT(iM,(function(e,t){return(0,rM(t,1)[0])(e.value)}),{name:"By value",inputsCount:0,inputValuesDecorator:function(e){return[Ax(rM(e,1)[0])]},showOperators:!1});var gM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fM(e,t)}(l,e);var t,n,r,o=dM(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this,e,{id:t.id,stateless:!1})).name=t.name,n.elements.push(new nM(n.hot)),n.registerHooks(),n}return t=l,n=[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}},{key:"setState",value:function(e){if(this.reset(),e&&e.command.key===iM){var select=this.getMultipleSelectElement();select.setItems(e.itemsSnapshot),select.setValue(e.args[0]),select.setLocale(e.locale)}}},{key:"getState",value:function(){var select=this.getMultipleSelectElement(),e=select.getItems();return{command:{key:select.isSelectedAllValues()||!e.length?OT:iM},args:[select.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(e){var t=this,n=function(n,r,o,l,c){var h=lM(K(r,(function(e){return e.name===iM})),1)[0],f={},d=t.hot.getTranslatedPhrase(Gd);if(h){var y=Mx(X(l(n,c),(function(e){return e.value})));o&&(h.args[0]=o);var v=[],m=Px(y,h.args[0],d,(function(e){e.checked&&v.push(e.value)})),w=e.editedConditionStack.column;f.locale=t.hot.getCellMeta(0,w).locale,f.args=[v],f.command=ST(iM),f.itemsSnapshot=m}else f.args=[],f.command=ST(OT);t.state.setValueAtIndex(n,f)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(element){return element instanceof nM}))[0]}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,col,o,l){Gt(n.parentNode,"htFiltersMenuValue");var label=e.hot.rootDocument.createElement("div");return Gt(label,"htFiltersMenuLabel"),label.textContent=l,n.appendChild(label),n.parentNode.hasAttribute("ghost-table")||$(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"reset",value:function(){var e=this.hot.getTranslatedPhrase(Gd),t=Mx(this._getColumnVisibleValues()),n=Px(t,t,e);this.getMultipleSelectElement().setItems(n),cM(yM(l.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(t);var r=this.hot.getPlugin("filters").getSelectedColumn().visualIndex;this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,r).locale)}},{key:"onInputKeyDown",value:function(e){$n(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),qn(e))}},{key:"_getColumnVisibleValues",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),t=e&&e.visualIndex;return X(this.hot.getDataAtCol(t),(function(e){return xx(e)}))}}],n&&uM(t.prototype,n),r&&uM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(bT),vM=gM;function mM(e){return mM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mM(e)}function bM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wM(e,p){return wM=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},wM(e,p)}function CM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kM(e);if(t){var o=kM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return SM(this,n)}}function SM(e,t){if(t&&("object"===mM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function kM(e){return kM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kM(e)}var OM,RM,EM=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wM(e,t)}(l,e);var t,n,r,o=CM(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this,e,{id:t.id,stateless:!0})).name=t.name,n.elements.push(new AA(n.hot,{type:"button",value:Xd,className:"htUIButton htUIButtonOK",identifier:l.BUTTON_OK})),n.elements.push(new AA(n.hot,{type:"button",value:$d,className:"htUIButton htUIButtonCancel",identifier:l.BUTTON_CANCEL})),n.registerHooks(),n}return t=l,r=[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}],(n=[{key:"registerHooks",value:function(){var e=this;$(this.elements,(function(element){element.addLocalHook("click",(function(t,button){return e.onButtonClick(t,button)}))}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n){return Gt(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||$(e.elements,(function(e){return n.appendChild(e.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(e,button){button.options.identifier===l.BUTTON_OK?this.accept():this.cancel()}}])&&bM(t.prototype,n),r&&bM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(bT);function TM(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return AM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AM(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function xM(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function MM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _M="ConditionCollection.filteringStates",IM=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];MM(this,e),this.hot=t,this.isMapRegistrable=n,this.filteringStates=new Ph,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(_M,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}var t,n,r;return t=e,n=[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(e,t){var n,r=this.filteringStates.getValueAtIndex(t),o=null!==(n=null==r?void 0:r.conditions)&&void 0!==n?n:[],l=null==r?void 0:r.operation;return this.isMatchInConditions(o,e,l)}},{key:"isMatchInConditions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tx;return!e.length||ZA(n)(e,t)}},{key:"addCondition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tx,r=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,e).locale,l=X(t.args,(function(e){return"string"==typeof e?e.toLocaleLowerCase(o):e})),c=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);var h=this.getOperation(e);if(h){if(h!==n)throw Error(et(OM||(OM=xM(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,h))}else if(at(JA[n]))throw new Error(et(RM||(RM=xM(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var f=this.getConditions(e);0===f.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:c,args:l,func:CT(c,l)}]},r):f.push({name:c,args:l,func:CT(c,l)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}},{key:"getOperation",value:function(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(e){return TM(e,1)[0]}))}},{key:"getColumnStackPosition",value:function(e){return this.getFilteredColumns().indexOf(e)}},{key:"exportAllConditions",value:function(){return Y(this.filteringStates.getEntries(),(function(e,t){var n=TM(t,2),r=n[0],o=n[1],l=o.operation,c=o.conditions;return e.push({column:r,operation:l,conditions:X(c,(function(e){return{name:e.name,args:e.args}}))}),e}),[])}},{key:"importAllConditions",value:function(e){var t=this;this.clean(),$(e,(function(e){$(e.conditions,(function(n){return t.addCondition(e.column,n)}))}))}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(e,t){var n=this.getConditions(e);return t?n.some((function(e){return e.name===t})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(_M),this.filteringStates=null,this.clearLocalHooks()}}],n&&PM(t.prototype,n),r&&PM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(IM,Mc);var HM=IM;function jM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var NM=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};jM(this,e),this.conditionCollection=t,this.columnDataFactory=n}var t,n,r;return t=e,n=[{key:"filter",value:function(){var e=this,t=[];return $(this.conditionCollection.getFilteredColumns(),(function(n,r){var o=e.columnDataFactory(n);r&&(o=e._getIntersectData(o,t)),t=e.filterByColumn(n,o)})),t}},{key:"filterByColumn",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return $(n,(function(n){void 0!==n&&t.conditionCollection.isMatch(n,e)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(data,e){var t=[];return $(e,(function(e){var n=e.meta.visualRow;void 0!==data[n]&&(t[n]=data[n])})),t}}],n&&DM(t.prototype,n),r&&DM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),LM=NM;function BM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var FM=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};BM(this,e),this.hot=t,this.conditionCollection=n,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(e){return r._onConditionBeforeModify(e)})),this.conditionCollection.addLocalHook("afterRemove",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("afterAdd",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}var t,n,r;return t=e,n=[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,$(this.changes,(function(t){e.updateStatesAtColumn(t)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}},{key:"updateStatesAtColumn",value:function(e,t){var n=this;if(this.grouping)-1===this.changes.indexOf(e)&&this.changes.push(e);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(e);-1===o&&(o=this.latestEditedColumnPosition);var l=r.slice(0,o),c=r.slice(o);c.length&&c[0].column===e&&c.shift();var h=Bn((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new HM(n.hot,!1),l=[].concat(e,r);o.importAllConditions(l);var c=n.columnDataFactory(t),h=Ax(X(o.isEmpty()?c:new LM(o,(function(e){return n.columnDataFactory(e)})).filter(),(function(e){return e.meta.visualRow})));return o.destroy(),K(c,(function(e){return h(e.meta.visualRow)}))}))(l),f=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:f},dependentConditionStacks:c,filteredRowsFactory:h,conditionArgsChange:t})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var e=this;$(this.latestOrderStack,(function(t){e.updateStatesAtColumn(t)}))}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),be(this,(function(t,n){e[n]=null}))}}],n&&VM(t.prototype,n),r&&VM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();ye(FM,Mc);var WM,UM=FM;function zM(e){return zM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zM(e)}function GM(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return YM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YM(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YM(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function KM(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function XM(){return XM="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=$M(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},XM.apply(this,arguments)}function $M(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=eP(object)););return object}function qM(e,p){return qM=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},qM(e,p)}function QM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eP(e);if(t){var o=eP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return JM(this,n)}}function JM(e,t){if(t&&("object"===zM(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ZM(e)}function ZM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eP(e){return eP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},eP(e)}var tP="filters",nP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qM(e,t)}(l,e);var t,n,r,o=QM(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).eventManager=new Hr(ZM(t)),t.dropdownMenuPlugin=null,t.conditionCollection=null,t.conditionUpdateObserver=null,t.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),t.lastSelectedColumn=null,t.filtersRowsMap=null,t.hot.addHook("afterGetColHeader",(function(col,e){return t.onAfterGetColHeader(col,e)})),t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Bh),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,r=function(component){return component.addLocalHook("accept",(function(){return e.onActionBarSubmit("accept")})),component.addLocalHook("cancel",(function(){return e.onActionBarSubmit("cancel")})),component.addLocalHook("change",(function(t){return e.onComponentChange(component,t)})),component};if(!this.components.get("filter_by_condition")){var o=new QA(this.hot,{id:"filter_by_condition",name:function(){return"".concat(e.hot.getTranslatedPhrase(Fd),":")},addSeparator:!1,menuContainer:n});o.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition",r(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Ox(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new QA(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});c.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition2",r(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new vM(this.hot,{id:"filter_by_value",name:function(){return"".concat(e.hot.getTranslatedPhrase(Wd),":")}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new EM(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new HM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new UM(this.hot,this.conditionCollection,(function(t){return e.getDataMapAtColumn(t)})),this.conditionUpdateObserver.addLocalHook("update",(function(t){return e.updateComponents(t)}))),this.components.forEach((function(component){return component.show()})),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",(function(t){return e.onBeforeDropdownMenuSetItems(t)})),this.addHook("afterDropdownMenuDefaultOptions",(function(t){return e.onAfterDropdownMenuDefaultOptions(t)})),this.addHook("afterDropdownMenuShow",(function(){return e.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return e.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(t){return e.onAfterChange(t)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),XM(eP(l.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"disablePlugin",value:function(){var e,t=this;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(component,e){component.destroy(),t.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),XM(eP(l.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tx,o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:n},r)}},{key:"removeConditions",value:function(e){var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(e){if(void 0===e)this.conditionCollection.clean();else{var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}},{key:"filter",value:function(){var e=this,t=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o))if(n){var l=[];this.hot.batchExecution((function(){e.filtersRowsMap.clear();var n=Ax(r=X(t.filter(),(function(e){return e.meta.visualRow})));no(e.hot.countSourceRows()-1,(function(e){n(e)||l.push(e)})),$(l,(function(t){e.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var e,t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.getTopStartCorner();void 0!==t&&this.hot.selectCell(t.row,t.col)}},{key:"getDataMapAtColumn",value:function(e){var t=this,n=this.hot.toVisualColumn(e),data=[];return $(this.hot.getSourceDataAtCol(n),(function(e,r){var o,l=t.hot.getCellMeta(r,n),c=l.row,col=l.col,h=l.visualCol,f=l.visualRow,d=l.type,y=l.instance,v=l.dateFormat,m=l.locale,w=null!==(o=t.hot.getDataAtCell(t.hot.toVisualRow(r),n))&&void 0!==o?o:e;data.push({meta:{row:c,col:col,visualCol:h,visualRow:f,type:d,instance:y,dateFormat:v,locale:m},value:xx(w)})})),data}},{key:"onAfterChange",value:function(e){var t=this;e&&$(e,(function(e){var n=GM(e,2)[1],r=t.hot.propToCol(n);t.conditionCollection.hasConditions(r)&&t.updateValueComponentCondition(r)}))}},{key:"updateValueComponentCondition",value:function(e){var t=Mx(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}},{key:"restoreComponents",value:function(e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((function(component){component.isHidden()||component.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var e=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:Wk}),this.components.forEach((function(component){e.items.push(component.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(e,t,n,r){var o=e;return o===nx&&t.command.key!==OT&&n.command.key!==OT&&r.command.key!==OT?o=rx:r.command.key!==OT&&(t.command.key!==OT&&n.command.key!==OT||(o=tx)),o}},{key:"onActionBarSubmit",value:function(e){if("accept"===e){var t,n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex,r=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),c=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,o,l);this.conditionUpdateObserver.groupChanges();var h=this.conditionCollection.getColumnStackPosition(n);-1===h&&(h=void 0),this.conditionCollection.removeConditions(n),r.command.key!==OT&&(this.conditionCollection.addCondition(n,r,c,h),o.command.key!==OT&&this.conditionCollection.addCondition(n,o,c,h)),l.command.key!==OT&&this.conditionCollection.addCondition(n,l,c,h),this.conditionUpdateObserver.flush(),this.components.forEach((function(component){return component.saveState(n)})),this.filtersRowsMap.clear(),this.filter()}this.dropdownMenuPlugin&&this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(component,e){this.updateDependentComponentsVisibility(),component.constructor!==QA||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var e=this.components.get("filter_by_condition").getState().command,t=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents.apply(this,t):this.hideComponents.apply(this,t)}},{key:"onAfterGetColHeader",value:function(col,e){var t=this.hot.toPhysicalColumn(col);this.enabled&&this.conditionCollection.hasConditions(t)?Gt(e,"htFiltersActive"):Yt(e,"htFiltersActive")}},{key:"onTableClick",value:function(e){var th=Dt(e.target,"TH");if(th){var t=this.hot.getCoords(th).col,n=this.hot.toPhysicalColumn(t);this.lastSelectedColumn={visualIndex:t,physicalIndex:n}}}},{key:"_createDataFilter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new LM(t,(function(t){return e.getDataMapAtColumn(t)}))}},{key:"updateComponents",value:function(e){var t;if(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled){var n=e.editedConditionStack,r=n.conditions,o=n.column,l=r.filter((function(e){return e.name===iM})),c=r.filter((function(e){return e.name!==iM}));if(l.length>=2||c.length>=3)er(et(WM||(WM=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{var h=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(c[0],o),this.components.get("filter_by_condition2").updateState(c[1],o),this.components.get("filter_operators").updateState(h,o),this.components.get("filter_by_value").updateState(e)}}}},{key:"getIndexesOfComponents",value:function(){var e=[];if(!this.dropdownMenuPlugin)return e;for(var menu=this.dropdownMenuPlugin.menu,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $(n,(function(component){$(menu.menuItems,(function(t,n){t.key===component.getMenuItemDescriptor().key&&e.push(n)}))})),e}},{key:"changeComponentsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var menu=this.dropdownMenuPlugin.menu,t=menu.hotMenu,n=t.getPlugin("hiddenRows"),r=arguments.length,o=new Array(r>1?r-1:0),l=1;l<r;l++)o[l-1]=arguments[l];var c=this.getIndexesOfComponents.apply(this,o);e?n.showRows(c):n.hideRows(c),t.render()}}},{key:"hideComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(t))}},{key:"showComponents",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(t))}},{key:"destroy",value:function(){var e=this;this.enabled&&(this.components.forEach((function(component,t){null!==component&&(component.destroy(),e.components.set(t,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),XM(eP(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return tP}},{key:"PLUGIN_PRIORITY",get:function(){return 250}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}],n&&KM(t.prototype,n),r&&KM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function rP(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function oP(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?rP(Object(source),!0).forEach((function(t){iP(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):rP(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function iP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var aP="internal-use-in-handsontable",lP={licenseKey:aP,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function sP(e){var t,n;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[BP])||void 0===t||null===(n=t.language)||void 0===n?void 0:n.langCode}}function uP(e){return Object.keys(e).reduce((function(t,n){return"hyperformula"!==n&&(t[n]=e[n]),t}),{})}function cP(e){return cP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cP(e)}function hP(){var e="engine_relationship",t=vr(BP);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function fP(){var e="shared_engine_usage",t=vr(BP);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function dP(e){var t,n=e.getSettings(),r=n[BP],o=null==r?void 0:r.engine;if(!0===r)return null;if(at(o))return null;if("function"==typeof o.hyperformula||"function"==typeof o)return function(e,t,n){var r=t[BP],o=function(e){var t,n=e[BP],r=uP(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=sP(e);return oP(oP(oP({},lP),r),o)}(t),l=hP(),c=fP();(function(e,t){t&&t.forEach((function(t){var n=t.name,r=t.plugin,o=t.translations;try{e.registerFunction(n,r,o)}catch(e){er(e.message)}}))})(e,r.functions),function(e,t){if(t){var n=t.langCode;try{e.registerLanguage(n,t)}catch(e){er(e.message)}}}(e,r.language);var h=e.buildEmpty(o);return l.set(h,[n]),c.set(h,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((function(t){var n=t.name,r=t.expression,o=t.scope,l=t.options;try{e.addNamedExpression(n,r,o,l)}catch(e){er(e.message)}})),e.resumeEvaluation())}(h,r.namedExpressions),h.on("sheetAdded",(function(){h.rebuildAndRecalculate()})),h.on("sheetRemoved",(function(){h.rebuildAndRecalculate()})),h}(null!==(t=o.hyperformula)&&void 0!==t?t:o,n,e);if("object"===cP(o)&&at(o.hyperformula)){var l=hP(),c=fP().get(o);return l.has(o)||l.set(o,[]),l.get(o).push(e),c&&c.push(e.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:aP}),o}return null}function pP(e){var t,n=hP(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map((function(e){return[e.getPlugin("formulas").sheetId,e]})))}function yP(e,t){if(e){var n=hP(),r=n.get(e),o=fP(),l=o.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),l&&l.includes(t.guid)&&(l.splice(l.indexOf(t.guid),1),0===l.length&&(o.delete(e),e.destroy()))}}function gP(e,t){return!at(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}function vP(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function mP(e){return function(e){if(Array.isArray(e))return OP(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kP(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bP(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function wP(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?bP(Object(source),!0).forEach((function(t){HP(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):bP(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function CP(e){return CP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CP(e)}function SP(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||kP(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kP(e,t){if(e){if("string"==typeof e)return OP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OP(e,t):void 0}}function OP(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function RP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EP(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function TP(){return TP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=AP(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},TP.apply(this,arguments)}function AP(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=IP(object)););return object}function xP(e,p){return xP=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},xP(e,p)}function MP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=IP(e);if(t){var o=IP(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return PP(this,n)}}function PP(e,t){if(t&&("object"===CP(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _P(e)}function _P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IP(e){return IP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},IP(e)}function HP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jP(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function DP(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,LP(e,t,"set"),n),n}function NP(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,LP(e,t,"get"))}function LP(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var BP="formulas",VP="row_move";dr.getSingleton().register("afterNamedExpressionAdded"),dr.getSingleton().register("afterNamedExpressionRemoved"),dr.getSingleton().register("afterSheetAdded"),dr.getSingleton().register("afterSheetRemoved"),dr.getSingleton().register("afterSheetRenamed"),dr.getSingleton().register("afterFormulasValuesUpdate");var FP=function(source){return"UndoRedo.undo"===source||"UndoRedo.redo"===source||"auto"===source},WP=new WeakMap,UP=new WeakMap,zP=new WeakMap,GP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xP(e,t)}(l,e);var t,n,r,o=MP(l);function l(){var e;RP(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jP(_P(e=o.call.apply(o,[this].concat(n))),WP,{writable:!0,value:!1}),jP(_P(e),UP,{writable:!0,value:!1}),jP(_P(e),zP,{writable:!0,value:[["valuesUpdated",function(){var t;return(t=e).onEngineValuesUpdated.apply(t,arguments)}],["namedExpressionAdded",function(){var t;return(t=e).onEngineNamedExpressionsAdded.apply(t,arguments)}],["namedExpressionRemoved",function(){var t;return(t=e).onEngineNamedExpressionsRemoved.apply(t,arguments)}],["sheetAdded",function(){var t;return(t=e).onEngineSheetAdded.apply(t,arguments)}],["sheetRenamed",function(){var t;return(t=e).onEngineSheetRenamed.apply(t,arguments)}],["sheetRemoved",function(){var t;return(t=e).onEngineSheetRemoved.apply(t,arguments)}]]}),HP(_P(e),"staticRegister",vr("formulas")),HP(_P(e),"engine",null),HP(_P(e),"sheetName",null),e}return t=l,n=[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[BP]}},{key:"enablePlugin",value:function(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=dP(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==n&&(this.sheetName=n)}this.addHook("beforeLoadData",(function(){return t.onBeforeLoadData.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("modifyData",(function(){return t.onModifyData.apply(t,arguments)})),this.addHook("modifySourceData",(function(){return t.onModifySourceData.apply(t,arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate.apply(t,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return t.onAfterSetSourceDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow.apply(t,arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("beforeUndo",(function(e){(null==e?void 0:e.actionType)!==VP&&t.engine.undo()})),this.addHook("beforeRedo",(function(e){(null==e?void 0:e.actionType)!==VP&&t.engine.redo()})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("beforeAutofill",(function(){return t.onBeforeAutofill.apply(t,arguments)})),NP(this,zP).forEach((function(e){var n=SP(e,2),r=n[0],o=n[1];return t.engine.on(r,o)})),TP(IP(l.prototype),"enablePlugin",this).call(this)}else er("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var e=this;NP(this,zP).forEach((function(t){var n=SP(t,2),r=n[0],o=n[1];return e.engine.off(r,o)})),yP(this.engine,this.hot),this.engine=null,TP(IP(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(e){this.engine.updateConfig(function(e){var t,n=e[BP],r=uP(null!=n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),o=sP(e);return oP(oP({},r),o)}(this.hot.getSettings()));var t=this.hot.getSettings()[BP];if(it(t)&&it(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),!e.data&&null===this.sheetName){var n=this.hot.getSettings()[BP].sheetName;n&&this.engine.doesSheetExist(n)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=n?n:void 0,this.hot.getSourceDataArray())}TP(IP(l.prototype),"updatePlugin",this).call(this,e)}},{key:"destroy",value:function(){var e=this;NP(this,zP).forEach((function(t){var n,r=SP(t,2),o=r[0],l=r[1];return null===(n=e.engine)||void 0===n?void 0:n.off(o,l)})),DP(this,zP,null),yP(this.engine,this.hot),this.engine=null,TP(IP(l.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(e,t,n,r,o){return!o&&e>=n?r+(e-n):t}},{key:"toPhysicalRowPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalRow(e),this.hot.countRows(),this.hot.countSourceRows(),t)}},{key:"toPhysicalColumnPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPhysicalIndexPosition(e,this.hot.toPhysicalColumn(e),this.hot.countCols(),this.hot.countSourceCols(),t)}},{key:"addSheet",value:function(e,t){if(it(t)&&!kc(t))return er("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return er("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(e){return er(e.message),!1}}},{key:"switchSheet",value:function(e){if(this.engine.doesSheetExist(e)){this.sheetName=e;var t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,"".concat(kt(BP),".switchSheet"))}else nr("The sheet named `".concat(e,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o?this.engine.getCellType({sheet:n,row:r,col:o}):"EMPTY"}},{key:"isFormulaCellType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return null!==r&&null!==o&&this.engine.doesCellHaveFormula({sheet:n,row:r,col:o})}},{key:"renderDependentSheets",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set;e.forEach((function(e){var t,n=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==n&&(r.has(n)||r.add(n))})),pP(this.engine).forEach((function(e,o){var l;(n||o!==t.sheetId)&&r.has(o)&&(e.render(),null===(l=e.view)||void 0===l||l.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(e){var t,n=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{},r=n.row,col=n.col,o=n.sheet;return it(o)?"".concat(o,":").concat(r,"x").concat(col):""},o=new Set(n.map((function(e){return r(e)})));e.forEach((function(e){var n,l,c=null!==(n=e.address)&&void 0!==n?n:{},h=c.row,col=c.col,f=it(h)?t.hot.toVisualRow(h):null,d=it(col)?t.hot.toVisualColumn(col):null;if(null!==f&&null!==d){var y=null==e||null===(l=e.address)||void 0===l?void 0:l.sheet,v=r(e);if(void 0!==y&&!o.has(v)){var m=pP(t.engine).get(y);if(!m)return;m.validateCell(m.getDataAtCell(f,d),m.getCellMeta(f,d),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(e,t,n){var address={row:this.toPhysicalRowPosition(e),col:this.toPhysicalColumnPosition(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(address))return this.engine.setCellContents(address,n);er("Not possible to set cell data at ".concat(JSON.stringify(address)))}},{key:"onBeforeValidate",value:function(e,t,n){var r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){var address={row:this.hot.toPhysicalRow(t),col:this.hot.toPhysicalColumn(r),sheet:this.sheetId},o=this.engine.getCellValue(address);return"object"===CP(o)&&null!==o?o.value:o}return e}},{key:"onBeforeAutofill",value:function(e,t,n){var r=this,o=function(e){return wP(wP({},e),{},{sheet:r.sheetId})},l={start:o(t.getTopStartCorner()),end:o(t.getBottomEndCorner())},c={start:o(n.getTopStartCorner()),end:o(n.getBottomEndCorner())};return!1!==this.engine.isItPossibleToSetCellContents(c)&&this.engine.getFillRangeData(l,c)}},{key:"onBeforeLoadData",value:function(e,t){var source=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";source.includes(kt(BP))||DP(this,UP,at(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(e,t){var source=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!source.includes(kt(BP)))if(this.sheetName=gP(this.engine,this.hot.getSettings()[BP].sheetName),NP(this,UP))this.switchSheet(this.sheetName);else{var n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)){DP(this,WP,!0);var r=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(r),DP(this,WP,!1)}}}},{key:"onModifyData",value:function(e,t,n,r){if("get"===r&&!NP(this,WP)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o,l=this.hot.toVisualRow(e);if(!this.isFormulaCellType(l,t)&&"ARRAY"!==this.getCellType(l,t))return void(vP(n.value)&&(n.value=vP(o=n.value)?o.substr(1):o));var address={row:e,col:this.toPhysicalColumnPosition(t),sheet:this.sheetId},c=this.engine.getCellValue(address),h="object"===CP(c)&&null!==c?c.value:c;n.value=h}}},{key:"onModifySourceData",value:function(e,t,n,r){if("get"===r&&!NP(this,WP)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(e),l=this.hot.propToCol(t);if(!this.isFormulaCellType(o,l)&&"ARRAY"!==this.getCellType(o,l))return;var c=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==c.width||0!==c.height){var address={row:e,col:this.toPhysicalColumnPosition(l),sheet:this.sheetId};n.value=this.engine.getCellSerialized(address)}}}},{key:"onAfterSetDataAtCell",value:function(e,source){var t=this;if(!FP(source)){var n=[],r=[],o=this.engine.batch((function(){e.forEach((function(e){var o=SP(e,4),l=o[0],c=o[1],h=o[3],f=t.hot.propToCol(c),d=t.hot.toPhysicalRow(l),y=t.hot.toPhysicalColumn(f),address={row:d,col:y,sheet:t.sheetId};null!==d&&null!==y?t.syncChangeWithEngine(l,f,h):n.push([l,f,h]),r.push({address:address})}))}));n.length&&this.hot.addHookOnce("afterChange",(function(){var e=t.engine.batch((function(){n.forEach((function(e){var n=SP(e,3),r=n[0],o=n[1],l=n[2];t.syncChangeWithEngine(r,o,l)}))}));t.renderDependentSheets(e,!0)})),this.renderDependentSheets(o),this.validateDependentCells(o,r)}}},{key:"onAfterSetSourceDataAtCell",value:function(e,source){var t=this;if(!FP(source)){var n=[],r=[];e.forEach((function(e){var o=SP(e,4),l=o[0],c=o[1],h=o[3],f=t.hot.propToCol(c);if(eo(f)){var address={row:l,col:t.toPhysicalColumnPosition(f),sheet:t.sheetId};t.engine.isItPossibleToSetCellContents(address)?(r.push({address:address}),n.push.apply(n,mP(t.engine.setCellContents(address,h)))):er("Not possible to set source cell data at ".concat(JSON.stringify(address)))}})),this.renderDependentSheets(n),this.validateDependentCells(n,r)}}},{key:"onBeforeCreateRow",value:function(e,t){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(e),t]))return!1}},{key:"onBeforeCreateCol",value:function(col,e){if(null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(col),e]))return!1}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this;return!1!==n.every((function(e){return r.engine.isItPossibleToRemoveRows(r.sheetId,[e,1])}))&&void 0}},{key:"onBeforeRemoveCol",value:function(col,e,t){var n=this;return!1!==t.every((function(e){return n.engine.isItPossibleToRemoveColumns(n.sheetId,[e,1])}))&&void 0}},{key:"onAfterCreateRow",value:function(e,t,source){if(!FP(source)){var n=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(e),t]);this.renderDependentSheets(n)}}},{key:"onAfterCreateCol",value:function(col,e,source){if(!FP(source)){var t=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(col),e]);this.renderDependentSheets(t)}}},{key:"onAfterRemoveRow",value:function(e,t,n,source){var r=this;if(!FP(source)){var o=n.sort().reverse(),l=this.engine.batch((function(){o.forEach((function(e){r.engine.removeRows(r.sheetId,[e,1])}))}));this.renderDependentSheets(l)}}},{key:"onAfterRemoveCol",value:function(col,e,t,source){var n=this;if(!FP(source)){var r=t.sort().reverse(),o=this.engine.batch((function(){r.forEach((function(e){n.engine.removeColumns(n.sheetId,[e,1])}))}));this.renderDependentSheets(o)}}},{key:"onAfterDetachChild",value:function(e,element,t){var n,r=this;DP(this,WP,!0);var o=this.hot.getSourceDataArray(t,0,t+((null===(n=element.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());DP(this,WP,!1),o.forEach((function(e,n){e.forEach((function(e,o){r.engine.setCellContents({col:o,row:t+n,sheet:r.sheetId},[[e]])}))}))}},{key:"onEngineValuesUpdated",value:function(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}},{key:"onEngineNamedExpressionsAdded",value:function(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}},{key:"onEngineNamedExpressionsRemoved",value:function(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}},{key:"onEngineSheetAdded",value:function(e){this.hot.runHooks("afterSheetAdded",e)}},{key:"onEngineSheetRenamed",value:function(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}},{key:"onEngineSheetRemoved",value:function(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}],r=[{key:"PLUGIN_KEY",get:function(){return BP}},{key:"PLUGIN_PRIORITY",get:function(){return 260}}],n&&EP(t.prototype,n),r&&EP(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function YP(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return KP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KP(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KP(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function XP(e){return function(e){if(Array.isArray(e))return $P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return $P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $P(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $P(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function qP(e){return qP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qP(e)}function QP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JP(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ZP(){return ZP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=e_(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},ZP.apply(this,arguments)}function e_(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=i_(object)););return object}function t_(e,p){return t_=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},t_(e,p)}function n_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i_(e);if(t){var o=i_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return r_(this,n)}}function r_(e,t){if(t&&("object"===qP(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o_(e)}function o_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i_(e){return i_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i_(e)}function a_(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function l_(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,u_(e,t,"get"))}function s_(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,u_(e,t,"set"),n),n}function u_(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}dr.getSingleton().register("beforeHideColumns"),dr.getSingleton().register("afterHideColumns"),dr.getSingleton().register("beforeUnhideColumns"),dr.getSingleton().register("afterUnhideColumns");var c_="hiddenColumns",h_=new WeakMap,f_=new WeakMap,d_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t_(e,t)}(l,e);var t,n,r,o=n_(l);function l(){var e;QP(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return a_(o_(e=o.call.apply(o,[this].concat(n))),h_,{writable:!0,value:{}}),a_(o_(e),f_,{writable:!0,value:null}),e}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenColumns;ve(t)&&(s_(this,h_,t),at(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),s_(this,f_,new vh),l_(this,f_).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,l_(this,f_)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,col,n){return e.onAfterGetCellMeta(t,col,n)})),this.addHook("modifyColWidth",(function(t,col){return e.onModifyColWidth(t,col)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),ZP(i_(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ZP(i_(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),s_(this,h_,{}),ZP(i_(l.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n,l=l_(this,f_).getValues().slice(),c=e.length>0;r&&c&&($(e.map((function(e){return t.hot.toPhysicalColumn(e)})),(function(e){l[e]=!1})),o=Y(l,(function(e,n,r){return n&&e.push(t.hot.toVisualColumn(r)),e}),[])),!1!==this.hot.runHooks("beforeUnhideColumns",n,o,r&&c)&&(r&&c&&l_(this,f_).setValues(l),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&c,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this,n=this.getHiddenColumns(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",n,o,r)&&(r&&this.hot.batchExecution((function(){$(e,(function(e){l_(t,f_).setValueAtIndex(t.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}},{key:"getHiddenColumns",value:function(){var e=this;return X(l_(this,f_).getHiddenIndexes(),(function(t){return e.hot.toVisualColumn(t)}))}},{key:"isHidden",value:function(e){return l_(this,f_).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),(function(meta){meta&&(meta.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?0:l_(this,h_).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===l_(this,h_).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(l_(this,h_).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return $(e,(function(e){var n=!0,o=0;no(e.startCol,e.endCol,(function(l){t.isHidden(l)?(n||r(e.startRow,e.endRow,o,l-1),n=!0):(n&&(o=l),l===e.endCol&&r(e.startRow,e.endRow,o,l),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(e,t){if(l_(this,h_).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),Gt(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:Wk},(t=this,{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=YP(e,4);n[1]-n[3]!=0&&(t=1)}return this.getTranslatedPhrase(pd,t)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.col,r.col),0),l=Math.max(n.col,r.col),c=[],h=o;h<=l;h+=1)c.push(h);var f=c[0],d=c[c.length-1],y=this.columnIndexMapper.getFirstNotHiddenIndex(d+1,1,!0,f-1);t.hideColumns(c),Number.isInteger(y)&&y>=0?this.selectColumns(y):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){var t=[];return{key:"hidden_columns_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(yd,e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],l=t[t.length-1];o=null!==(n=this.columnIndexMapper.getFirstNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,l=null!==(r=this.columnIndexMapper.getFirstNotHiddenIndex(l+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(!0),l-o+1===this.countCols()||this.selectColumns(o,l)}},disabled:!1,hidden:function(){var n=this,r=X(e.getHiddenColumns(),(function(e){return n.toPhysicalColumn(e)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),l=o.getTopStartCorner().col,c=o.getBottomEndCorner().col,h=this.columnIndexMapper,f=h.getRenderableFromVisualIndex(l),d=h.getRenderableFromVisualIndex(c),y=h.getNotTrimmedIndexes(),v=[];if(l!==c){if(c-l+1>d-f+1){var m=y.slice(l,c+1);v.push.apply(v,XP(m.filter((function(e){return r.includes(e)}))))}}else if(0===f&&f<l)v.push.apply(v,XP(y.slice(0,l)));else if(null===f)v.push.apply(v,XP(y.slice(0,this.countCols())));else{var w=this.countCols()-1;d===h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(w,-1))&&w>c&&v.push.apply(v,XP(y.slice(c+1)))}return $(v,(function(e){t.push(n.toVisualColumn(e))})),0===t.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(l_(this,h_).columns)&&this.hideColumns(l_(this,h_).columns)}},{key:"destroy",value:function(){s_(this,h_,null),s_(this,f_,null),ZP(i_(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return c_}},{key:"PLUGIN_PRIORITY",get:function(){return 310}}],n&&JP(t.prototype,n),r&&JP(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function p_(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return y_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y_(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y_(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function g_(e){return function(e){if(Array.isArray(e))return v_(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return v_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v_(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v_(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function m_(e){return m_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m_(e)}function b_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C_(){return C_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=S_(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},C_.apply(this,arguments)}function S_(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=T_(object)););return object}function k_(e,p){return k_=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},k_(e,p)}function O_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T_(e);if(t){var o=T_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R_(this,n)}}function R_(e,t){if(t&&("object"===m_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E_(e)}function E_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T_(e){return T_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},T_(e)}function A_(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function x_(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,P_(e,t,"get"))}function M_(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,P_(e,t,"set"),n),n}function P_(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}dr.getSingleton().register("beforeHideRows"),dr.getSingleton().register("afterHideRows"),dr.getSingleton().register("beforeUnhideRows"),dr.getSingleton().register("afterUnhideRows");var __="hiddenRows",I_=new WeakMap,H_=new WeakMap,j_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k_(e,t)}(l,e);var t,n,r,o=O_(l);function l(){var e;b_(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return A_(E_(e=o.call.apply(o,[this].concat(n))),I_,{writable:!0,value:{}}),A_(E_(e),H_,{writable:!0,value:null}),e}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenRows;ve(t)&&(M_(this,I_,t),at(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),M_(this,H_,new vh),x_(this,H_).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,x_(this,H_)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,col,n){return e.onAfterGetCellMeta(t,col,n)})),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),C_(T_(l.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),C_(T_(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),M_(this,I_,{}),C_(T_(l.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n,l=x_(this,H_).getValues().slice(),c=e.length>0;r&&c&&($(e.map((function(e){return t.hot.toPhysicalRow(e)})),(function(e){l[e]=!1})),o=Y(l,(function(e,n,r){return n&&e.push(t.hot.toVisualRow(r)),e}),[])),!1!==this.hot.runHooks("beforeUnhideRows",n,o,r&&c)&&(r&&c&&x_(this,H_).setValues(l),this.hot.runHooks("afterUnhideRows",n,o,r&&c,r&&o.length<n.length))}},{key:"showRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}},{key:"hideRows",value:function(e){var t=this,n=this.getHiddenRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",n,o,r)&&(r&&this.hot.batchExecution((function(){$(e,(function(e){x_(t,H_).setValueAtIndex(t.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}},{key:"hideRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}},{key:"getHiddenRows",value:function(){var e=this;return X(x_(this,H_).getHiddenIndexes(),(function(t){return e.hot.toVisualRow(t)}))}},{key:"isHidden",value:function(e){return x_(this,H_).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){$(this.hot.getCellsMeta(),(function(meta){meta&&(meta.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(e,t){return this.isHidden(t)?0:e}},{key:"onAfterGetCellMeta",value:function(e,t,n){if(!1===x_(this,I_).copyPasteEnabled&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(x_(this,I_).copyPasteEnabled)return e;var n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return $(e,(function(e){var n=!0,o=0;no(e.startRow,e.endRow,(function(l){t.isHidden(l)?(n||r(o,l-1,e.startCol,e.endCol),n=!0):(n&&(o=l),l===e.endRow&&r(o,l,e.startCol,e.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(e,t){if(x_(this,I_).indicators&&!(e<0)){var n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),Gt(t,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:Wk},(t=this,{key:"hidden_rows_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var n=p_(e,3);n[0]-n[2]!=0&&(t=1)}return this.getTranslatedPhrase(gd,t)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.row,r.row),0),l=Math.max(n.row,r.row),c=[],h=o;h<=l;h+=1)c.push(h);var f=c[0],d=c[c.length-1],y=this.rowIndexMapper.getFirstNotHiddenIndex(d+1,1,!0,f-1);t.hideRows(c),Number.isInteger(y)&&y>=0?this.selectRows(y):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){var t=[];return{key:"hidden_rows_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(vd,e)},callback:function(){var n,r;if(0!==t.length){var o=t[0],l=t[t.length-1];o=null!==(n=this.rowIndexMapper.getFirstNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,l=null!==(r=this.rowIndexMapper.getFirstNotHiddenIndex(l+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(!0),l-o+1===this.countRows()||this.selectRows(o,l)}},disabled:!1,hidden:function(){var n=this,r=X(e.getHiddenRows(),(function(e){return n.toPhysicalRow(e)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),l=o.getTopStartCorner().row,c=o.getBottomEndCorner().row,h=this.rowIndexMapper,f=h.getRenderableFromVisualIndex(l),d=h.getRenderableFromVisualIndex(c),y=h.getNotTrimmedIndexes(),v=[];if(l!==c){if(c-l+1>d-f+1){var m=y.slice(l,c+1);v.push.apply(v,g_(m.filter((function(e){return r.includes(e)}))))}}else if(0===f&&f<l)v.push.apply(v,g_(y.slice(0,l)));else if(null===f)v.push.apply(v,g_(y.slice(0,this.countRows())));else{var w=this.countRows()-1;d===h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(w,-1))&&w>c&&v.push.apply(v,g_(y.slice(c+1)))}return $(v,(function(e){t.push(n.toVisualRow(e))})),0===t.length}}}(this))}},{key:"onMapInit",value:function(){Array.isArray(x_(this,I_).rows)&&this.hideRows(x_(this,I_).rows)}},{key:"destroy",value:function(){M_(this,I_,null),M_(this,H_,null),C_(T_(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return __}},{key:"PLUGIN_PRIORITY",get:function(){return 320}}],n&&w_(t.prototype,n),r&&w_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function D_(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return N_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N_(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N_(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function L_(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return B_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B_(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B_(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function V_(e){return V_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V_(e)}function F_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function W_(){return W_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=U_(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},W_.apply(this,arguments)}function U_(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=X_(object)););return object}function z_(e,p){return z_=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},z_(e,p)}function G_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=X_(e);if(t){var o=X_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Y_(this,n)}}function Y_(e,t){if(t&&("object"===V_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return K_(e)}function K_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X_(e){return X_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},X_(e)}var $_="manualColumnFreeze",q_=new WeakMap,Q_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z_(e,t)}(l,e);var t,n,r,o=G_(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=o.call(this,e),q_.set(K_(t),{afterFirstUse:!1}),t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return $_}},{key:"PLUGIN_PRIORITY",get:function(){return 110}}],(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addContextMenuEntry(t)})),this.addHook("beforeColumnMove",(function(t,n){return e.onBeforeColumnMove(t,n)})),W_(X_(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){q_.get(this).afterFirstUse=!1,W_(X_(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),W_(X_(l.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(e){var t=q_.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsStart===this.hot.countCols()||e<=n.fixedColumnsStart-1||(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1)}},{key:"unfreezeColumn",value:function(e){var t=q_.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsStart<=0||e>n.fixedColumnsStart-1||(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart))}},{key:"addContextMenuEntry",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name:function(){return this.getTranslatedPhrase(Wf)},callback:function(e,n){var r=D_(n,1)[0].start.col;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(Uf)},callback:function(t,n){var r=L_(n,1)[0].start.col;e.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}},{key:"onBeforeColumnMove",value:function(e,t){if(q_.get(this).afterFirstUse){var n=this.hot.getSettings().fixedColumnsStart;if(t<n)return!1;if(e.some((function(e){return e<n})))return!1}}}])&&F_(t.prototype,n),r&&F_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function J_(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Z_="px",eI=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this._element=null,this.state=0,this.inlineProperty=t.isRtl()?"right":"left"}var t,n,r;return t=e,(n=[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){eo(e)&&(this._element.style.top=e+Z_),eo(t)&&(this._element.style[this.inlineProperty]=t+Z_)}},{key:"getPosition",value:function(){var style=this._element.style;return{top:style.top?parseInt(style.top,10):0,start:style[this.inlineProperty]?parseInt(style[this.inlineProperty],10):0}}},{key:"setSize",value:function(e,t){eo(e)&&(this._element.style.width=e+Z_),eo(t)&&(this._element.style.height=t+Z_)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){eo(e)&&(this._element.style.marginTop=e+Z_),eo(t)&&(this._element.style["margin".concat(kt(this.inlineProperty))]=t+Z_)}},{key:"getOffset",value:function(){var style=this._element.style,e="margin".concat(kt(this.inlineProperty));return{top:style.marginTop?parseInt(style.marginTop,10):0,start:style[e]?parseInt(style[e],10):0}}}])&&J_(t.prototype,n),r&&J_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function tI(e){return tI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tI(e)}function nI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oI(){return oI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=iI(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},oI.apply(this,arguments)}function iI(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=uI(object)););return object}function aI(e,p){return aI=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},aI(e,p)}function lI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uI(e);if(t){var o=uI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sI(this,n)}}function sI(e,t){if(t&&("object"===tI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function uI(e){return uI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uI(e)}var cI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aI(e,t)}(l,e);var t,n,r,o=lI(l);function l(){return nI(this,l),o.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){oI(uI(l.prototype),"build",this).call(this),Gt(this._element,"ht__manualColumnMove--backlight")}}])&&rI(t.prototype,n),r&&rI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(eI),hI=cI;function fI(e){return fI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fI(e)}function dI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yI(){return yI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=gI(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},yI.apply(this,arguments)}function gI(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=wI(object)););return object}function vI(e,p){return vI=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},vI(e,p)}function mI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wI(e);if(t){var o=wI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bI(this,n)}}function bI(e,t){if(t&&("object"===fI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wI(e){return wI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wI(e)}var CI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vI(e,t)}(l,e);var t,n,r,o=mI(l);function l(){return dI(this,l),o.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){yI(wI(l.prototype),"build",this).call(this),Gt(this._element,"ht__manualColumnMove--guideline")}}])&&pI(t.prototype,n),r&&pI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(eI),SI=CI;function kI(e){return kI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kI(e)}function OI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function RI(){return RI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=EI(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},RI.apply(this,arguments)}function EI(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=PI(object)););return object}function TI(e,p){return TI=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},TI(e,p)}function AI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=PI(e);if(t){var o=PI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xI(this,n)}}function xI(e,t){if(t&&("object"===kI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return MI(e)}function MI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PI(e){return PI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},PI(e)}dr.getSingleton().register("beforeColumnMove"),dr.getSingleton().register("afterColumnMove");var _I="manualColumnMove",II=new WeakMap,HI="ht__manualColumnMove",jI="show-ui",DI="on-moving--columns",NI="after-selection--columns",LI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TI(e,t)}(l,e);var t,n,r,o=AI(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=o.call(this,e),II.set(MI(t),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),t.eventManager=new Hr(MI(t)),t.backlight=new hI(e),t.guideline=new SI(e),t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollVertically",(function(){return e.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.buildPluginUI(),this.registerEvents(),Gt(this.hot.rootElement,HI),RI(PI(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),RI(PI(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Yt(this.hot.rootElement,HI),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),RI(PI(l.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(e,t){return this.moveColumns([e],t)}},{key:"moveColumns",value:function(e,t){var n=II.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),l=this.hot.runHooks("beforeColumnMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==l){o&&this.hot.columnIndexMapper.moveIndexes(e,t);var c=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,o,c),c}}},{key:"dragColumn",value:function(e,t){return this.dragColumns([e],t)}},{key:"dragColumns",value:function(e,t){var n=this.countFinalIndex(e,t);return II.get(this).cachedDropIndex=t,this.moveColumns(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,l=e.some((function(e){return e<0})),c=e.some((function(e){return e>=n}));return!(r||o||l||c)}},{key:"isColumnOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=Y(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getColumnsWidth",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=0,o=e;o<=t;o+=1){var l=n.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==l&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(l)||0)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualColumnMove;if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}},{key:"isFixedColumnsStart",value:function(e){return e<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}},{key:"prepareColumnsToMoving",value:function(e,t){var n=[];return no(e,t,(function(i){n.push(i)})),n}},{key:"refreshPositions",value:function(){var e=II.get(this),t=this.hot.view._wt.wtTable.getFirstVisibleColumn(),n=this.hot.view._wt.wtTable.getLastVisibleColumn(),r=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,l="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,c=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1),h=r.hider.offsetWidth,f=r.TBODY.offsetLeft,d=this.backlight.getOffset().start,y=this.backlight.getSize().width,v=0,m=0;if(this.hot.isRtl()){var w=this.hot.rootWindow,C=hn(this.hot.rootElement),S=w.innerWidth-e.rootElementOffset-C;m=w.innerWidth-e.target.eventPageX-S-(void 0===o.scrollX?l:0)}else m=e.target.eventPageX-(e.rootElementOffset-(void 0===o.scrollX?l:0));if(e.hasRowHeaders&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(c+=l),c+=v,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+c<=m){var k=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=k+1,c+=e.target.TD.offsetWidth,e.target.col>n&&n<e.countCols&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else e.target.col=e.hoveredColumn,e.target.col<=t&&e.target.col>=e.fixedColumnsStart&&t>0&&this.hot.scrollViewportTo(void 0,t-1);e.target.col<=t&&e.target.col>=e.fixedColumnsStart&&t>0&&this.hot.scrollViewportTo(void 0,t-1);var O=m,R=c;m+y+d>=h?O=h-y-d:m+d<f+v&&(O=f+v+Math.abs(d)),c>=h-1?R=h-1:0===R?R=1:void 0!==o.scrollX&&e.hoveredColumn<e.fixedColumnsStart&&(R-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,O),this.guideline.setPosition(null,R)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view._wt.wtTable,l=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),h=II.get(this),f=zt(e.target,"sortAction");if(!c||!l||h.pressed||0!==e.button||f)return h.pressed=!1,h.columnsToMove.length=0,void Yt(this.hot.rootElement,[DI,jI]);var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&y&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var v=c.from,m=c.to,w=Math.min(v.col,m.col),C=Math.max(v.col,m.col);if(t.row<0&&t.col>=w&&t.col<=C){r.column=!0,h.pressed=!0,h.target.eventPageX=e.pageX,h.target.eventOffsetX=e.offsetX,h.hoveredColumn=t.col,h.target.TD=n,h.target.col=t.col,h.columnsToMove=this.prepareColumnsToMoving(w,C),h.hasRowHeaders=!!this.hot.getSettings().rowHeaders,h.countCols=this.hot.countCols(),h.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,h.rootElementOffset=en(this.hot.rootElement).left;var S=h.hasRowHeaders?-1:0,k=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,O=t.col<h.fixedColumnsStart,R=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),E=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),T=this.getColumnsWidth(w,t.col-1)+E,A=this.getColumnsWidth(S,w-1)+(O?R:0)+T;this.backlight.setPosition(k,A),this.backlight.setSize(this.getColumnsWidth(w,C),o.hider.offsetHeight-k),this.backlight.setOffset(null,-T),Gt(this.hot.rootElement,DI)}else Yt(this.hot.rootElement,NI),h.pressed=!1,h.columnsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=II.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}t.target.eventPageX=e.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),l=II.get(this);o&&l.pressed&&(l.columnsToMove.indexOf(t.col)>-1?Yt(this.hot.rootElement,jI):Gt(this.hot.rootElement,jI),r.row=!0,r.column=!0,r.cell=!0,l.hoveredColumn=t.col,l.target.TD=n)}},{key:"onMouseUp",value:function(){var e=II.get(this),t=e.target.col,n=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,Yt(this.hot.rootElement,[DI,jI,NI]),this.hot.selection.isSelectedByColumnHeader()&&Gt(this.hot.rootElement,NI),!(n<1||void 0===t)){var r=e.columnsToMove[0],o=this.hot.toPhysicalColumn(r),l=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,!0===l){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(o),h=c+n-1;this.hot.selectColumns(c,h)}}}},{key:"onAfterScrollVertically",value:function(){var e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;this.backlight.setPosition(t),this.backlight.setSize(null,e.hider.offsetHeight-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),RI(PI(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return _I}},{key:"PLUGIN_PRIORITY",get:function(){return 120}}],n&&OI(t.prototype,n),r&&OI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function BI(e){return BI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BI(e)}function VI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FI(){return FI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=WI(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},FI.apply(this,arguments)}function WI(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=KI(object)););return object}function UI(e,p){return UI=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},UI(e,p)}function zI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KI(e);if(t){var o=KI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GI(this,n)}}function GI(e,t){if(t&&("object"===BI(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return YI(e)}function YI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KI(e){return KI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},KI(e)}var XI="manualColumnResize",$I="manualColumnWidths",qI=new WeakMap,QI=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UI(e,t)}(l,e);var t,n,r,o=zI(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var n=(t=o.call(this,e)).hot.rootDocument;return t.currentTH=null,t.currentCol=null,t.selectedCols=[],t.currentWidth=null,t.newSize=null,t.startY=null,t.startWidth=null,t.startOffset=null,t.handle=n.createElement("DIV"),t.guide=n.createElement("DIV"),t.eventManager=new Hr(YI(t)),t.pressed=null,t.dblclick=0,t.autoresizeTimeout=null,t.columnWidthsMap=void 0,qI.set(YI(t),{config:void 0}),Gt(t.handle,"manualColumnResizer"),Gt(t.guide,"manualColumnResizerGuide"),t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return XI}},{key:"PLUGIN_PRIORITY",get:function(){return 130}}],(n=[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnWidthsMap=new uh,this.columnWidthsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(t,col){return e.onModifyColWidth(t,col)})),this.addHook("beforeStretchingColumnWidth",(function(t,n){return e.onBeforeStretchingColumnWidth(t,n)})),this.addHook("beforeColumnResize",(function(t,n,r){return e.onBeforeColumnResize(t,n,r)})),this.bindEvents(),FI(KI(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),FI(KI(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){qI.get(this).config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),FI(KI(l.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",$I,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",$I,e),e.value}},{key:"setManualSize",value:function(e,t){var n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(r,n),n}},{key:"clearManualSize",value:function(e){var t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}},{key:"onMapInit",value:function(){var e=this,t=qI.get(this),n=this.hot.getSettings().manualColumnResize,r=this.loadManualColumnWidths();void 0!==r?this.hot.batchExecution((function(){r.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0),t.config=n):!0===n&&Array.isArray(t.config)&&this.hot.batchExecution((function(){t.config.forEach((function(t,n){e.columnWidthsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"setupHandlePosition",value:function(e){var t=this;if(e.parentNode){this.currentTH=e;var n=this.hot.view._wt,r=n.wtTable.getCoords(this.currentTH),col=r.col;if(!(col<0)){var o,l=fn(this.currentTH),c=this.currentTH.getBoundingClientRect();col<n.getSetting("fixedColumnsStart")&&(o=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),o||(o=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(col),this.selectedCols=[];var h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();this.hot.selection.isSelected()&&h&&$(this.hot.getSelectedRange(),(function(e){no(e.getTopStartCorner().col,e.getBottomEndCorner().col,(function(e){t.selectedCols.includes(e)||t.selectedCols.push(e)}))})),this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=o.start-6,this.startWidth=parseInt(c.width,10),this.handle.style.top="".concat(o.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(fn(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Gt(this.handle,"active"),Gt(this.guide,"active"),this.guide.style.top="".concat(t,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Yt(this.handle,"active"),Yt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(element){return!!Dt(element,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}},{key:"onMouseOver",value:function(e){if(!_n(e.target)&&this.checkIfColumnHeader(e.target)){var th=this.getClosestTHParent(e.target);if(!th)return;var t=th.getAttribute("colspan");!th||null!==t&&"1"!==t||this.pressed||this.setupHandlePosition(th)}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeColumnResize",e.newSize,n,!0);void 0!==o&&(e.newSize=o),"all"===e.hot.getSettings().stretchH?e.clearManualSize(n):e.setManualSize(n,e.newSize),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!0),r&&t()};this.dblclick>=2&&(this.selectedCols.length>1?($(this.selectedCols,(function(e){n(e)})),t()):$(this.selectedCols,(function(e){n(e,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;zt(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(e){var t=this;if(this.pressed){var n=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+n,$(this.selectedCols,(function(e){t.newSize=t.setManualSize(e,t.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeColumnResize",e.newSize,n,!1),r&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?($(this.selectedCols,(function(e){n(e)})),t()):$(this.selectedCols,(function(e){n(e,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootWindow,r=t.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(r,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(n,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(n,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyColWidth",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalColumn(t),o=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings().manualColumnResize&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){var n=this.columnWidthsMap.getValueAtIndex(t);return null===n&&(n=e),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){FI(KI(l.prototype),"destroy",this).call(this)}}])&&VI(t.prototype,n),r&&VI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function JI(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ZI="px",eH=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this._element=null,this.state=0}var t,n,r;return t=e,(n=[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=2}},{key:"build",value:function(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(e,t){void 0!==e&&(this._element.style.top=e+ZI),void 0!==t&&(this._element.style.left=t+ZI)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){e&&(this._element.style.width=e+ZI),t&&(this._element.style.height=t+ZI)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){e&&(this._element.style.marginTop=e+ZI),t&&(this._element.style.marginLeft=t+ZI)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&JI(t.prototype,n),r&&JI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function tH(e){return tH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tH(e)}function nH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oH(){return oH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=iH(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},oH.apply(this,arguments)}function iH(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=uH(object)););return object}function aH(e,p){return aH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},aH(e,p)}function lH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uH(e);if(t){var o=uH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sH(this,n)}}function sH(e,t){if(t&&("object"===tH(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function uH(e){return uH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uH(e)}var cH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aH(e,t)}(l,e);var t,n,r,o=lH(l);function l(){return nH(this,l),o.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){oH(uH(l.prototype),"build",this).call(this),Gt(this._element,"ht__manualRowMove--backlight")}}])&&rH(t.prototype,n),r&&rH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(eH),hH=cH;function fH(e){return fH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fH(e)}function dH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yH(){return yH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=gH(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},yH.apply(this,arguments)}function gH(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=wH(object)););return object}function vH(e,p){return vH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},vH(e,p)}function mH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wH(e);if(t){var o=wH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bH(this,n)}}function bH(e,t){if(t&&("object"===fH(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wH(e){return wH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wH(e)}var CH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vH(e,t)}(l,e);var t,n,r,o=mH(l);function l(){return dH(this,l),o.apply(this,arguments)}return t=l,(n=[{key:"build",value:function(){yH(wH(l.prototype),"build",this).call(this),Gt(this._element,"ht__manualRowMove--guideline")}}])&&pH(t.prototype,n),r&&pH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(eH),SH=CH;function kH(e){return kH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kH(e)}function OH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function RH(){return RH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=EH(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},RH.apply(this,arguments)}function EH(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=PH(object)););return object}function TH(e,p){return TH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},TH(e,p)}function AH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=PH(e);if(t){var o=PH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xH(this,n)}}function xH(e,t){if(t&&("object"===kH(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return MH(e)}function MH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PH(e){return PH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},PH(e)}dr.getSingleton().register("beforeRowMove"),dr.getSingleton().register("afterRowMove");var _H="manualRowMove",IH=new WeakMap,HH="ht__manualRowMove",jH="show-ui",DH="on-moving--rows",NH="after-selection--rows",LH=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TH(e,t)}(l,e);var t,n,r,o=AH(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=o.call(this,e),IH.set(MH(t),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),t.eventManager=new Hr(MH(t)),t.backlight=new hH(e),t.guideline=new SH(e),t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterScrollHorizontally",(function(){return e.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.buildPluginUI(),this.registerEvents(),Gt(this.hot.rootElement,HH),RH(PH(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),RH(PH(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Yt(this.hot.rootElement,HH),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),RH(PH(l.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(e,t){return this.moveRows([e],t)}},{key:"moveRows",value:function(e,t){var n=IH.get(this),r=n.cachedDropIndex,o=this.isMovePossible(e,t),l=this.hot.runHooks("beforeRowMove",e,t,r,o);if(n.cachedDropIndex=void 0,!1!==l){o&&this.hot.rowIndexMapper.moveIndexes(e,t);var c=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,o,c),c}}},{key:"dragRow",value:function(e,t){return this.dragRows([e],t)}},{key:"dragRows",value:function(e,t){var n=this.countFinalIndex(e,t);return IH.get(this).cachedDropIndex=t,this.moveRows(e,n)}},{key:"isMovePossible",value:function(e,t){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,o=t<0,l=e.some((function(e){return e<0})),c=e.some((function(e){return e>=n}));return!(r||o||l||c)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}},{key:"countFinalIndex",value:function(e,t){var n=Y(e,(function(e,n){return n<t&&(e+=1),e}),0);return t-n}},{key:"getRowsHeight",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=0,o=e;o<=t;o++){var l=n.getRenderableFromVisualIndex(o);null!==l&&(r+=this.hot.view._wt.wtTable.getRowHeight(l)||23)}return r}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}},{key:"isFixedRowTop",value:function(e){return e<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(e){return e>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}},{key:"prepareRowsToMoving",value:function(){var e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;var n=e.from,r=e.to;return no(Math.min(n.row,r.row),Math.max(n.row,r.row),(function(i){t.push(i)})),t}},{key:"refreshPositions",value:function(){var e=IH.get(this),t=e.target.coords,n=this.hot.view._wt.wtTable.getFirstVisibleRow(),r=this.hot.view._wt.wtTable.getLastVisibleRow(),o=this.hot.getSettings().fixedRowsTop,l=this.hot.countRows();t.row<o&&n>0&&this.hot.scrollViewportTo(n-1),t.row>=r&&r<l&&this.hot.scrollViewportTo(r+1,void 0,!0);var c=this.hot.view._wt.wtTable,h=e.target.TD,f=en(this.hot.rootElement),d=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),y=e.target.eventPageY-f.top+c.holder.scrollTop,v=c.hider.offsetHeight,m=c.TBODY.offsetTop,w=this.backlight.getOffset().top,C=this.backlight.getSize().height;this.isFixedRowTop(t.row)&&(d+=c.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:h.offsetHeight/2+d<=y?(e.target.row=t.row+1,d+=0===t.row?h.offsetHeight-1:h.offsetHeight):e.target.row=t.row;var S=y,k=d;y+C+w>=v?S=v-C-w:y+w<m&&(S=m+Math.abs(w)),d>=v-1&&(k=v-1);var O=0;this.hot.view._wt.wtOverlays.topOverlay&&(O=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),t.row>=o&&k-c.holder.scrollTop<O&&this.hot.scrollViewportTo(t.row),this.backlight.setPosition(S),this.guideline.setPosition(k)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){var o=this.hot.view._wt,l=o.wtTable,c=o.wtViewport,h=this.hot.selection.isSelectedByRowHeader(),f=this.hot.getSelectedRangeLast(),d=IH.get(this);if(!f||!h||d.pressed||0!==e.button)return d.pressed=!1,d.rowsToMove.length=0,void Yt(this.hot.rootElement,[DH,jH]);var y=this.guideline.isBuilt()&&!this.guideline.isAppended(),v=this.backlight.isBuilt()&&!this.backlight.isAppended();y&&v&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var m=f.from,w=f.to,C=Math.min(m.row,w.row),S=Math.max(m.row,w.row);if(t.col<0&&t.row>=C&&t.row<=S){r.row=!0,d.pressed=!0,d.target.eventPageY=e.pageY,d.target.coords=t,d.target.TD=n,d.rowsToMove=this.prepareRowsToMoving();var k=l.holder.scrollLeft+c.getRowHeaderWidth();this.backlight.setPosition(null,k),this.backlight.setSize(l.hider.offsetWidth-k,this.getRowsHeight(C,S)),this.backlight.setOffset(-1*(this.getRowsHeight(C,t.row-1)+e.offsetY),null),Gt(this.hot.rootElement,DH),this.refreshPositions()}else Yt(this.hot.rootElement,NH),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=IH.get(this);if(t.pressed){if(e.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}t.target.eventPageY=e.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o=this.hot.getSelectedRangeLast(),l=IH.get(this);o&&l.pressed&&(l.rowsToMove.indexOf(t.row)>-1?Yt(this.hot.rootElement,jH):Gt(this.hot.rootElement,jH),r.row=!0,r.column=!0,r.cell=!0,l.target.coords=t,l.target.TD=n)}},{key:"onMouseUp",value:function(){var e=IH.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,Yt(this.hot.rootElement,[DH,jH,NH]),this.hot.selection.isSelectedByRowHeader()&&Gt(this.hot.rootElement,NH),!(n<1||void 0===t)){var r=e.rowsToMove[0],o=this.hot.toPhysicalRow(r),l=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,!0===l){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualRow(o),h=c+n-1;this.hot.selectRows(c,h)}}}},{key:"onAfterScrollHorizontally",value:function(){var e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;this.backlight.setPosition(null,t),this.backlight.setSize(e.hider.offsetWidth-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),RH(PH(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return _H}},{key:"PLUGIN_PRIORITY",get:function(){return 140}}],n&&OH(t.prototype,n),r&&OH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function BH(e){return BH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BH(e)}function VH(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FH(){return FH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=WH(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},FH.apply(this,arguments)}function WH(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=KH(object)););return object}function UH(e,p){return UH=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},UH(e,p)}function zH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=KH(e);if(t){var o=KH(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GH(this,n)}}function GH(e,t){if(t&&("object"===BH(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return YH(e)}function YH(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KH(e){return KH=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},KH(e)}var XH,$H,qH,QH,JH="manualRowResize",ZH="manualRowHeights",ej=new WeakMap,tj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UH(e,t)}(l,e);var t,n,r,o=zH(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var n=(t=o.call(this,e)).hot.rootDocument;return t.currentTH=null,t.currentRow=null,t.selectedRows=[],t.currentHeight=null,t.newSize=null,t.startY=null,t.startHeight=null,t.startOffset=null,t.handle=n.createElement("DIV"),t.guide=n.createElement("DIV"),t.eventManager=new Hr(YH(t)),t.pressed=null,t.dblclick=0,t.autoresizeTimeout=null,t.rowHeightsMap=void 0,ej.set(YH(t),{config:void 0}),Gt(t.handle,"manualRowResizer"),Gt(t.guide,"manualRowResizerGuide"),t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return JH}},{key:"PLUGIN_PRIORITY",get:function(){return 30}}],(n=[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.rowHeightsMap=new uh,this.rowHeightsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(t,n){return e.onModifyRowHeight(t,n)})),this.bindEvents(),FH(KH(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),FH(KH(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ej.get(this).config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),FH(KH(l.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",ZH,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",ZH,e),e.value}},{key:"setManualSize",value:function(e,t){var n=this.hot.toPhysicalRow(e),r=Math.max(t,Ou.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,r),r}},{key:"setupHandlePosition",value:function(e){var t=this;this.currentTH=e;var view=this.hot.view,n=view._wt,r=n.wtTable.getCoords(this.currentTH),o=r.row;if(!(o<0)){var l,c=hn(this.currentTH),h=this.currentTH.getBoundingClientRect(),f=o<n.getSetting("fixedRowsTop"),d=o>=view.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");f?l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col):d&&(l=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),l||(l=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();this.hot.selection.isSelected()&&y&&$(this.hot.getSelectedRange(),(function(e){no(e.getTopStartCorner().row,e.getBottomStartCorner().row,(function(e){t.selectedRows.includes(e)||t.selectedRows.push(e)}))})),this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=l.top-6,this.startHeight=parseInt(h.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(l.start,"px"),this.handle.style.width="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(hn(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Gt(this.handle,"active"),Gt(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(t,"px"),this.guide.style.width="".concat(n-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Yt(this.handle,"active"),Yt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(element){var e,t;return Dt(element,["TH"],this.hot.rootElement)&&"TBODY"===(null===(e=element.parentNode)||void 0===e||null===(t=e.parentNode)||void 0===t?void 0:t.tagName)}},{key:"getClosestTHParent",value:function(element){return"TABLE"!==element.tagName?"TH"===element.tagName?element:this.getClosestTHParent(element.parentNode):null}},{key:"getActualRowHeight",value:function(e){var t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&this.newSize<t?t:this.newSize}},{key:"onMouseOver",value:function(e){if(!_n(e.target)&&this.checkIfRowHeader(e.target)){var th=this.getClosestTHParent(e.target);th&&(this.pressed||this.setupHandlePosition(th))}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!0);void 0!==o&&(e.newSize=o),e.setManualSize(n,e.newSize),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!0),r&&t()};this.dblclick>=2&&(this.selectedRows.length>1?($(this.selectedRows,(function(e){n(e)})),t()):$(this.selectedRows,(function(e){n(e,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;zt(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),$(this.selectedRows,(function(e){t.newSize=t.setManualSize(e,t.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.adjustElementsSize(!0)},n=function(n,r){e.hot.runHooks("beforeRowResize",e.getActualRowHeight(n),n,!1),r&&t(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",e.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?($(this.selectedRows,(function(e){n(e)})),t()):$(this.selectedRows,(function(e){n(e,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var e=this,t=this.hot,n=t.rootElement,r=t.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(n,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(r,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(r,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(e,t){var n=e;if(this.enabled){var r=this.hot.toPhysicalRow(t),o=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings().manualRowResize&&o&&(n=o)}return n}},{key:"onMapInit",value:function(){var e=this,t=ej.get(this),n=this.hot.getSettings().manualRowResize,r=this.loadManualRowHeights();this.hot.batchExecution((function(){void 0!==r?r.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})):Array.isArray(n)?(n.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)})),t.config=n):!0===n&&Array.isArray(t.config)&&t.config.forEach((function(t,n){e.rowHeightsMap.setValueAtIndex(n,t)}))}),!0)}},{key:"destroy",value:function(){FH(KH(l.prototype),"destroy",this).call(this)}}])&&VH(t.prototype,n),r&&VH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function nj(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function rj(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var oj,ij=function(){function e(t,n,r,o,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=t,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1,this.cellCoordsFactory=l,this.cellRangeFactory=c}var t,n,r;return t=e,r=[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return et(XH||(XH=nj(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return et($H||($H=nj(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return et(qH||(qH=nj(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return et(QH||(QH=nj(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}}],(n=[{key:"normalize",value:function(e){var t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,span=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",l=Math.min(t,r),c=Math.max(t,r),h=this[o],f=this[o]+this[span]-1;if(h>=t&&(this[o]+=n),n>0)t<=f&&t>h&&(this[span]+=n);else if(n<0){if(l<=h&&c>=f)return this.removed=!0,!1;if(h>=l&&h<=c){var d=c-h+1,y=Math.abs(n)-d;this[o]-=y+n,this[span]-=d}else if(h<=l&&f>=c)this[span]+=n;else if(h<=l&&f>=l&&f<c){var v=f-l+1;this[span]-=v}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}])&&rj(t.prototype,n),r&&rj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function aj(e,t,n,col){t?t.row===n&&t.col===col?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function lj(e){return function(e){if(Array.isArray(e))return sj(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sj(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sj(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function uj(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var cj=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}var t,n,r;return t=e,n=[{key:"get",value:function(e,t){var n=this.mergedCells,r=!1;return $(n,(function(n){return!(n.row<=e&&n.row+n.rowspan-1>=e&&n.col<=t&&n.col+n.colspan-1>=t&&(r=n,1))})),r}},{key:"getByRange",value:function(e){var t=this.mergedCells,n=!1;return $(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t)})),n}},{key:"getWithinRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCells,o=[],l=e;if(!l.includesRange){var c=this.hot._createCellCoords(l.from.row,l.from.col),h=this.hot._createCellCoords(l.to.row,l.to.col);l=this.hot._createCellRange(c,c,h)}return $(r,(function(e){var r=t.hot._createCellCoords(e.row,e.col),c=t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),h=t.hot._createCellRange(r,r,c);n?l.overlaps(h)&&o.push(e):l.includesRange(h)&&o.push(e)})),!!o.length&&o}},{key:"add",value:function(t){var n=this.mergedCells,r=t.row,o=t.col,l=t.rowspan,c=t.colspan,h=new ij(r,o,l,c,this.hot._createCellCoords,this.hot._createCellRange),f=this.get(r,o),d=this.isOverlapping(h);return f||d?(er(e.IS_OVERLAPPING_WARNING(h)),!1):(this.hot&&h.normalize(this.hot),n.push(h),h)}},{key:"remove",value:function(e,t){var n=this.mergedCells,r=this.get(e,t),o=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,n=[],r=[];$(t,(function(t){var r=e.hot.getCell(t.row,t.col);r&&n.push([r,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,$(n,(function(t,i){no(0,t.rowspan-1,(function(n){no(0,t.colspan-1,(function(o){if(0!==o||0!==n){var l=e.hot.getCell(t.row+n,t.col+o);l&&r.push([l,null,null,null])}}))})),n[i][1]=null})),$(n,(function(e){aj.apply(void 0,lj(e))})),$(r,(function(e){aj.apply(void 0,lj(e))}))}},{key:"isOverlapping",value:function(e){var t=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),r=!1;return $(this.mergedCells,(function(col){return!t.hot._createCellRange(t.hot._createCellCoords(0,0),t.hot._createCellCoords(col.row,col.col),t.hot._createCellCoords(col.row+col.rowspan-1,col.col+col.colspan-1)).overlaps(n)||(r=!0,!1)})),r}},{key:"isFirstRenderableMergedCell",value:function(e,t){var n=this.get(e,t);return n&&this.hot.rowIndexMapper.getFirstNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getFirstNotHiddenIndex(n.col,1)===t}},{key:"getFirstRenderableCoords",value:function(e,t){var n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);var r=this.hot.rowIndexMapper.getFirstNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getFirstNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,o)}},{key:"shiftCollections",value:function(e,t,n){var r=this,o=[0,0];switch(e){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n}$(this.mergedCells,(function(e){e.shift(o,t)})),ro(this.mergedCells.length-1,0,(function(i){var e=r.mergedCells[i];e&&e.removed&&r.mergedCells.splice(r.mergedCells.indexOf(e),1)}))}}],r=[{key:"IS_OVERLAPPING_WARNING",value:function(e){return et(oj||(oj=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),e.row,e.col)}}],n&&uj(t.prototype,n),r&&uj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),hj=cj;function fj(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return dj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dj(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dj(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function pj(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var yj=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var t,n,r;return t=e,n=[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}},{key:"snapDragArea",value:function(e,t,n,r){var o=t.slice(0),l=this.getAutofillSize(e,t,n),c=fj(e,4),h=c[0],f=c[1],d=c[2],y=c[3],v=["up","down"].indexOf(n)>-1?d-h+1:y-f+1,m=l-Math.floor(l/v)*v,w=this.getFarthestCollection(e,t,n,r);if(w)if("down"===n){var C=w.row+w.rowspan-h-m;o[2]+C>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?C:0}else if("right"===n){var S=w.col+w.colspan-f-m;o[3]+S>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?S:0}else if("up"===n){var k=d-m-w.row+1;o[0]+k<0?o[0]+=m:o[0]-=m?k:0}else if("left"===n){var O=y-m-w.col+1;o[1]+O<0?o[1]+=m:o[1]-=m?O:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:l,dragArea:o,cycleLength:v}),o}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),he(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,n){var r=fj(e,4),o=r[0],l=r[1],c=r[2],h=r[3],f=fj(t,4),d=f[0],y=f[1],v=f[2],m=f[3];switch(n){case"up":return o-d;case"down":return v-c;case"left":return l-y;case"right":return m-h;default:return null}}},{key:"getDragArea",value:function(e,t,n){var r=fj(e,4),o=r[0],l=r[1],c=r[2],h=r[3],f=fj(t,4),d=f[0],y=f[1],v=f[2],m=f[3];switch(n){case"up":return[d,y,o-1,h];case"down":return[c+1,l,v,h];case"left":return[d,y,c,l-1];case"right":return[o,h+1,v,m];default:return null}}},{key:"getFarthestCollection",value:function(e,t,n,r){var o=fj(e,4),l=o[0],c=o[1],h=o[2],f=o[3],d=["up","down"].indexOf(n)>-1,y=d?h:f,v=d?l:c,m=this.getAutofillSize(e,t,n),w=d?h-l+1:f-c+1,C=m-Math.floor(m/w)*w,S=null,k=null,O=null;switch(n){case"up":S="includesVertically",O=y-C+1;break;case"left":S="includesHorizontally",O=y-C+1;break;case"down":S="includesVertically",O=v+C-1;break;case"right":S="includesHorizontally",O=v+C-1}return $(r,(function(e){e[S](O)&&e.isFarther(k,n)&&(k=e)})),k}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(e,n){switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}},l=0,c=null,h=1;do{for(var f=0;f<n.length;f+=1){if(o(c=n[f],l=h*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:c.row-l,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:c.row+l,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col-l,colspan:c.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col+l,colspan:c.colspan})}f===n.length-1&&(h+=1)}}while(o(c,l));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,n={min:null,max:null},r={min:null,max:null};return $(e,(function(e){var o=e[0],l=t.plugin.hot.propToCol(e[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||l<r.min)&&(r.min=l),(null===r.max||l>r.max)&&(r.max=l)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,n){var r=fj(this.getDragArea(e,t,n),4),o=r[0],l=r[1],c=r[2],h=r[3],f=this.plugin.hot._createCellCoords(o,l),d=this.plugin.hot._createCellCoords(c,h),y=this.plugin.hot._createCellRange(f,f,d);return!!this.mergedCellsCollection.getWithinRange(y,!0)}}],n&&pj(t.prototype,n),r&&pj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),gj=yj;function vj(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var mj=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var t,n,r;return t=e,(n=[{key:"snapDelta",value:function(e,t,n){var r=t.to,o=r.row+e.row,l=r.col+e.col;e.row?this.jumpOverMergedCell(e,n,o):e.col&&this.jumpOverMergedCell(e,n,l)}},{key:"jumpOverMergedCell",value:function(e,t,n){var r=e.row||e.col,o=null,l=null,c=null;e.row?(o=t.includesVertically(n),l=t.row,c=t.getLastRow()):e.col&&(o=t.includesHorizontally(n),l=t.col,c=t.getLastColumn()),0!==r&&(r>0?o&&n!==l&&(r+=c-n+1):o&&n!==c&&(r-=n-l+1),e.row?e.row=r:e.col&&(e.col=r))}},{key:"getUpdatedSelectionRange",value:function(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,n,r){var o=Math.min(n[0],n[2]),l=Math.min(n[1],n[3]),c=Math.max(n[0],n[2]),h=Math.max(n[1],n[3]);if(void 0!==r&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t)){var f=this.plugin.mergedCellsCollection.get(e,t);if(f){var d=f.getLastRow(),y=f.getLastColumn();return o<=f.row&&l<=f.col&&c>=d&&h>=y?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}},{key:"isMergeCellFullySelected",value:function(e,t){var n=[];if(!t||!e)return!1;for(var r=0;r<e.rowspan;r+=1)for(var o=0;o<e.colspan;o+=1)n.push(this.hot._createCellCoords(e.row+r,e.col+o));for(var i=0;i<n.length;i+=1){for(var l=[],s=0;s<t.length;s+=1)l[s]=t[s].includes(n[i]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],i=0;i<=7;i+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(i));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}])&&vj(t.prototype,n),r&&vj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function bj(e){return bj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bj(e)}function wj(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||Sj(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cj(e){return function(e){if(Array.isArray(e))return kj(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Sj(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sj(e,t){if(e){if("string"==typeof e)return kj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kj(e,t):void 0}}function kj(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Oj(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rj(){return Rj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Ej(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Rj.apply(this,arguments)}function Ej(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Pj(object)););return object}function Tj(e,p){return Tj=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Tj(e,p)}function Aj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pj(e);if(t){var o=Pj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xj(this,n)}}function xj(e,t){if(t&&("object"===bj(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Mj(e)}function Mj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pj(e){return Pj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pj(e)}dr.getSingleton().register("beforeMergeCells"),dr.getSingleton().register("afterMergeCells"),dr.getSingleton().register("beforeUnmergeCells"),dr.getSingleton().register("afterUnmergeCells");var _j,Ij="mergeCells",Hj=new WeakMap,jj=Ij,Dj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tj(e,t)}(l,e);var t,n,r,o=Aj(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=o.call(this,e),Hj.set(Mj(t),{lastDesiredCoords:null}),t.mergedCellsCollection=null,t.autofillCalculations=null,t.selectionCalculations=null,t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new hj(this),this.autofillCalculations=new gj(this),this.selectionCalculations=new mj(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),this.addHook("beforeUndoStackChange",(function(e,source){if("MergeCells"===source)return!1})),this.registerShortcuts(),Rj(Pj(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Rj(Pj(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),Rj(Pj(l.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(ij.containsNegativeValues(e)?(er(ij.NEGATIVE_VALUES_WARNING(e)),t=!1):ij.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(er(ij.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):ij.isSingleCell(e)?(er(ij.IS_SINGLE_CELL(e)),t=!1):ij.containsZeroSpan(e)&&(er(ij.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var n,r=[];$(e,(function(e){if(t.validateSetting(e)){var n=t.hot._createCellCoords(e.row,e.col),o=t.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),l=t.hot._createCellRange(n,n,o);r.push(t.mergeRange(l,!0,!0))}})),r=r.filter((function(e){return!0!==e}));var o=this.getBulkCollectionData(r);(n=this.hot).populateFromArray.apply(n,Cj(o))}}},{key:"getBulkCollectionData",value:function(e){var t,n=this.getBulkCollectionDataRange(e),r=(t=this.hot).getData.apply(t,Cj(n)).splice(0);return $(e,(function(e){var t=wj(e,3),o=t[0],l=t[1];$(t[2],(function(e,t){$(e,(function(e,c){r[o-n[0]+t][l-n[1]+c]=e}))}))})),[n[0],n[1],r]}},{key:"getBulkCollectionDataRange",value:function(e){var t=[0,0],n=[0,0],r=null,o=null,l=null;return $(e,(function(e){r=e[0],o=e[1],l=e[2],t[0]=Math.min(r,t[0]),t[1]=Math.min(o,t[1]),n[0]=Math.max(r+l.length-1,n[0]),n[1]=Math.max(o+l[0].length-1,n[1])})),[].concat(t,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,n=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.getTopStartCorner(),l=e.getBottomEndCorner(),c={row:o.row,col:o.col,rowspan:l.row-o.row+1,colspan:l.col-o.col+1},h=[],f=null;if(!this.canMergeRange(c,n))return!1;this.hot.runHooks("beforeMergeCells",e,n),no(0,c.rowspan-1,(function(i){no(0,c.colspan-1,(function(e){var n=null;h[i]||(h[i]=[]),0===i&&0===e?n=t.hot.getDataAtCell(c.row,c.col):t.hot.setCellMeta(c.row+i,c.col+e,"hidden",!0),h[i][e]=n}))})),this.hot.setCellMeta(c.row,c.col,"spanned",!0);var d=this.mergedCellsCollection.add(c);return!d||(r?f=[c.row,c.col,h]:this.hot.populateFromArray(c.row,c.col,h,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,c,n),f)}},{key:"unmergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),$(r,(function(e){t.mergedCellsCollection.remove(e.row,e.col),no(0,e.rowspan-1,(function(i){no(0,e.colspan-1,(function(n){t.hot.removeCellMeta(e.row+i,e.col+n,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,n,r){var o=this.hot._createCellCoords(e,t),l=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(o,o,l))}},{key:"unmerge",value:function(e,t,n,r){var o=this.hot._createCellCoords(e,t),l=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(o,o,l))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"registerShortcuts",value:function(){var e=this;this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:function(){e.toggleMerge(e.hot.getSelectedRangeLast()),e.hot.render()},runOnlyIf:function(e){return!e.altKey},group:jj})}},{key:"unregisterShortcuts",value:function(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jj)}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<t.length;r+=1)if(n.from.row===t[r].row&&n.from.col===t[r].col&&n.to.row===t[r].row+t[r].rowspan-1&&n.to.col===t[r].col+t[r].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t,n=Hj.get(this),r=this.hot.getSelectedRangeLast(),o={row:e.row,col:e.col},l=this.hot._createCellCoords(r.highlight.row,r.highlight.col),c=this.mergedCellsCollection.get(l.row,l.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=this.hot._createCellCoords(null,null)),c){var h=this.hot._createCellCoords(c.row,c.col),f=this.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1);this.hot._createCellRange(h,h,f).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=this.hot._createCellCoords(null,null)),o.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-l.row:o.row,o.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-l.col:o.col,e.row>0?o.row=c.row+c.rowspan-1-l.row+e.row:e.row<0&&(o.row=l.row-c.row+e.row),e.col>0?o.col=c.col+c.colspan-1-l.col+e.col:e.col<0&&(o.col=l.col-c.col+e.col)}t=this.hot._createCellCoords(r.highlight.row+o.row,r.highlight.col+o.col);var d=this.mergedCellsCollection.get(t.row,t.col);if(d){var y=this.mergedCellsCollection.getFirstRenderableCoords(d.row,d.col);n.lastDesiredCoords=t,o={row:y.row-l.row,col:y.col-l.col}}0!==o.row&&(e.row=o.row),0!==o.col&&(e.col=o.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,n=this.hot.getSelectedRangeLast(),r=pe(e),o=this.selectionCalculations.getUpdatedSelectionRange(n,e),l=pe(r),c=this.mergedCellsCollection.getWithinRange(o,!0);do{l=pe(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),$(c,(function(e){t.selectionCalculations.snapDelta(r,n,e)}))}while(r.row!==l.row||r.col!==l.col);e.row=r.row,e.col=r.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var n=this.mergedCellsCollection.get(e,t);if(n){var r=n.row,o=n.col,l=n.colspan;return[r,o,r+n.rowspan-1,o+l-1]}}}},{key:"addMergeActionsToContextMenu",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Gf)}return this.getTranslatedPhrase(zf)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();return!e||ij.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(e,t,col){var n=this.mergedCellsCollection.get(t,col),r=ve(n)?pe(n):void 0;if(ve(r)){var o=this.hot,l=o.rowIndexMapper,c=o.columnIndexMapper,h=r.row,f=r.col,d=r.colspan,y=r.rowspan,v=wj(this.translateMergedCellToRenderable(h,y,f,d),2),m=v[0],w=v[1],C=m-l.getRenderableFromVisualIndex(t)+1,S=w-c.getRenderableFromVisualIndex(col)+1;r.row=l.getFirstNotHiddenIndex(r.row,1),r.col=c.getFirstNotHiddenIndex(r.col,1),r.rowspan=Math.min(r.rowspan,C),r.colspan=Math.min(r.colspan,S)}aj(e,r,t,col)}},{key:"onBeforeSetRangeStart",value:function(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){var t=this.mergedCellsCollection.get(e.row,e.col),n=[t.row,t.col];e.row=n[0],e.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1){var r=this.mergedCellsCollection.mergedCells[i].getRange();t.expandByRange(r)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(e,col,t){var n=this.mergedCellsCollection.get(e,col);n&&(n.row!==e||n.col!==col?t.copyable=!1:(t.rowspan=n.rowspan,t.colspan=n.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow),o=0;o<t;o+=1){var l=this.mergedCellsCollection.get(r,o);if(ve(l)){var c=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(l.row,1));if(c<e.startRow)return e.startRow=c,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow),o=0;o<t;o+=1){var l=this.mergedCellsCollection.get(r,o);if(ve(l)){var c=l.row+l.rowspan-1,h=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(c,-1));if(h>e.endRow)return e.endRow=h,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn),o=0;o<t;o+=1){var l=this.mergedCellsCollection.get(o,r);if(ve(l)){var c=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(l.col,1));if(c<e.startColumn)return e.startColumn=c,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn),o=0;o<t;o+=1){var l=this.mergedCellsCollection.get(o,r);if(ve(l)){var c=l.col+l.colspan-1,h=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(c,-1));if(h>e.endColumn)return e.endColumn=h,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,n,r){var o,l,c=this.hot,h=c.rowIndexMapper,f=c.columnIndexMapper;return o=0===t?h.getFirstNotHiddenIndex(e,1):h.getFirstNotHiddenIndex(e+t-1,-1),l=0===r?f.getFirstNotHiddenIndex(n,1):f.getFirstNotHiddenIndex(n+r-1,-1),[e>=0?h.getRenderableFromVisualIndex(o):e,n>=0?f.getRenderableFromVisualIndex(l):n]}},{key:"onModifyAutofillRange",value:function(e,select){this.autofillCalculations.correctSelectionAreaSize(select);var t=this.autofillCalculations.getDirection(select,e),n=e;if(this.autofillCalculations.dragAreaOverlapsCollections(select,n,t))return n=select;var r=this.mergedCellsCollection.getWithinRange({from:{row:select[0],col:select[1]},to:{row:select[2],col:select[3]}});return r?n=this.autofillCalculations.snapDragArea(select,n,t,r):n}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,source){"auto"!==source&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,source){"Autofill.fill"===source&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var n=this.hot.getSelectedRangeLast();$(this.mergedCellsCollection.getWithinRange(n),(function(t){n.getBottomEndCorner().row===t.getLastRow()&&n.getBottomEndCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,n){if(this.enabled){var r=this.mergedCellsCollection.get(e.row,e.col);if(r){var o=t>0,l=t<0,c=n<0,h=n>0,f=r.row+r.rowspan-1==this.hot.countRows()-1,d=0===r.row,y=r.col+r.colspan-1==this.hot.countCols()-1,v=0===r.col;(o&&f||l&&d||h&&y||c&&v)&&(e.row=r.row,e.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],r=[{key:"PLUGIN_KEY",get:function(){return Ij}},{key:"PLUGIN_PRIORITY",get:function(){return 150}}],n&&Oj(t.prototype,n),r&&Oj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function Nj(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Lj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lj(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lj(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Bj(){er(et(_j||(_j=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Vj="sort";function Fj(e,t,n){var r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push("".concat(Vj,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),r}function Wj(e){var t=e.className.split(" "),n=new RegExp("^".concat(Vj,"-[0-9]{1,2}$"));return t.filter((function(e){return n.test(e)}))}function Uj(e){return Uj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uj(e)}function zj(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gj(){return Gj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=Yj(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},Gj.apply(this,arguments)}function Yj(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=qj(object)););return object}function Kj(e,p){return Kj=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},Kj(e,p)}function Xj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qj(e);if(t){var o=qj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $j(this,n)}}function $j(e,t){if(t&&("object"===Uj(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qj(e){return qj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qj(e)}var Qj="multiColumnSorting";ek(Qj,(function(e,t){return function(n,r){var o=Nj(n).slice(1),l=Nj(r).slice(1);return function n(r){var c=e[r],h=t[r],f=o[r],d=l[r],y=h.multiColumnSorting,v=(y.compareFunctionFactory?y.compareFunctionFactory:nk(h.type))(c,h,y)(f,d);if(0===v){var m=r+1;if(void 0!==t[m])return n(m)}return v}(0)}}));var Jj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kj(e,t)}(l,e);var t,n,r,o=Xj(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).pluginKey=Qj,t}return t=l,n=[{key:"isEnabled",value:function(){return Gj(qj(l.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&Bj(),Gj(qj(l.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Gj(qj(l.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){Gj(qj(l.prototype),"sort",this).call(this,e)}},{key:"clearSort",value:function(){Gj(qj(l.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Gj(qj(l.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(e){return Gj(qj(l.prototype),"getSortConfig",this).call(this,e)}},{key:"setSortConfig",value:function(e){Gj(qj(l.prototype),"setSortConfig",this).call(this,e)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}},{key:"updateHeaderClasses",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=Gj(qj(l.prototype),"updateHeaderClasses",this)).call.apply(t,[this,e].concat(r)),Yt(e,Wj(e)),!1!==this.enabled&&Gt(e,Fj.apply(void 0,r))}},{key:"onUpdateSettings",value:function(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&Bj(),Gj(qj(l.prototype),"onUpdateSettings",this).call(this,e)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==PS(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,"append"))):this.sort(this.getColumnNextConfig(t.col)))}}],r=[{key:"PLUGIN_KEY",get:function(){return Qj}},{key:"PLUGIN_PRIORITY",get:function(){return 170}}],n&&zj(t.prototype,n),r&&zj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ok);function Zj(e){return Zj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zj(e)}function eD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tD(){return tD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=nD(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},tD.apply(this,arguments)}function nD(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=aD(object)););return object}function rD(e,p){return rD=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},rD(e,p)}function oD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aD(e);if(t){var o=aD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iD(this,n)}}function iD(e,t){if(t&&("object"===Zj(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function aD(e){return aD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},aD(e)}var lD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rD(e,t)}(l,e);var t,n,r,o=oD(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).dragged=[],t.eventManager=null,t.lastSetCell=null,t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return"multipleSelectionHandles"}},{key:"PLUGIN_PRIORITY",get:function(){return 160}}],(n=[{key:"isEnabled",value:function(){return Ve()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Hr(this)),this.registerListeners(),tD(aD(l.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var e=this,t=this,n=this.hot.rootElement;function r(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(e){var n;return zt(e.target,"topSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):zt(e.target,"bottomSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(e){return zt(e.target,"topSelectionHandle-HitArea")?(r.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):zt(e.target,"bottomSelectionHandle-HitArea")?(r.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,l,c,h,f,d=e.hot.rootDocument;if(0!==t.dragged.length){var y=d.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);y&&y!==t.lastSetCell&&("TD"!==y.nodeName&&"TH"!==y.nodeName||(-1===(r=t.hot.getCoords(y)).col&&(r.col=0),l=(o=t.hot.getSelectedRangeLast()).getWidth(),c=o.getHeight(),h=o.getDirection(),1===l&&1===c&&t.hot.selection.setRangeEnd(r),null!==(f=t.getCurrentRangeCoords(o,r,t.touchStartRange.direction,h,t.dragged[0])).start&&t.hot.selection.setRangeStart(f.start),t.hot.selection.setRangeEnd(f.end),t.lastSetCell=y),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(e,t,n,r,o){var l=e.getTopStartCorner(),c=e.getBottomEndCorner(),h=e.getBottomStartCorner(),f=e.getTopEndCorner(),d={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":d="top"===o?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(h.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,l.col)};break;case"SE-NW":"bottom"===o&&(d={start:this.hot._createCellCoords(c.row,t.col),end:this.hot._createCellCoords(t.row,l.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===o?d={start:t,end:h}:d.end=t;break;case"NW-SE":"top"===o?d={start:t,end:c}:d.end=t;break;case"SE-NW":"top"===o?d={start:t,end:l}:d.end=t;break;case"SW-NE":"top"===o?d={start:t,end:f}:d.end=t}break;case"SW-NE":switch(r){case"NW-SE":d="bottom"===o?{start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(h.row,t.col)}:{start:this.hot._createCellCoords(l.row,t.col),end:this.hot._createCellCoords(t.row,c.col)};break;case"SW-NE":d="top"===o?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,c.col)}:{start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(l.row,t.col)};break;case"SE-NW":"bottom"===o?d={start:this.hot._createCellCoords(t.row,f.col),end:this.hot._createCellCoords(l.row,t.col)}:"top"===o&&(d={start:h,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(d.end=t);break;case"SE-NW":"top"===o?d.end=t:d={start:t,end:l}}}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}])&&eD(t.prototype,n),r&&eD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function sD(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.label,label=void 0===t?"":t,n=e.colspan,r=void 0===n?1:n,o=e.origColspan,l=void 0===o?1:o,c=e.collapsible,h=void 0!==c&&c,f=e.crossHiddenColumns,d=void 0===f?[]:f,y=e.isCollapsed,v=void 0!==y&&y,m=e.isHidden,w=void 0!==m&&m,C=e.isRoot,S=void 0!==C&&C,k=e.isPlaceholder,O=void 0!==k&&k;return{label:label,colspan:r,origColspan:l,collapsible:h,isCollapsed:v,crossHiddenColumns:d,isHidden:w,isRoot:S,isPlaceholder:O}}function uD(e){return function(e){if(Array.isArray(e))return cD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return cD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cD(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cD(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function hD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===t)return n;$(e,(function(e){var r=[],o=0;n.push(r),$(e,(function(e){var n=sD();if(ve(e)){var label=e.label,l=e.colspan;n.label=ot(label),"number"==typeof l&&l>1&&(n.colspan=l,n.origColspan=l)}else n.label=ot(e);var c=!1;if((o+=n.origColspan)>=t&&(n.colspan=n.origColspan-(o-t),n.origColspan=n.colspan,c=!0),r.push(n),n.colspan>1)for(var i=0;i<n.colspan-1;i++)r.push({label:"",isPlaceholder:!0});return!c}))}));var r=Math.max.apply(Math,uD(X(n,(function(e){return e.length}))));return $(n,(function(e){if(e.length<r){var t=X(new Array(r-e.length),(function(){return sD()}));e.splice.apply(e,[e.length,0].concat(uD(t)))}})),n}var fD=["row","col"];function dD(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function pD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yD(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function gD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vD(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function mD(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,wD(e,t,"get"))}function bD(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,wD(e,t,"set"),n),n}function wD(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var CD=["label","collapsible"],SD=new WeakMap,kD=new WeakMap,OD=new WeakMap,RD=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),vD(this,SD,{writable:!0,value:[]}),vD(this,kD,{writable:!0,value:0}),vD(this,OD,{writable:!0,value:1/0})}var t,n,r;return t=e,n=[{key:"setColumnsLimit",value:function(e){bD(this,OD,e)}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];bD(this,SD,hD(e,mD(this,OD))),bD(this,kD,mD(this,SD).length)}},{key:"getData",value:function(){return mD(this,SD)}},{key:"mergeWith",value:function(e){var t=this;$(e,(function(e){var n=e.row,col=e.col,r=yD(e,fD),o=t.getHeaderSettings(n,col);null!==o&&he(o,r,CD)}))}},{key:"map",value:function(e){$(mD(this,SD),(function(header){$(header,(function(t){var n=e(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?dD(Object(source),!0).forEach((function(t){pD(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):dD(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},t));ve(n)&&he(t,n,CD)}))}))}},{key:"getHeaderSettings",value:function(e,t){var n;if(e>=mD(this,kD)||e<0)return null;var r=mD(this,SD)[e];return t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(e>=mD(this,kD)||e<0)return r;for(var o=mD(this,SD)[e],l=0,i=t;i<o.length;i++){var c=o[i];if(c.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(l+=c.colspan,r.push(c),c.colspan>1&&(i+=c.colspan-1),l===n)break;if(l>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}},{key:"getLayersCount",value:function(){return mD(this,kD)}},{key:"getColumnsCount",value:function(){return mD(this,kD)>0?mD(this,SD)[0].length:0}},{key:"clear",value:function(){bD(this,SD,[]),bD(this,kD,0)}}],n&&gD(t.prototype,n),r&&gD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ED(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function TD(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ED(Object(source),!0).forEach((function(t){xD(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ED(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function AD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MD(e){return function(e){if(Array.isArray(e))return PD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return PD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PD(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PD(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var _D=new Map([["DF-pre-order",function e(t,n){for(var r=t.call(n,this),i=0;i<this.childs.length;i++){if(!1===r)return!1;r=e.call(this.childs[i],t,n)}return r}],["DF-post-order",function e(t,n){for(var i=0;i<this.childs.length;i++){if(!1===e.call(this.childs[i],t,n))return!1}return t.call(n,this)}],["BF",function(e,t){var n=[this];!function r(){if(0!==n.length){var o=n.shift();n.push.apply(n,MD(o.childs)),!1!==e.call(t,o)&&r()}}()}]]),ID=function(){function e(data){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),xD(this,"data",{}),xD(this,"parent",null),xD(this,"childs",[]),this.data=data}var t,n,r;return t=e,n=[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new e(TD({},t.data)),i=0;i<t.childs.length;i++)n.addChild(this.cloneTree(t.childs[i]));return n}},{key:"replaceTreeWith",value:function(e){this.data=TD({},e.data),this.childs=[];for(var i=0;i<e.childs.length;i++)this.addChild(e.childs[i])}},{key:"walkDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!_D.has(t))throw new Error('Traversal strategy "'.concat(t,'" does not exist'));_D.get(t).call(this,e,this)}},{key:"walkUp",value:function(e){var t=this;!function n(r){!1!==e.call(t,r)&&null!==r.parent&&n(r.parent)}(this)}}],n&&AD(t.prototype,n),r&&AD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function HD(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function jD(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?HD(Object(source),!0).forEach((function(t){DD(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):HD(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function DD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ND(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||function(e,t){if(!e)return;if("string"==typeof e)return LD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LD(e,t)}(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LD(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function BD(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function VD(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function FD(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,UD(e,t,"get"))}function WD(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,UD(e,t,"set"),n),n}function UD(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var zD,GD,YD=new WeakMap,KD=new WeakMap,XD=new WeakMap,$D=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),VD(this,YD,{writable:!0,value:new Map}),VD(this,KD,{writable:!0,value:new Map}),VD(this,XD,{writable:!0,value:null}),WD(this,XD,t)}var t,n,r;return t=e,n=[{key:"getRoots",value:function(){return Array.from(FD(this,YD).values())}},{key:"getRootByColumn",value:function(e){var t;return FD(this,KD).has(e)&&(t=FD(this,YD).get(FD(this,KD).get(e))),t}},{key:"getNode",value:function(e,t){var n=this.getRootByColumn(t);if(n){var r,o=t-FD(this,KD).get(t),l=0;return n.walkDown((function(t){var n=t.data,c=n.origColspan,h=n.headerLevel;if(e===h){if(o>=l&&o<=l+c-1)return r=t,!1;l+=c}})),r}}},{key:"rebuildTreeIndex",value:function(){var e=this,t=0;FD(this,KD).clear(),$(FD(this,YD),(function(n){for(var r=ND(n,2)[1].data.colspan,i=t;i<t+r;i++)FD(e,KD).set(i,t);t+=r}))}},{key:"buildTree",value:function(){this.clear();for(var e=FD(this,XD).getColumnsCount(),t=0;t<e;){var n=FD(this,XD).getHeaderSettings(0,t),r=new ID;FD(this,YD).set(t,r),this.buildLeaves(r,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=FD(this,XD).getHeadersSettings(n,t,o);n+=1,$(l,(function(o){var l,c=jD(jD({},o),{},{headerLevel:n-1,columnIndex:t});1===n?(e.data=c,l=e):(l=new ID(c),e.addChild(l)),n<FD(r,XD).getLayersCount()&&r.buildLeaves(l,t,n,o.origColspan),t+=o.origColspan}))}},{key:"clear",value:function(){FD(this,YD).clear(),FD(this,KD).clear()}}],n&&BD(t.prototype,n),r&&BD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function qD(e,t){e.walkDown((function(e){var data=e.data,n=e.childs;if(!data.isHidden&&(t(data.columnIndex),0===n.length))for(var i=1;i<data.colspan;i++)t(data.columnIndex+i)}))}function QD(e,t){var n=e.childs;if(0!==n.length)return n[0].data[t]}function JD(e){return QD(e,"origColspan")===e.data.origColspan}function ZD(e){var t=e.data,n=e.childs;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(JD(e))return ZD(n[0]);t.isCollapsed=!1;var r=n.slice(1),o=new Set,l=0;if(r.length>0)$(r,(function(e){e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;var t=e.data;l+=t.colspan,qD(e,(function(e){o.add(e)}))}));else{var c=t.colspan,h=t.origColspan,f=t.columnIndex;l=h-c;for(var i=1;i<h;i++)o.add(f+i)}return e.walkUp((function(e){var data=e.data;data.colspan+=l,data.colspan>=data.origColspan?(data.colspan=data.origColspan,data.isCollapsed=!1):JD(e)&&(data.isCollapsed=QD(e,"isCollapsed"))})),{rollbackModification:function(){return eN(e)},affectedColumns:Array.from(o),colspanCompensation:l}}function eN(e){var t,n=e.data,r=e.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(JD(e))return eN(r[0]);n.isCollapsed=!0;var o=r.slice(1),l=new Set;if(o.length>0)$(o,(function(e){qD(e,(function(e){l.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((function(e){e.data.isHidden=!0}))}));else for(var c=n.origColspan,h=n.columnIndex,i=1;i<c;i++){var f=h+i;l.add(f)}var d=n.colspan-(null!==(t=QD(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((function(e){var data=e.data;data.colspan-=d,data.colspan<=1?(data.colspan=1,data.isCollapsed=!0):JD(e)&&(data.isCollapsed=QD(e,"isCollapsed"))})),{rollbackModification:function(){return ZD(e)},affectedColumns:Array.from(l),colspanCompensation:d}}var tN=new Map([["collapse",eN],["expand",ZD],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(et(zD||(zD=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));if(!e.data.crossHiddenColumns.includes(t)){var n=!1;e.walkUp((function(e){if(e.data.collapsible)return n=!0,!1})),n||e.walkUp((function(e){var data=e.data;data.crossHiddenColumns.push(t),data.colspan>1?data.colspan-=1:data.isHidden=!0}))}}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(et(GD||(GD=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));if(e.data.crossHiddenColumns.includes(t)){var n=!1;e.walkUp((function(e){if(e.data.collapsible)return n=!0,!1})),n||e.walkUp((function(e){var data=e.data;data.crossHiddenColumns.splice(data.crossHiddenColumns.indexOf(t),1),!data.isHidden&&data.colspan<data.origColspan&&(data.colspan+=1),data.isHidden=!1}))}}]]);var nN=["crossHiddenColumns"];function rN(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function oN(e){var t=[];return $(e,(function(e){e.walkDown((function(e){for(var n=e.data,r=n.origColspan,o=n.columnIndex,l=n.headerLevel,c=n.crossHiddenColumns,h=function(e,t){var n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(t,l),f=!1,i=o;i<o+r;i++){if(c.includes(i)||f)h.push({label:"",isPlaceholder:!0});else{var d=iN(n);d.isRoot=!0,h.push(d),f=!0}}}))})),t}function iN(e){var t=sD(e);t.crossHiddenColumns;return rN(t,nN)}var aN=["row"];function lN(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function sN(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?lN(Object(source),!0).forEach((function(t){uN(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):lN(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function uN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cN(source,e){if(null==source)return{};var t,i,n=function(source,e){if(null==source)return{};var t,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||(n[t]=source[t]);return n}(source,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)t=r[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(source,t)&&(n[t]=source[t])}return n}function hN(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fN(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function dN(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,yN(e,t,"set"),n),n}function pN(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,yN(e,t,"get"))}function yN(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var gN=new WeakMap,vN=new WeakMap,mN=new WeakMap,bN=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),fN(this,gN,{writable:!0,value:new RD}),fN(this,vN,{writable:!0,value:new $D(pN(this,gN))}),fN(this,mN,{writable:!0,value:[[]]})}var t,n,r;return t=e,(n=[{key:"setState",value:function(e){pN(this,gN).setData(e);var t=!1;try{pN(this,vN).buildTree()}catch(e){pN(this,vN).clear(),pN(this,gN).clear(),t=!0}return dN(this,mN,oN(pN(this,vN).getRoots())),t}},{key:"setColumnsLimit",value:function(e){pN(this,gN).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var t=this,n=X(e,(function(e){var n=e.row,r=cN(e,aN);return sN({row:n<0?t.rowCoordsToLevel(n):n},r)}));pN(this,gN).mergeWith(n),pN(this,vN).buildTree(),dN(this,mN,oN(pN(this,vN).getRoots()))}},{key:"mapState",value:function(e){pN(this,gN).map(e),pN(this,vN).buildTree(),dN(this,mN,oN(pN(this,vN).getRoots()))}},{key:"mapNodes",value:function(e){return Y(pN(this,vN).getRoots(),(function(t,n){return n.walkDown((function(n){var r=e(n.data);void 0!==r&&t.push(r)})),t}),[])}},{key:"triggerNodeModification",value:function(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));var r,o=pN(this,vN).getNode(t,n);return o&&(r=function(e,t,n){if(!tN.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return tN.get(e)(t,n)}(e,o,n),dN(this,mN,oN(pN(this,vN).getRoots()))),r}},{key:"triggerColumnModification",value:function(e,t){return this.triggerNodeModification(e,-1,t)}},{key:"rowCoordsToLevel",value:function(e){var t=Math.max(this.getLayersCount(),1),n=t-1;return Math.min(Math.max(e+t,0),n)}},{key:"levelToRowCoords",value:function(e){var t=Math.max(this.getLayersCount(),1),n=-t;return Math.min(Math.max(e-t,n),-1)}},{key:"getHeaderSettings",value:function(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),e>=this.getLayersCount()?null:null!==(n=null===(r=pN(this,mN)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(e,t){e<0&&(e=this.rowCoordsToLevel(e));var n=pN(this,vN).getNode(e,t);return n?sN({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(e,t){var n;if((null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0}).isRoot)return t;for(var r=t-1;r>=0;){var o;if((null!==(o=this.getHeaderSettings(e,r))&&void 0!==o?o:{isRoot:!0}).isRoot)break;r-=1}return r}},{key:"getLayersCount",value:function(){return pN(this,gN).getLayersCount()}},{key:"getColumnsCount",value:function(){return pN(this,gN).getColumnsCount()}},{key:"clear",value:function(){dN(this,mN,[]),pN(this,gN).clear(),pN(this,vN).clear()}}])&&hN(t.prototype,n),r&&hN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wN(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function CN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var SN,kN,ON=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),CN(this,"nestedHeaders",void 0),CN(this,"container",void 0),CN(this,"widthsCache",[]),this.nestedHeaders=t}var t,n,r;return t=e,(n=[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsCache.length=0;for(var i=0;i<t;i++)this.widthsCache.push(e[i].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(e){for(var t=this.nestedHeaders.hot.rootDocument,n=t.createDocumentFragment(),table=t.createElement("table"),r=!1,o=!!this.nestedHeaders.hot.getSettings().dropdownMenu,l=this.nestedHeaders.getLayersCount(),c=this.nestedHeaders.hot.countCols(),h=l-1,f=0;f<l;f++){var tr=t.createElement("tr");r=!1;for(var col=0;col<c;col++){var th=t.createElement("th"),d=this.nestedHeaders.getHeaderSettings(f,col);if(d&&!d.isPlaceholder){var label=d.label;f===h&&(d.colspan>1&&(r=!0),o&&(label+='<button class="changeType"></button>')),Qt(th,label),th.colSpan=d.colspan,tr.appendChild(th)}}table.appendChild(tr)}if(r){for(var y=t.createElement("tr"),v=0;v<c;v++){var td=t.createElement("th");y.appendChild(td)}table.appendChild(y)}n.appendChild(table),e.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}])&&wN(t.prototype,n),r&&wN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function RN(e){return RN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RN(e)}function EN(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function TN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AN(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xN(){return xN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=MN(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},xN.apply(this,arguments)}function MN(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=jN(object)););return object}function PN(e,p){return PN=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},PN(e,p)}function _N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jN(e);if(t){var o=jN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return IN(this,n)}}function IN(e,t){if(t&&("object"===RN(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return HN(e)}function HN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jN(e){return jN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jN(e)}function DN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NN(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function LN(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,VN(e,t,"set"),n),n}function BN(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,VN(e,t,"get"))}function VN(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var FN="nestedHeaders",WN=new WeakMap,UN=new WeakMap,zN=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PN(e,t)}(l,e);var t,n,r,o=_N(l);function l(){var e;TN(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return NN(HN(e=o.call.apply(o,[this].concat(n))),WN,{writable:!0,value:new bN}),NN(HN(e),UN,{writable:!0,value:null}),DN(HN(e),"ghostTable",new ON(HN(e))),DN(HN(e),"detectedOverlappedHeaders",!1),e}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().nestedHeaders;Array.isArray(t)&&Array.isArray(t[0])||er(et(SN||(SN=EN(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return e.onAfterOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return e.onBeforeOnCellMouseOver.apply(e,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(t){return e.onAfterGetColumnHeaderRenderers(t)})),this.addHook("modifyColWidth",(function(){return e.onModifyColWidth.apply(e,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return e.onBeforeHighlightingColumnHeader.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),xN(jN(l.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var e=this;if(this.hot.view){var t=this.hot.getSettings().nestedHeaders;BN(this,WN).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=BN(this,WN).setState(t)),this.detectedOverlappedHeaders&&er(et(kN||(kN=EN(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(t,n){var r=!0===t?"hide-column":"show-column";BN(e,WN).triggerColumnModification(r,n)})),!BN(this,UN)&&this.enabled&&LN(this,UN,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(t){t.forEach((function(t){var n=t.op,r=t.index,o=t.newValue;if("replace"===n){var l=!0===o?"hide-column":"show-column";BN(e,WN).triggerColumnModification(l,r)}}))}))),this.ghostTable.buildWidthsMapper(),xN(jN(l.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),BN(this,WN).clear(),BN(this,UN).unsubscribe(),LN(this,UN,null),this.ghostTable.clear(),xN(jN(l.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return BN(this,WN)}},{key:"getLayersCount",value:function(){return BN(this,WN).getLayersCount()}},{key:"getHeaderSettings",value:function(e,t){return BN(this,WN).getHeaderSettings(e,t)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var e=this.hot.view._wt,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=0;i<t;i++){var l=n.childNodes[i];if(!l)break;for(var c=r.childNodes[i],h=o?o.childNodes[i]:null,f=0,d=l.childNodes.length;f<d;f++)l.childNodes[f].removeAttribute("colspan"),Yt(l.childNodes[f],"hiddenHeader"),c&&c.childNodes[f]&&(c.childNodes[f].removeAttribute("colspan"),Yt(c.childNodes[f],"hiddenHeader")),o&&h&&h.childNodes[f]&&(h.childNodes[f].removeAttribute("colspan"),Yt(h.childNodes[f],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(e){var t=this,n=this.hot.view._wt.getSetting("fixedColumnsStart");return function(r,o){var l,c=t.hot,h=c.rootDocument,f=c.columnIndexMapper,view=c.view,d=f.getVisualFromRenderableIndex(r);null===d&&(d=r),o.removeAttribute("colspan"),Yt(o,"hiddenHeader");var y=null!==(l=BN(t,WN).getHeaderSettings(e,d))&&void 0!==l?l:{label:""},v=y.colspan,label=y.label,m=y.isHidden;if(y.isPlaceholder||m)Gt(o,"hiddenHeader");else if(v>1){var w,C,S=view._wt.wtOverlays,k=null===(w=S.topInlineStartCornerOverlay)||void 0===w?void 0:w.clone.wtTable.THEAD.contains(o),O=null===(C=S.inlineStartOverlay)||void 0===C?void 0:C.clone.wtTable.THEAD.contains(o),R=k||O?Math.min(v,n-r):v;R>1&&o.setAttribute("colspan",R)}var E=h.createElement("div"),T=h.createElement("span");Gt(E,"relative"),Gt(T,"colHeader"),Qt(T,label),E.appendChild(T),Xt(o),o.appendChild(E),t.hot.runHooks("afterGetColHeader",d,o)}}},{key:"onBeforeHighlightingColumnHeader",value:function(e,t,n){var r=BN(this,WN).getHeaderTreeNodeData(t,e);if(!r)return e;var o=n.classNames,l=n.columnCursor,c=n.selectionType,h=n.selectionWidth,f=BN(this,WN).getHeaderSettings(t,e),d=f.isRoot,y=f.colspan;if(c===vp){if(!d)return r.columnIndex}else c===dp&&(y>h-l||!d)&&(o.length=0);return e}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){var n=this._getHeaderTreeNodeDataByCoords(t);if(n){var r=this.hot.selection,o=r.isSelected()?r.getSelectedRange().current():null,l=[],c=n.columnIndex,h=n.origColspan,f=!r.inInSelection(t);e.shiftKey&&o?t.col<o.from.col?l.push(o.getTopEndCorner().col,c,t.row):t.col>o.from.col?l.push(o.getTopStartCorner().col,c+h-1,t.row):l.push(c,c+h-1,t.row):(Zn(e)||Jn(e)&&f)&&l.push(c,c+h-1,t.row),r.selectColumns.apply(r,l)}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,n,r){var o;if(this.hot.view.isMouseDown()){var l=this._getHeaderTreeNodeDataByCoords(t);if(l){var c=l.columnIndex,h=l.origColspan,f=this.hot.getSelectedRangeLast(),d=f.getTopStartCorner(),y=f.getBottomEndCorner(),v=f.from;r.column=!0,r.cell=!0;var m=[];t.col<v.col?m.push(y.col,c):t.col>v.col?m.push(d.col,c+h-1):m.push(c,c+h-1),(o=this.hot).selectColumns.apply(o,m)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(e){if(e){e.length=0;for(var t=0;t<BN(this,WN).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){for(var t=BN(this,WN).getLayersCount(),n=e.startColumn,r=!!t,o=0;o<t;o++){var l=BN(this,WN).findLeftMostColumnIndex(o,e.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(l);if(l>=0&&(r=!1),eo(c)&&c<e.startColumn){n=c;break}}e.startColumn=r?BN(this,WN).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(e,t){var n=this.ghostTable.widthsCache[t];return e>n?e:n}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){LN(this,WN,null),null!==BN(this,UN)&&(BN(this,UN).unsubscribe(),LN(this,UN,null)),xN(jN(l.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(e){if(!(e.row>=0||e.col<0))return BN(this,WN).getHeaderTreeNodeData(e.row,e.col)}}],r=[{key:"PLUGIN_KEY",get:function(){return FN}},{key:"PLUGIN_PRIORITY",get:function(){return 280}}],n&&AN(t.prototype,n),r&&AN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function GN(e){return function(e){if(Array.isArray(e))return YN(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return YN(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YN(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YN(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function KN(e){return KN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},KN(e)}function XN(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var $N=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=n,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}var t,n,r;return t=e,n=[{key:"setData",value:function(data){this.data=data}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(data){this.setData(data),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},no(0,this.data.length-1,(function(i){e.cacheNode(e.data[i],0,null)}))}},{key:"cacheNode",value:function(e,t,n){var r=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&$(e.__children,(function(n){r.cacheNode(n,t+1,e)}))}},{key:"getDataObject",value:function(e){return null==e?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,t,n,r){var o=this,l=!1,c=t;if(isNaN(c)&&c.end)return c;var h=e;return h||(h={__children:this.data},l=!0,c-=1),null!=n&&c===n?{result:h,end:!0}:null!=r&&h===r?{result:c,end:!0}:(c+=1,h.__children&&$(h.__children,(function(e){if(o.parentReference.set(e,l?null:h),c=o.readTreeNodes(e,c,n,r),isNaN(c)&&c.end)return!1})),c)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return be(this.data[0],(function(t,n){e[n]=null})),e}},{key:"getRowIndex",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var t=null;t=isNaN(e)?e:this.getDataObject(e);var n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var t=this,n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?($(r.__children,(function(e){n+=1,e.__children&&(n+=t.countChildren(e))})),n):0}},{key:"getRowParent",value:function(e){var t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(e){return e&&"object"===KN(e)?this.cache.nodeInfo.get(e).parent:null}},{key:"getRowLevel",value:function(e){var t=null;return(t=isNaN(e)?e:this.getDataObject(e))?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}},{key:"isChild",value:function(e){return null!==this.getRowParent(e)}},{key:"getChild",value:function(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var t,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}},{key:"addChild",value:function(e,element){var t=element;this.hot.runHooks("beforeAddChild",e,t);var n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);var r=e;e||(r=this.mockParent()),r.__children||(r.__children=[]),t||(t=this.mockNode()),r.__children.push(t),this.rewriteCache();var o=this.getRowIndex(t);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,t)}},{key:"addChildAtIndex",value:function(e,t,element){var n,r=element;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,t),e){var o=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",o,1),e.__children.splice(t,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(o,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",o,1),n=o}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[t]);r=this.getDataObject(n),this.hot.runHooks("afterAddChild",e,r,t)}},{key:"addSibling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(e),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null)}}},{key:"detachFromParent",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],element=null,r=[];Array.isArray(e)?(no(e[0],e[2],(function(i){var e=t.translateTrimmedRow(i);r.push(t.getDataObject(e))})),no(0,r.length-2,(function(i){t.detachFromParent(r[i],!1)})),element=r[r.length-1]):element=e;var o=this.getRowIndex(element),l=this.countChildren(element),c=this.getRowIndexWithinParent(element),h=this.getRowParent(element),f=this.getRowParent(h),d=this.getRowIndex(f),y=null;if(this.hot.runHooks("beforeDetachChild",h,element),null!=c){var v=Array.from(new Array(o+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",o,l+1,v,this.plugin.pluginName),h.__children.splice(c,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,l+1,v,this.plugin.pluginName),f){y=d+this.countChildren(f);var m=this.getChild(f,this.countChildren(f)-1),w=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",w+1,l+1,this.plugin.pluginName),f.__children.push(element)}else y=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",y-2,l+1,this.plugin.pluginName),this.data.push(element)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",y-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",h,element,this.getRowIndex(element)),n&&this.hot.render()}},{key:"filterData",value:function(e,t,n){var r=this,o=[];$(n,(function(e){o.push(r.getDataObject(e))})),$(o,(function(e){var t=r.getRowIndexWithinParent(e),n=r.getRowParent(e);null===n?r.data.splice(t,1):n.__children.splice(t,1)})),this.rewriteCache()}},{key:"spliceData",value:function(e,t,n){var r,o=this.getDataObject(e-1),l=null,c=e;if(o&&o.__children&&0===o.__children.length?(l=o,c=0):e<this.countAllRows()&&(l=this.getRowParent(e),c=this.getRowIndexWithinParent(e)),l)n?(r=l.__children).splice.apply(r,[c,t].concat(GN(n))):l.__children.splice(c,t);else if(n){var h;(h=this.data).splice.apply(h,[c,t].concat(GN(n)))}else this.data.splice(c,t);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var t=e,n=null;do{null!==(n=this.getRowParent(n))&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,t,n,r){var o=t===this.hot.countRows(),l=this.getRowParent(e),c=this.getRowIndexWithinParent(e),h=l.__children.slice(c,c+1),f=e>t,d=o?this.getRowParent(t-1):this.getRowParent(t);null==d&&(d=this.getRowParent(t-1)),null==d&&(d=this.getDataObject(t-1)),d?d.__children||(d.__children=[]):(d=this.getDataObject(t)).__children=[];var y=o||n||r?d.__children.length:this.getRowIndexWithinParent(t),v=l===d;d.__children.splice(y,0,h[0]),l.__children.splice(c+(f&&v?1:0),1),this.syncRowWithRawSource(l),v||this.syncRowWithRawSource(d)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}],n&&XN(t.prototype,n),r&&XN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),qN=$N;function QN(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function JN(e,t,n){return t&&QN(e.prototype,t),n&&QN(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ZN=JN((function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=n,this.plugin=t}));function eL(e){return eL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eL(e)}function tL(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nL(e,p){return nL=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},nL(e,p)}function rL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=iL(e);if(t){var o=iL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oL(this,n)}}function oL(e,t){if(t&&("object"===eL(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function iL(e){return iL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},iL(e)}var aL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nL(e,t)}(l,e);var t,n,r,o=rL(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this,e,t)).dataManager=n.plugin.dataManager,n.collapsingUI=n.plugin.collapsingUI,n.rowHeaderWidthCache=null,n}return t=l,r=[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}],(n=[{key:"appendLevelIndicators",value:function(e,t){var n=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(n),o=this.dataManager.getDataObject(n),c=t.getElementsByTagName("DIV")[0],h=c.querySelector("span.rowHeader");if($(c.querySelectorAll('[class^="ht_nesting"]'),(function(e){e&&c.removeChild(e)})),Gt(t,l.CSS_CLASSES.indicatorContainer),r){var f=this.hot.rootDocument,d=h.cloneNode(!0);c.innerHTML="",no(0,r-1,(function(){var e=f.createElement("SPAN");Gt(e,l.CSS_CLASSES.emptyIndicator),c.appendChild(e)})),c.appendChild(d)}if(this.dataManager.hasChildren(o)){var y=this.hot.rootDocument.createElement("DIV");Gt(t,l.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?Gt(y,"".concat(l.CSS_CLASSES.button," ").concat(l.CSS_CLASSES.expandButton)):Gt(y,"".concat(l.CSS_CLASSES.button," ").concat(l.CSS_CLASSES.collapseButton)),c.appendChild(y)}}},{key:"updateRowHeaderWidth",value:function(e){var t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}])&&tL(t.prototype,n),r&&tL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(ZN);function lL(e){return lL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lL(e)}function sL(e){return function(e){if(Array.isArray(e))return uL(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return uL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uL(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uL(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function cL(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hL(e,p){return hL=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},hL(e,p)}function fL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pL(e);if(t){var o=pL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dL(this,n)}}function dL(e,t){if(t&&("object"===lL(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pL(e){return pL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pL(e)}var yL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hL(e,t)}(l,e);var t,n,r,o=fL(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=o.call(this,e,t)).dataManager=n.plugin.dataManager,n.collapsedRows=[],n.collapsedRowsStash={stash:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),$(n.lastCollapsedRows,(function(o,i){o>=e&&o<t&&(n.lastCollapsedRows[i]=o+r)}))},applyStash:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:function(e,t){no(e,e+t-1,(function(i){var e=n.lastCollapsedRows.indexOf(i);e>-1&&n.lastCollapsedRows.splice(e,1)}))}},n}return t=l,n=[{key:"collapseChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],l=null,c=null,h=null;return isNaN(e)?(l=e,c=this.dataManager.getRowIndex(l)):(l=this.dataManager.getDataObject(e),c=e),this.dataManager.hasChildren(l)&&$(l.__children,(function(e){o.push(t.dataManager.getRowIndex(e))})),h=this.collapseRows(o,!0,!1),r&&this.trimRows(h),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(c)&&this.collapsedRows.push(c),h}},{key:"collapseMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];$(e,(function(e){o.push.apply(o,sL(t.collapseChildren(e,!1,!1)))})),r&&this.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}},{key:"collapseRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return $(e,(function(e){o.push(e),n&&t.collapseChildRows(e,o)})),r&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);$(o.__children,(function(e){var r=t.dataManager.getRowIndex(e);n.push(r),t.collapseChildRows(r,n)}))}r&&this.trimRows(n)}},{key:"expandRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}},{key:"expandRows",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return $(e,(function(e){o.push(e),n&&t.expandChildRows(e,o)})),r&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);$(o.__children,(function(e){if(!t.isAnyParentCollapsed(e)){var r=t.dataManager.getRowIndex(e);n.push(r),t.expandChildRows(r,n)}}))}r&&this.untrimRows(n)}},{key:"expandChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],l=null,c=null,h=null;return isNaN(e)?(l=e,c=this.dataManager.getRowIndex(e)):(l=this.dataManager.getDataObject(e),c=e),this.collapsedRows.splice(this.collapsedRows.indexOf(c),1),this.dataManager.hasChildren(l)&&$(l.__children,(function(e){var n=t.dataManager.getRowIndex(e);o.push(n)})),h=this.expandRows(o,!0,!1),r&&this.untrimRows(h),n&&this.renderAndAdjust(),h}},{key:"expandMultipleChildren",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];$(e,(function(e){o.push.apply(o,sL(t.expandChildren(e,!1,!1)))})),r&&this.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,data=this.dataManager.getData(),t=[];$(data,(function(n){e.dataManager.hasChildren(n)&&t.push(n)})),this.collapseMultipleChildren(t),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,data=this.dataManager.getData(),t=[];$(data,(function(n){e.dataManager.hasChildren(n)&&t.push(n)})),this.expandMultipleChildren(t),this.renderAndAdjust()}},{key:"trimRows",value:function(e){var t=this;this.hot.batchExecution((function(){$(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"untrimRows",value:function(e){var t=this;this.hot.batchExecution((function(){$(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(e){var t=this,n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&$(n.__children,(function(e){var n=t.dataManager.getRowIndex(e);if(!t.plugin.collapsedRowsMap.getValueAtIndex(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(e){for(var t=e;null!==t;){t=this.dataManager.getRowParent(t);var n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(e,t){if(!(t.col>=0)){var n=this.translateTrimmedRow(t.row);zt(e.target,aL.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),qn(e))}}},{key:"translateTrimmedRow",value:function(e){return this.hot.toPhysicalRow(e)}},{key:"untranslateTrimmedRow",value:function(e){return this.hot.toVisualRow(e)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}],n&&cL(t.prototype,n),r&&cL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(ZN),gL=yL;function vL(e){return vL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vL(e)}function mL(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bL(e,p){return bL=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},bL(e,p)}function wL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kL(e);if(t){var o=kL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return CL(this,n)}}function CL(e,t){if(t&&("object"===vL(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return SL(e)}function SL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kL(e){return kL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kL(e)}var OL,RL=new WeakMap,EL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bL(e,t)}(l,e);var t,n,r,o=wL(l);function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=o.call(this,e,t),RL.set(SL(n),{row_above:function(e,t){var r=t[t.length-1];n.dataManager.addSibling(r.start.row,"above")},row_below:function(e,t){var r=t[t.length-1];n.dataManager.addSibling(r.start.row,"below")}}),n.dataManager=n.plugin.dataManager,n}return t=l,(n=[{key:"appendOptions",value:function(e){var t=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(hd)},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),n=t.dataManager.getDataObject(e);t.dataManager.addChild(n)},disabled:function(){var e=t.hot.getSelectedLast();return!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(fd)},callback:function(){t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var e=t.hot.getSelectedLast(),n=t.dataManager.translateTrimmedRow(e[0]);return!t.dataManager.getRowParent(n)||!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return no(0,e.items.length-1,(function(i){if(0===i)return $(n,(function(t,n){e.items.splice(i+n,0,t)})),!1})),this.modifyRowInsertingOptions(e)}},{key:"modifyRowInsertingOptions",value:function(e){var t=RL.get(this);return no(0,e.items.length-1,(function(i){var option=t[e.items[i].key];null!=option&&(e.items[i].callback=option)})),e}}])&&mL(t.prototype,n),r&&mL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(ZN);function TL(e){return function(e){if(Array.isArray(e))return AL(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return AL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AL(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AL(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function xL(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ML=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}var t,n,r;return t=e,n=[{key:"onBeforeRowMove",value:function(e,t,n,r){var o=this;if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r}))return!1;this.movedToCollapsed=!1;var l=n===this.hot.countRows(),c=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),h=!0,f=e.map((function(e){if(!h)return!1;var t=o.dataManager.translateTrimmedRow(e);return h=o.shouldAllowMoving(t,c),t})),d=-1===f.indexOf(c);if(!h||!d)return!1;var y=this.getBaseParent(f),v=this.getTargetParent(l,c),m=y===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(f,c,m),this.moveRows(f,c,v),this.dataManager.rewriteCache(),this.moveCellsMeta(f,c),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var t=e.rows,n=e.finalIndex,r=e.dropIndex,o=e.movePossible,l=!1;return at(r)&&(er(et(OL||(OL=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",t,n,r,o,!1),l=!0),l}},{key:"shouldAllowMoving",value:function(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,t){var n=this.dataManager.getRowParent(e?t-1:t);return null==n&&(n=this.dataManager.getRowParent(t-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(e,t,n){n||(Math.max.apply(Math,TL(e))<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}},{key:"moveRows",value:function(e,t,n){var r=this,o=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){e.forEach((function(e){r.dataManager.moveRow(e,t,r.movedToCollapsed,o)}))}))}},{key:"moveCellsMeta",value:function(e,t){var n,r=this,o=[],l=Math.max.apply(Math,TL(e))<t;e.forEach((function(e){o.push(r.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),(n=this.hot).spliceCellsMeta.apply(n,[t-(l?o.length:0),0].concat(o))}},{key:"selectCells",value:function(e,t){var n,r=e.length,o=0,l=0,c=null;if(this.movedToCollapsed){var h=null;h=e[r-1]<t?this.dataManager.translateTrimmedRow(t-r):this.dataManager.translateTrimmedRow(t);var f=this.dataManager.getRowParent(null===h?this.hot.countSourceRows()-1:h-1),d=this.dataManager.getRowIndex(f);l=o=this.dataManager.untranslateTrimmedRow(d)}else e[r-1]<t?o=(l=t-1)-r+1:l=(o=t)+r-1;c=this.hot.selection,n=this.hot.countCols()-1,c.setRangeStart(this.hot._createCellCoords(o,0)),c.setRangeEnd(this.hot._createCellCoords(l,n),!0)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,n){return e-n!==t}))}}],n&&xL(t.prototype,n),r&&xL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function PL(e){return PL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PL(e)}function _L(e){return function(e){if(Array.isArray(e))return IL(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return IL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IL(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IL(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function HL(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jL(){return jL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=DL(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},jL.apply(this,arguments)}function DL(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=FL(object)););return object}function NL(e,p){return NL=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},NL(e,p)}function LL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=FL(e);if(t){var o=FL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return BL(this,n)}}function BL(e,t){if(t&&("object"===PL(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return VL(e)}function VL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FL(e){return FL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},FL(e)}var WL="nestedRows",UL=new WeakMap,zL=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NL(e,t)}(l,e);var t,n,r,o=LL(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).dataManager=null,t.headersUI=null,t.collapsedRowsMap=null,UL.set(VL(t),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Bh),this.dataManager=new qN(this,this.hot),this.collapsingUI=new gL(this,this.hot),this.headersUI=new aL(this,this.hot),this.contextMenuUI=new EL(this,this.hot),this.rowMoveController=new ML(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeViewRender",(function(){return e.onBeforeViewRender.apply(e,arguments)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData.apply(e,arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength.apply(e,arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice.apply(e,arguments)})),this.addHook("filterData",(function(){return e.onFilterData.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("beforeAddChild",(function(){return e.onBeforeAddChild.apply(e,arguments)})),this.addHook("afterAddChild",(function(){return e.onAfterAddChild.apply(e,arguments)})),this.addHook("beforeDetachChild",(function(){return e.onBeforeDetachChild.apply(e,arguments)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return e.onModifyRowHeaderWidth.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("beforeRowMove",(function(){return e.onBeforeRowMove.apply(e,arguments)})),this.addHook("beforeLoadData",(function(data){return e.onBeforeLoadData(data)})),jL(FL(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),jL(FL(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),jL(FL(l.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}},{key:"disableCoreAPIModifiers",value:function(){UL.get(this).skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){UL.get(this).skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(e,t,n){this.collapsingUI.toggleState(e,t,n)}},{key:"onModifyRowData",value:function(e){if(!UL.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}},{key:"onModifySourceLength",value:function(){if(!UL.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(e,t,element){return!(!UL.get(this).skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e)&&(this.dataManager.spliceData(e,t,element),1))}},{key:"onFilterData",value:function(e,t,n){var r=UL.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),r.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(e){return this.contextMenuUI.appendOptions(e)}},{key:"onAfterGetRowHeader",value:function(e,t){this.headersUI.appendLevelIndicators(e,t)}},{key:"onModifyRowHeaderWidth",value:function(e){return this.headersUI.rowHeaderWidthCache||e}},{key:"onAfterRemoveRow",value:function(e,t,n,source){var r=this;if(source!==this.pluginName){var o=UL.get(this);setTimeout((function(){o.skipRender=null,r.headersUI.updateRowHeaderWidth(),r.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(e,t,n){var r=this,o=Array.from(n.reduce((function(e,t){if(r.dataManager.isParent(t)){var n=r.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach((function(t){return e.add(r.dataManager.getRowIndex(t))})),e}return e.add(t)}),new Set));n.length=0,n.push.apply(n,_L(o))}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(e,element){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(element)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(e,element,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var e=Math.max.apply(Math,_L(this.dataManager.cache.levels));e>0&&this.headersUI.updateRowHeaderWidth(e)}},{key:"onBeforeViewRender",value:function(e,t){UL.get(this).skipRender&&(t.skipRender=!0)}},{key:"destroy",value:function(){jL(FL(l.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(data){if(!Oc(data))return nr("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings().nestedRows=!1,void this.disablePlugin();this.dataManager.setData(data),this.dataManager.rewriteCache()}}],r=[{key:"PLUGIN_KEY",get:function(){return WL}},{key:"PLUGIN_PRIORITY",get:function(){return 300}}],n&&HL(t.prototype,n),r&&HL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function GL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YL(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var KL=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;GL(this,e),this.rootWindow=n,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}var t,n,r;return t=e,n=[{key:"saveValue",value:function(e,t){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,t){var n=void 0===e?t:e,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;$(this.savedKeys,(function(t,n){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}],n&&YL(t.prototype,n),r&&YL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),XL=KL;function $L(e){return $L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$L(e)}function qL(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function QL(){return QL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=JL(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},QL.apply(this,arguments)}function JL(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=nB(object)););return object}function ZL(e,p){return ZL=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},ZL(e,p)}function eB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nB(e);if(t){var o=nB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tB(this,n)}}function tB(e,t){if(t&&("object"===$L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function nB(e){return nB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nB(e)}dr.getSingleton().register("persistentStateSave"),dr.getSingleton().register("persistentStateLoad"),dr.getSingleton().register("persistentStateReset");var rB="persistentState",oB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZL(e,t)}(l,e);var t,n,r,o=eB(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).storage=void 0,t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.storage||(this.storage=new XL(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(t,n){return e.saveValue(t,n)})),this.addHook("persistentStateLoad",(function(t,n){return e.loadValue(t,n)})),this.addHook("persistentStateReset",(function(){return e.resetValue()})),QL(nB(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,QL(nB(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),QL(nB(l.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(e,t){t.value=this.storage.loadValue(e)}},{key:"saveValue",value:function(e,t){this.storage.saveValue(e,t)}},{key:"resetValue",value:function(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}},{key:"destroy",value:function(){QL(nB(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return rB}},{key:"PLUGIN_PRIORITY",get:function(){return 0}}],n&&qL(t.prototype,n),r&&qL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function iB(e){return iB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iB(e)}function aB(e){return function(e){if(Array.isArray(e))return lB(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return lB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lB(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lB(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function sB(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uB(){return uB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=cB(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},uB.apply(this,arguments)}function cB(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=pB(object)););return object}function hB(e,p){return hB=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},hB(e,p)}function fB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pB(e);if(t){var o=pB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dB(this,n)}}function dB(e,t){if(t&&("object"===iB(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pB(e){return pB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pB(e)}var yB="search",gB=function(e,t,col,data,n){e.getCellMeta(t,col).isSearchResult=n},vB=function(e,t,n){return!(at(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!at(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))},mB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hB(e,t)}(l,e);var t,n,r,o=fB(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).callback=gB,t.queryMethod=vB,t.searchResultClass="htSearchResult",t}return t=l,n=[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().search;this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){return e.onBeforeRenderer.apply(e,arguments)})),uB(pB(l.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var e=this,t=function(){return e.onBeforeRenderer.apply(e,arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(function(){e.hot.removeHook("beforeRenderer",t)})),uB(pB(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),uB(pB(l.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),l=this.hot.countCols(),c=[],h=this.hot;return no(0,o-1,(function(o){no(0,l-1,(function(l){var f=t.hot.getDataAtCell(o,l),d=t.hot.getCellMeta(o,l),y=d.search.callback||n,v=(d.search.queryMethod||r)(e,f,d);if(v){var m={row:o,col:l,data:f};c.push(m)}y&&y(h,o,l,f,v)}))})),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(e){this.callback=e}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(e){this.queryMethod=e}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(e){this.searchResultClass=e}},{key:"updatePluginSettings",value:function(e){ve(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}},{key:"onBeforeRenderer",value:function(e,t,col,n,r,o){var l,c=o.className||[],h=[];"string"==typeof c?h=c.split(" "):(l=h).push.apply(l,aB(c)),this.isEnabled()&&o.isSearchResult?h.includes(this.searchResultClass)||h.push("".concat(this.searchResultClass)):h.includes(this.searchResultClass)&&h.splice(h.indexOf(this.searchResultClass),1),o.className=h.join(" ")}},{key:"destroy",value:function(){uB(pB(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return yB}},{key:"PLUGIN_PRIORITY",get:function(){return 190}}],n&&sB(t.prototype,n),r&&sB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function bB(e){return bB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bB(e)}function wB(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function CB(){return CB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=SB(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},CB.apply(this,arguments)}function SB(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=EB(object)););return object}function kB(e,p){return kB=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},kB(e,p)}function OB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=EB(e);if(t){var o=EB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return RB(this,n)}}function RB(e,t){if(t&&("object"===bB(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function EB(e){return EB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},EB(e)}var TB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kB(e,t)}(l,e);var t,n,r,o=OB(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).scrollbars=[],t.clones=[],t.lockedCollection=!1,t.freezeOverlays=!1,t}return t=l,r=[{key:"PLUGIN_KEY",get:function(){return"touchScroll"}},{key:"PLUGIN_PRIORITY",get:function(){return 200}},{key:"SETTING_KEYS",get:function(){return!0}}],(n=[{key:"isEnabled",value:function(){return B()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterViewRender",(function(){return e.onAfterViewRender()})),this.registerEvents(),CB(EB(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,CB(EB(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){CB(EB(l.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",(function(){return e.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return e.onAfterMomentumScroll()}))}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var e=this.hot.view._wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,r=e.inlineStartOverlay,o=e.topInlineStartCornerOverlay,l=e.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),l&&l.clone&&this.scrollbars.push(l),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),l&&l.clone&&this.clones.push(l.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,$(this.clones,(function(e){Gt(e,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,$(this.clones,(function(e){Yt(e,"hide-tween"),Gt(e,"show-tween")})),this.hot._registerTimeout((function(){$(e.clones,(function(e){Yt(e,"show-tween")}))}),400),$(this.scrollbars,(function(e){e.refresh(),e.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}])&&wB(t.prototype,n),r&&wB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function AB(e){return AB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AB(e)}function xB(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function MB(){return MB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=PB(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},MB.apply(this,arguments)}function PB(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=jB(object)););return object}function _B(e,p){return _B=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},_B(e,p)}function IB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jB(e);if(t){var o=jB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HB(this,n)}}function HB(e,t){if(t&&("object"===AB(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jB(e){return jB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jB(e)}var DB="trimRows",NB=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_B(e,t)}(l,e);var t,n,r,o=IB(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=o.call(this,e)).trimmedRowsMap=null,t}return t=l,n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Bh),this.trimmedRowsMap.addLocalHook("init",(function(){return e.onMapInit()})),MB(jB(l.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batchExecution((function(){e.trimmedRowsMap.clear(),$(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),MB(jB(l.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),MB(jB(l.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(e){var t=this,n=this.getTrimmedRows(),r=this.isValidConfig(e),o=n;r&&(o=Array.from(new Set(n.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",n,o,r)&&(r&&this.hot.batchExecution((function(){$(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}},{key:"trimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}},{key:"untrimRows",value:function(e){var t=this.getTrimmedRows(),n=this.isValidConfig(e),r=t,o=this.trimmedRowsMap.getValues().slice(),l=e.length>0;n&&l&&($(e,(function(e){o[e]=!1})),r=Y(o,(function(e,t,n){return t&&e.push(n),e}),[])),!1!==this.hot.runHooks("beforeUntrimRow",t,r,n&&l)&&(n&&l&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,r,n&&l,n&&r.length<t.length))}},{key:"untrimRow",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}},{key:"isTrimmed",value:function(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(e){var t=this.hot.countSourceRows();return e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"onMapInit",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batchExecution((function(){$(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"destroy",value:function(){MB(jB(l.prototype),"destroy",this).call(this)}}],r=[{key:"PLUGIN_KEY",get:function(){return DB}},{key:"PLUGIN_PRIORITY",get:function(){return 330}}],n&&xB(t.prototype,n),r&&xB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(dw);function LB(e){return LB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},LB(e)}function BB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VB(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function FB(e,t,n){return t&&VB(e.prototype,t),n&&VB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function WB(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UB(e,t)}function UB(e,p){return UB=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},UB(e,p)}function zB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=YB(e);if(t){var o=YB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GB(this,n)}}function GB(e,t){if(t&&("object"===LB(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function YB(e){return YB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},YB(e)}function KB(e){return function(e){if(Array.isArray(e))return qB(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$B(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function XB(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,r,o=[],l=!0,c=!1;try{for(t=t.call(e);!(l=(n=t.next()).done)&&(o.push(n.value),!i||o.length!==i);l=!0);}catch(e){c=!0,r=e}finally{try{l||null==t.return||t.return()}finally{if(c)throw r}}return o}(e,i)||$B(e,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $B(e,t){if(e){if("string"==typeof e)return qB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qB(e,t):void 0}}function qB(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var QB="undoRedo";function JB(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",(function(n,source){var r=this,o=n&&n.length;if(o&&n.find((function(e){var t=XB(e,4);return t[2]!==t[3]}))){t.done((function(){var t=n.reduce((function(e,t){return e.push(KB(t)),e}),[]);$(t,(function(t){t[1]=e.propToCol(t[1])}));var l=o>1?r.getSelected():[[t[0][0],t[0][1]]];return new JB.ChangeAction(t,l)}),source)}})),e.addHook("afterCreateRow",(function(e,n,source){t.done((function(){return new JB.CreateRowAction(e,n)}),source)})),e.addHook("beforeRemoveRow",(function(n,r,o,source){t.done((function(){var o=t.instance.getSourceDataArray(),l=(o.length+n)%o.length,c=e.toPhysicalRow(l),h=de(o.slice(c,c+r));return new JB.RemoveRowAction(l,h,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop)}),source)})),e.addHook("afterCreateCol",(function(e,n,source){t.done((function(){return new JB.CreateColumnAction(e,n)}),source)})),e.addHook("beforeRemoveCol",(function(n,r,o,source){t.done((function(){var o=t.instance.getSourceDataArray(),l=(t.instance.countCols()+n)%t.instance.countCols(),c=[],h=[],f=[];no(o.length-1,(function(i){var t=[],n=o[i];no(l,l+(r-1),(function(r){t.push(n[e.toPhysicalColumn(r)])})),c.push(t)})),no(r-1,(function(i){f.push(e.toPhysicalColumn(l+i))})),Array.isArray(e.getSettings().colHeaders)&&no(r-1,(function(i){h.push(e.getSettings().colHeaders[e.toPhysicalColumn(l+i)]||null)}));var d=e.columnIndexMapper.getIndexesSequence(),y=e.rowIndexMapper.getIndexesSequence();return new JB.RemoveColumnAction(l,f,c,h,d,y,e.getSettings().fixedColumnsStart)}),source)})),e.addHook("beforeCellAlignment",(function(e,n,r,o){t.done((function(){return new JB.CellAlignmentAction(e,n,r,o)}))})),e.addHook("beforeFilter",(function(e){t.done((function(){return new JB.FiltersAction(e)}))})),e.addHook("beforeRowMove",(function(e,n){!1!==e&&t.done((function(){return new JB.RowMoveAction(e,n)}))})),e.addHook("beforeMergeCells",(function(n,r){r||t.done((function(){return new JB.MergeCellsAction(e,n)}))})),e.addHook("afterUnmergeCells",(function(n,r){r||t.done((function(){return new JB.UnmergeCellsAction(e,n)}))})),e.addHook("afterInit",(function(){t.init()}))}JB.prototype.done=function(e,source){if(!this.ignoreNewActions&&!("UndoRedo.undo"===source||"UndoRedo.redo"===source||"auto"===source)){var t=this.doneActions.slice();if(!1!==this.instance.runHooks("beforeUndoStackChange",t,source)){var n=e(),r=this.undoneActions.slice();this.doneActions.push(n),this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",r),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice())}}},JB.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);var t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var n=de(t);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;var r=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),t.undo(this.instance,(function(){r.ignoreNewActions=!1,r.undoneActions.push(t)})),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},JB.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);var t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var n=de(t);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;var r=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),t.redo(this.instance,(function(){r.ignoreNewActions=!1,r.doneActions.push(t)})),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},JB.prototype.isUndoAvailable=function(){return this.doneActions.length>0},JB.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},JB.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},JB.prototype.isEnabled=function(){return this.enabled},JB.prototype.enable=function(){if(!this.isEnabled()){var e,t=this.instance;this.enabled=!0,(e=t).undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()},this.registerShortcuts(),t.addHook("afterChange",tV)}},JB.prototype.disable=function(){if(this.isEnabled()){var e,t=this.instance;this.enabled=!1,delete(e=t).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,this.unregisterShortcuts(),t.removeHook("afterChange",tV)}},JB.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},JB.Action=function(){},JB.Action.prototype.undo=function(){},JB.Action.prototype.redo=function(){},JB.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},ce(JB.ChangeAction,JB.Action),JB.ChangeAction.prototype.undo=function(e,t){for(var data=de(this.changes),n=e.countEmptyRows(!0),r=e.countEmptyCols(!0),i=0,o=data.length;i<o;i++)data[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(data,null,null,"UndoRedo.undo");for(var l=0,c=data.length;l<c;l++){var h=XB(data[l],2),f=h[0],d=h[1];e.getSettings().minSpareRows&&f+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(f+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&d+1+e.getSettings().minSpareCols===e.countCols()&&r===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(d+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)},JB.ChangeAction.prototype.redo=function(e,t){for(var data=de(this.changes),i=0,n=data.length;i<n;i++)data[i].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(data,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},JB.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},ce(JB.CreateRowAction,JB.Action),JB.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},JB.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},JB.RemoveRowAction=function(e,data,t,n){this.index=e,this.data=data,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=n},ce(JB.RemoveRowAction,JB.Action),JB.RemoveRowAction.prototype.undo=function(e,t){var n=e.getSettings();n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},JB.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},JB.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},ce(JB.CreateColumnAction,JB.Action),JB.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},JB.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},JB.RemoveColumnAction=function(e,t,data,n,r,o,l){this.index=e,this.indexes=t,this.data=data,this.amount=this.data[0].length,this.headers=n,this.columnPositions=r.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=l},ce(JB.RemoveColumnAction,JB.Action),JB.RemoveColumnAction.prototype.undo=function(e,t){var n=this;e.getSettings().fixedColumnsStart=this.fixedColumnsStart;for(var r=this.indexes.slice(0).sort(),o=function(e,t,o){return o[n.indexes.indexOf(r[t])]},l=this.data.length,c=[],h=0;h<l;h++)c.push(X(this.data[h],o));var f=X(this.headers,o),d=[];e.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),$(e.getSourceDataArray(),(function(e,t){$(r,(function(n,r){e[n]=c[t][r],d.push([t,n,e[n]])}))})),e.setSourceDataAtCell(d,void 0,void 0,"UndoRedo.undo"),e.columnIndexMapper.insertIndexes(r[0],r.length),void 0!==this.headers&&$(f,(function(t,n){e.getSettings().colHeaders[r[n]]=t})),e.batchExecution((function(){e.rowIndexMapper.setIndexesSequence(n.rowPositions),e.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()},JB.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},JB.CellAlignmentAction=function(e,t,n,r){this.stateBefore=e,this.range=t,this.type=n,this.alignment=r},JB.CellAlignmentAction.prototype.undo=function(e,t){var n=this;$(this.range,(function(t){t.forAll((function(t,col){t>=0&&col>=0&&e.setCellMeta(t,col,"className",n.stateBefore[t][col]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()},JB.CellAlignmentAction.prototype.redo=function(e,t){Xk(this.range,this.type,this.alignment,(function(t,col){return e.getCellMeta(t,col)}),(function(t,col,n,r){return e.setCellMeta(t,col,n,r)})),e.addHookOnce("afterViewRender",t),e.render()},JB.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},ce(JB.FiltersAction,JB.Action),JB.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},JB.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var ZB=function(e){WB(n,e);var t=zB(n);function n(e,r){var o;BB(this,n),(o=t.call(this)).cellRange=r;var l=o.cellRange.getTopStartCorner(),c=o.cellRange.getBottomEndCorner();return o.rangeData=e.getData(l.row,l.col,c.row,c.col),o}return FB(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);var r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}]),n}(JB.Action);JB.MergeCellsAction=ZB;var eV=function(e){WB(n,e);var t=zB(n);function n(e,r){var o;return BB(this,n),(o=t.call(this)).cellRange=r,o}return FB(n,[{key:"undo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}]),n}(JB.Action);function tV(e,source){if("loadData"===source)return this.undoRedo.clear()}JB.UnmergeCellsAction=eV,JB.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"},ce(JB.RowMoveAction,JB.Action),JB.RowMoveAction.prototype.undo=function(e,t){var n=this,r=e.getPlugin("manualRowMove"),o=[].concat(this.rows),l=o.filter((function(a){return a>n.finalIndex})),c=o.filter((function(a){return a<=n.finalIndex})),h=l.sort((function(a,b){return b-a})).concat(c.sort((function(a,b){return a-b})));e.addHookOnce("afterViewRender",t);for(var i=0;i<h.length;i+=1){var f=e.toVisualRow(h[i]);r.moveRow(f,h[i])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},JB.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},JB.prototype.init=function(){var e=this.instance.getSettings().undo,t=void 0===e||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},JB.prototype.registerShortcuts=function(){var e=this,t=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:function(e){return!e.altKey},group:QB};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){e.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){e.redo()}}],n)},JB.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(QB)};var nV=dr.getSingleton();nV.add("afterUpdateSettings",(function(){var e;null===(e=this.getPlugin("undoRedo"))||void 0===e||e.init()})),nV.register("beforeUndo"),nV.register("afterUndo"),nV.register("beforeRedo"),nV.register("afterRedo"),JB.PLUGIN_KEY="undoRedo",JB.SETTING_KEYS=!0;var rV,oV,iV,aV,lV,sV=JB;Ar(kv),Ar(dm),Ar(Cm),Ar(_m),Ar(Wm),Ar(nm),Ar(qm),Ar(ab),Ar(mb),Ar(Bv),Ar(Ab),Vo(Mb),Vo(Vv),Vo(Nb),Vo(xb),Vo(Vb),Vo(Fb),Vo(Fv),Vo(Wb),Ko(Ub),Ko(Yb),Ko(Kb),Ko($b),hc(qb),hc(Qb),hc(Jb),hc(Zb),hc(ew),hc(tw),hc(nw),hc(Wv),hc(rw),Io(Dw),Io(Zw),Io(hC),Io($C),Io(vS),Io(Ok),Io(Lk),Io(bO),Io(gR),Io(zR),Io(gE),Io(TE),Io(BE),Io(gT),Io(nP),Io(GP),Io(d_),Io(j_),Io(Q_),Io(LI),Io(QI),Io(LH),Io(tj),Io(Dj),Io(Jj),Io(lD),Io(zN),Io(zL),Io(oB),Io(mB),Io(TB),Io(NB),Io(sV),function(e){var t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var output,n=this.first(),r=n.data("handsontable");if("string"!=typeof t){var o=t||{};return r?r.updateSettings(o):(r=new e.Core(n[0],o),n.data("handsontable",r),r.init()),n}if(r){if(void 0===r[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var l,c=arguments.length,h=new Array(c>1?c-1:0),f=1;f<c;f++)h[f-1]=arguments[f];output=(l=r[t]).call.apply(l,[r].concat(h)),"destroy"===t&&n.removeData()}return output})}(zv),zv.__GhostTable=bw,zv._getListenersCounter=function(){return Pr},zv._getRegisteredMapsCounter=function(){return Wh},zv.EventManager=Hr;var uV=[o,c,S,O,r,y,h,C,l,f,v,w],cV=[d,m];zv.helper={},zv.dom={},$(uV,(function(e){$(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(zv.helper[t]=e[t])}))})),$(cV,(function(e){$(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(zv.dom[t]=e[t])}))})),zv.cellTypes=null!==(rV=zv.cellTypes)&&void 0!==rV?rV:{},$(uc(),(function(e){zv.cellTypes[e]=cc(e)})),zv.cellTypes.registerCellType=hc,zv.cellTypes.getCellType=cc,zv.editors=null!==(oV=zv.editors)&&void 0!==oV?oV:{},$(Or(),(function(e){zv.editors["".concat(kt(e),"Editor")]=Tr(e)})),zv.editors.registerEditor=Ar,zv.editors.getEditor=Tr,zv.renderers=null!==(iV=zv.renderers)&&void 0!==iV?iV:{},$(Lo(),(function(e){var t=Bo(e);"base"===e&&(zv.renderers.cellDecorator=t),zv.renderers["".concat(kt(e),"Renderer")]=t})),zv.renderers.registerRenderer=Vo,zv.renderers.getRenderer=Bo,zv.validators=null!==(aV=zv.validators)&&void 0!==aV?aV:{},$(Go(),(function(e){zv.validators["".concat(kt(e),"Validator")]=Yo(e)})),zv.validators.registerValidator=Ko,zv.validators.getValidator=Yo,zv.plugins=null!==(lV=zv.plugins)&&void 0!==lV?lV:{},$(Po(),(function(e){zv.plugins[e]=_o(e)})),zv.plugins["".concat(kt(dw.PLUGIN_KEY),"Plugin")]=dw,zv.plugins.registerPlugin=Io,zv.plugins.getPlugin=_o;t.a=zv},880:function(e,t,n){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,p){return t=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},t(e,p)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,o,l){return r=n()?Reflect.construct:function(e,n,r){var a=[null];a.push.apply(a,n);var o=new(Function.bind.apply(e,a));return r&&t(o,r.prototype),o},r.apply(null,arguments)}function o(e){return l(e)||c(e)||h(e)||d()}function l(e){if(Array.isArray(e))return f(e)}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var y=Object.hasOwnProperty,v=Object.setPrototypeOf,m=Object.isFrozen,w=Object.getPrototypeOf,C=Object.getOwnPropertyDescriptor,S=Object.freeze,k=Object.seal,O=Object.create,R="undefined"!=typeof Reflect&&Reflect,E=R.apply,T=R.construct;E||(E=function(e,t,n){return e.apply(t,n)}),S||(S=function(e){return e}),k||(k=function(e){return e}),T||(T=function(e,t){return r(e,o(t))});var A=L(Array.prototype.forEach),x=L(Array.prototype.pop),M=L(Array.prototype.push),P=L(String.prototype.toLowerCase),_=L(String.prototype.match),I=L(String.prototype.replace),H=L(String.prototype.indexOf),j=L(String.prototype.trim),D=L(RegExp.prototype.test),N=B(TypeError);function L(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return E(e,t,r)}}function B(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return T(e,n)}}function V(e,t){v&&v(e,null);for(var n=t.length;n--;){var element=t[n];if("string"==typeof element){var r=P(element);r!==element&&(m(t)||(t[n]=r),element=r)}e[element]=!0}return e}function F(object){var e,t=O(null);for(e in object)E(y,object,[e])&&(t[e]=object[e]);return t}function W(object,e){for(;null!==object;){var desc=C(object,e);if(desc){if(desc.get)return L(desc.get);if("function"==typeof desc.value)return L(desc.value)}object=w(object)}function t(element){return console.warn("fallback value for",element),null}return t}var U=S(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),z=S(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),G=S(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Y=S(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),K=S(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),X=S(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=S(["#text"]),html=S(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg=S(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$=S(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Q=S(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),J=k(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Z=k(/<%[\w\W]*|[\w\W]*%>/gm),ee=k(/^data-[\-\w.\u00B7-\uFFFF]/),te=k(/^aria-[\-\w]+$/),ne=k(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),re=k(/^(?:\w+script|data):/i),oe=k(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ie=k(/^html$/i),ae=function(){return"undefined"==typeof window?null:window},le=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var l="dompurify"+(r?"#"+r:"");try{return t.createPolicy(l,{createHTML:function(html){return html}})}catch(e){return console.warn("TrustedTypes policy "+l+" could not be created."),null}};function se(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae(),n=function(e){return se(e)};if(n.version="2.3.8",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,l=t.document,c=t.DocumentFragment,h=t.HTMLTemplateElement,f=t.Node,d=t.Element,y=t.NodeFilter,v=t.NamedNodeMap,m=void 0===v?t.NamedNodeMap||t.MozNamedAttrMap:v,w=t.HTMLFormElement,C=t.DOMParser,k=t.trustedTypes,O=d.prototype,R=W(O,"cloneNode"),E=W(O,"nextSibling"),T=W(O,"childNodes"),L=W(O,"parentNode");if("function"==typeof h){var template=l.createElement("template");template.content&&template.content.ownerDocument&&(l=template.content.ownerDocument)}var B=le(k,r),ue=B?B.createHTML(""):"",ce=l,he=ce.implementation,fe=ce.createNodeIterator,de=ce.createDocumentFragment,pe=ce.getElementsByTagName,ye=r.importNode,ge={};try{ge=F(l).documentMode?l.documentMode:{}}catch(e){}var ve={};n.isSupported="function"==typeof L&&he&&void 0!==he.createHTMLDocument&&9!==ge;var me,be,we=J,Ce=Z,Se=ee,ke=te,Oe=re,Re=oe,Ee=ne,Te=null,Ae=V({},[].concat(o(U),o(z),o(G),o(K),o(text))),xe=null,Me=V({},[].concat(o(html),o(svg),o($),o(Q))),Pe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_e=null,Ie=null,He=!0,je=!0,De=!1,Ne=!1,Le=!1,Be=!1,Ve=!1,Fe=!1,We=!1,Ue=!1,ze=!0,Ge=!0,Ye=!1,Ke={},Xe=null,$e=V({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),qe=null,Qe=V({},["audio","video","img","source","image","track"]),Je=null,Ze=V({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),et="http://www.w3.org/1998/Math/MathML",tt="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml",ot=nt,it=!1,at=["application/xhtml+xml","text/html"],lt="text/html",st=null,ut=l.createElement("form"),ct=function(e){return e instanceof RegExp||e instanceof Function},ht=function(t){st&&st===t||(t&&"object"===e(t)||(t={}),t=F(t),Te="ALLOWED_TAGS"in t?V({},t.ALLOWED_TAGS):Ae,xe="ALLOWED_ATTR"in t?V({},t.ALLOWED_ATTR):Me,Je="ADD_URI_SAFE_ATTR"in t?V(F(Ze),t.ADD_URI_SAFE_ATTR):Ze,qe="ADD_DATA_URI_TAGS"in t?V(F(Qe),t.ADD_DATA_URI_TAGS):Qe,Xe="FORBID_CONTENTS"in t?V({},t.FORBID_CONTENTS):$e,_e="FORBID_TAGS"in t?V({},t.FORBID_TAGS):{},Ie="FORBID_ATTR"in t?V({},t.FORBID_ATTR):{},Ke="USE_PROFILES"in t&&t.USE_PROFILES,He=!1!==t.ALLOW_ARIA_ATTR,je=!1!==t.ALLOW_DATA_ATTR,De=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ne=t.SAFE_FOR_TEMPLATES||!1,Le=t.WHOLE_DOCUMENT||!1,Fe=t.RETURN_DOM||!1,We=t.RETURN_DOM_FRAGMENT||!1,Ue=t.RETURN_TRUSTED_TYPE||!1,Ve=t.FORCE_BODY||!1,ze=!1!==t.SANITIZE_DOM,Ge=!1!==t.KEEP_CONTENT,Ye=t.IN_PLACE||!1,Ee=t.ALLOWED_URI_REGEXP||Ee,ot=t.NAMESPACE||nt,t.CUSTOM_ELEMENT_HANDLING&&ct(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Pe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ct(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Pe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Pe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),me=me=-1===at.indexOf(t.PARSER_MEDIA_TYPE)?lt:t.PARSER_MEDIA_TYPE,be="application/xhtml+xml"===me?function(e){return e}:P,Ne&&(je=!1),We&&(Fe=!0),Ke&&(Te=V({},o(text)),xe=[],!0===Ke.html&&(V(Te,U),V(xe,html)),!0===Ke.svg&&(V(Te,z),V(xe,svg),V(xe,Q)),!0===Ke.svgFilters&&(V(Te,G),V(xe,svg),V(xe,Q)),!0===Ke.mathMl&&(V(Te,K),V(xe,$),V(xe,Q))),t.ADD_TAGS&&(Te===Ae&&(Te=F(Te)),V(Te,t.ADD_TAGS)),t.ADD_ATTR&&(xe===Me&&(xe=F(xe)),V(xe,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&V(Je,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(Xe===$e&&(Xe=F(Xe)),V(Xe,t.FORBID_CONTENTS)),Ge&&(Te["#text"]=!0),Le&&V(Te,["html","head","body"]),Te.table&&(V(Te,["tbody"]),delete _e.tbody),S&&S(t),st=t)},ft=V({},["mi","mo","mn","ms","mtext"]),pt=V({},["foreignobject","desc","title","annotation-xml"]),yt=V({},["title","style","font","a","script"]),gt=V({},z);V(gt,G),V(gt,Y);var vt=V({},K);V(vt,X);var mt=function(element){var e=L(element);e&&e.tagName||(e={namespaceURI:nt,tagName:"template"});var t=P(element.tagName),n=P(e.tagName);return element.namespaceURI===tt?e.namespaceURI===nt?"svg"===t:e.namespaceURI===et?"svg"===t&&("annotation-xml"===n||ft[n]):Boolean(gt[t]):element.namespaceURI===et?e.namespaceURI===nt?"math"===t:e.namespaceURI===tt?"math"===t&&pt[n]:Boolean(vt[t]):element.namespaceURI===nt&&!(e.namespaceURI===tt&&!pt[n])&&!(e.namespaceURI===et&&!ft[n])&&!vt[t]&&(yt[t]||!gt[t])},bt=function(e){M(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ue}catch(t){e.remove()}}},wt=function(e,t){try{M(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){M(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!xe[e])if(Fe||We)try{bt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Ct=function(e){var t,n;if(Ve)e="<remove></remove>"+e;else{var r=_(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===me&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=B?B.createHTML(e):e;if(ot===nt)try{t=(new C).parseFromString(o,me)}catch(e){}if(!t||!t.documentElement){t=he.createDocument(ot,"template",null);try{t.documentElement.innerHTML=it?"":o}catch(e){}}var body=t.body||t.documentElement;return e&&n&&body.insertBefore(l.createTextNode(n),body.childNodes[0]||null),ot===nt?pe.call(t,Le?"html":"body")[0]:Le?t.documentElement:body},St=function(e){return fe.call(e.ownerDocument||e,e,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT,null,!1)},kt=function(e){return e instanceof w&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof m)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},Ot=function(object){return"object"===e(f)?object instanceof f:object&&"object"===e(object)&&"number"==typeof object.nodeType&&"string"==typeof object.nodeName},Rt=function(e,t,data){ve[e]&&A(ve[e],(function(e){e.call(n,t,data,st)}))},Et=function(e){var content;if(Rt("beforeSanitizeElements",e,null),kt(e))return bt(e),!0;if(D(/[\u0080-\uFFFF]/,e.nodeName))return bt(e),!0;var t=be(e.nodeName);if(Rt("uponSanitizeElement",e,{tagName:t,allowedTags:Te}),e.hasChildNodes()&&!Ot(e.firstElementChild)&&(!Ot(e.content)||!Ot(e.content.firstElementChild))&&D(/<[/\w]/g,e.innerHTML)&&D(/<[/\w]/g,e.textContent))return bt(e),!0;if("select"===t&&D(/<template/i,e.innerHTML))return bt(e),!0;if(!Te[t]||_e[t]){if(!_e[t]&&At(t)){if(Pe.tagNameCheck instanceof RegExp&&D(Pe.tagNameCheck,t))return!1;if(Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(t))return!1}if(Ge&&!Xe[t]){var r=L(e)||e.parentNode,o=T(e)||e.childNodes;if(o&&r)for(var i=o.length-1;i>=0;--i)r.insertBefore(R(o[i],!0),E(e))}return bt(e),!0}return e instanceof d&&!mt(e)?(bt(e),!0):"noscript"!==t&&"noembed"!==t||!D(/<\/no(script|embed)/i,e.innerHTML)?(Ne&&3===e.nodeType&&(content=e.textContent,content=I(content,we," "),content=I(content,Ce," "),e.textContent!==content&&(M(n.removed,{element:e.cloneNode()}),e.textContent=content)),Rt("afterSanitizeElements",e,null),!1):(bt(e),!0)},Tt=function(e,t,n){if(ze&&("id"===t||"name"===t)&&(n in l||n in ut))return!1;if(je&&!Ie[t]&&D(Se,t));else if(He&&D(ke,t));else if(!xe[t]||Ie[t]){if(!(At(e)&&(Pe.tagNameCheck instanceof RegExp&&D(Pe.tagNameCheck,e)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(e))&&(Pe.attributeNameCheck instanceof RegExp&&D(Pe.attributeNameCheck,t)||Pe.attributeNameCheck instanceof Function&&Pe.attributeNameCheck(t))||"is"===t&&Pe.allowCustomizedBuiltInElements&&(Pe.tagNameCheck instanceof RegExp&&D(Pe.tagNameCheck,n)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(n))))return!1}else if(Je[t]);else if(D(Ee,I(n,Re,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==H(n,"data:")||!qe[e])if(De&&!D(Oe,I(n,Re,"")));else if(n)return!1;return!0},At=function(e){return e.indexOf("-")>0},xt=function(e){var t,r,o,l;Rt("beforeSanitizeAttributes",e,null);var c=e.attributes;if(c){var h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(l=c.length;l--;){var f=t=c[l],d=f.name,y=f.namespaceURI;if(r="value"===d?t.value:j(t.value),o=be(d),h.attrName=o,h.attrValue=r,h.keepAttr=!0,h.forceKeepAttr=void 0,Rt("uponSanitizeAttribute",e,h),r=h.attrValue,!h.forceKeepAttr&&(wt(d,e),h.keepAttr))if(D(/\/>/i,r))wt(d,e);else{Ne&&(r=I(r,we," "),r=I(r,Ce," "));var v=be(e.nodeName);if(Tt(v,o,r))try{y?e.setAttributeNS(y,d,r):e.setAttribute(d,r),x(n.removed)}catch(e){}}}Rt("afterSanitizeAttributes",e,null)}},Mt=function e(t){var n,r=St(t);for(Rt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)Rt("uponSanitizeShadowNode",n,null),Et(n)||(n.content instanceof c&&e(n.content),xt(n));Rt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(o,l){var body,h,d,y,v;if((it=!o)&&(o="\x3c!--\x3e"),"string"!=typeof o&&!Ot(o)){if("function"!=typeof o.toString)throw N("toString is not a function");if("string"!=typeof(o=o.toString()))throw N("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof o)return t.toStaticHTML(o);if(Ot(o))return t.toStaticHTML(o.outerHTML)}return o}if(Be||ht(l),n.removed=[],"string"==typeof o&&(Ye=!1),Ye){if(o.nodeName){var m=be(o.nodeName);if(!Te[m]||_e[m])throw N("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof f)1===(h=(body=Ct("\x3c!----\x3e")).ownerDocument.importNode(o,!0)).nodeType&&"BODY"===h.nodeName||"HTML"===h.nodeName?body=h:body.appendChild(h);else{if(!Fe&&!Ne&&!Le&&-1===o.indexOf("<"))return B&&Ue?B.createHTML(o):o;if(!(body=Ct(o)))return Fe?null:Ue?ue:""}body&&Ve&&bt(body.firstChild);for(var w=St(Ye?o:body);d=w.nextNode();)3===d.nodeType&&d===y||Et(d)||(d.content instanceof c&&Mt(d.content),xt(d),y=d);if(y=null,Ye)return o;if(Fe){if(We)for(v=de.call(body.ownerDocument);body.firstChild;)v.appendChild(body.firstChild);else v=body;return xe.shadowroot&&(v=ye.call(r,v,!0)),v}var C=Le?body.outerHTML:body.innerHTML;return Le&&Te["!doctype"]&&body.ownerDocument&&body.ownerDocument.doctype&&body.ownerDocument.doctype.name&&D(ie,body.ownerDocument.doctype.name)&&(C="<!DOCTYPE "+body.ownerDocument.doctype.name+">\n"+C),Ne&&(C=I(C,we," "),C=I(C,Ce," ")),B&&Ue?B.createHTML(C):C},n.setConfig=function(e){ht(e),Be=!0},n.clearConfig=function(){st=null,Be=!1},n.isValidAttribute=function(e,t,n){st||ht({});var r=be(e),o=be(t);return Tt(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&(ve[e]=ve[e]||[],M(ve[e],t))},n.removeHook=function(e){if(ve[e])return x(ve[e])},n.removeHooks=function(e){ve[e]&&(ve[e]=[])},n.removeAllHooks=function(){ve={}},n}return se()}()},891:function(e,t,n){!function(t,r){"use strict";var o;try{o=n(185)}catch(e){}e.exports=function(e){var t="function"==typeof e,n=!!window.addEventListener,r=window.document,o=window.setTimeout,l=function(e,t,r,o){n?e.addEventListener(t,r,!!o):e.attachEvent("on"+t,r)},c=function(e,t,r,o){n?e.removeEventListener(t,r,!!o):e.detachEvent("on"+t,r)},h=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},f=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},d=function(e,t){f(e,t)||(e.className=""===e.className?t:e.className+" "+t)},y=function(e,t){e.className=h((" "+e.className+" ").replace(" "+t+" "," "))},v=function(e){return/Array/.test(Object.prototype.toString.call(e))},m=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},w=function(e){var t=e.getDay();return 0===t||6===t},C=function(e){return e%4==0&&e%100!=0||e%400==0},S=function(e,t){return[31,C(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},k=function(e){m(e)&&e.setHours(0,0,0,0)},O=function(a,b){return a.getTime()===b.getTime()},R=function(e,t,n){var r,o;for(r in t)(o=void 0!==e[r])&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?m(t[r])?n&&(e[r]=new Date(t[r].getTime())):v(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=R({},t[r],n):!n&&o||(e[r]=t[r]);return e},E=function(e,t,data){var n;r.createEvent?((n=r.createEvent("HTMLEvents")).initEvent(t,!0,!1),n=R(n,data),e.dispatchEvent(n)):r.createEventObject&&(n=r.createEventObject(),n=R(n,data),e.fireEvent("on"+t,n))},T=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},A={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},x=function(e,t,abbr){for(t+=e.firstDay;t>=7;)t-=7;return abbr?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},M=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},P=function(e,t,n){var r=new Date(n,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(n,t,e)-r)/864e5+r.getDay()+1)/7)+"</td>"},_=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},I=function(e){return"<tbody>"+e.join("")+"</tbody>"},H=function(e){var i,t=[];for(e.showWeekNumber&&t.push("<th></th>"),i=0;i<7;i++)t.push('<th scope="col"><abbr title="'+x(e,i)+'">'+x(e,i,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?t.reverse():t).join("")+"</tr></thead>"},j=function(e,t,n,r,o,l){var i,c,h,f,d,y=e._o,m=n===y.minYear,w=n===y.maxYear,html='<div id="'+l+'" class="pika-title" role="heading" aria-live="assertive">',C=!0,S=!0;for(h=[],i=0;i<12;i++)h.push('<option value="'+(n===o?i-t:12+i-t)+'"'+(i===r?' selected="selected"':"")+(m&&i<y.minMonth||w&&i>y.maxMonth?'disabled="disabled"':"")+">"+y.i18n.months[i]+"</option>");for(f='<div class="pika-label">'+y.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",v(y.yearRange)?(i=y.yearRange[0],c=y.yearRange[1]+1):(i=n-y.yearRange,c=1+n+y.yearRange),h=[];i<c&&i<=y.maxYear;i++)i>=y.minYear&&h.push('<option value="'+i+'"'+(i===n?' selected="selected"':"")+">"+i+"</option>");return d='<div class="pika-label">'+n+y.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",y.showMonthAfterYear?html+=d+f:html+=f+d,m&&(0===r||y.minMonth>=r)&&(C=!1),w&&(11===r||y.maxMonth<=r)&&(S=!1),0===t&&(html+='<button class="pika-prev'+(C?"":" is-disabled")+'" type="button">'+y.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(html+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+y.i18n.nextMonth+"</button>"),html+"</div>"},D=function(e,data,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+H(e)+I(data)+"</table>"},N=function(c){var h=this,d=h.config(c);h._onMouseDown=function(e){if(h._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(f(t,"is-disabled")||(!f(t,"pika-button")||f(t,"is-empty")||f(t.parentNode,"is-disabled")?f(t,"pika-prev")?h.prevMonth():f(t,"pika-next")&&h.nextMonth():(h.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),d.bound&&o((function(){h.hide(),d.blurFieldOnSelect&&d.field&&d.field.blur()}),100))),f(t,"pika-select"))h._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},h._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(f(t,"pika-select-month")?h.gotoMonth(t.value):f(t,"pika-select-year")&&h.gotoYear(t.value))},h._onKeyChange=function(e){if(e=e||window.event,h.isVisible())switch(e.keyCode){case 13:case 27:d.field&&d.field.blur();break;case 37:e.preventDefault(),h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7)}},h._onInputChange=function(n){var r;n.firedBy!==h&&(r=d.parse?d.parse(d.field.value,d.format):t?(r=e(d.field.value,d.format,d.formatStrict))&&r.isValid()?r.toDate():null:new Date(Date.parse(d.field.value)),m(r)&&h.setDate(r),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var e=r.activeElement;do{if(f(e,"pika-single"))return}while(e=e.parentNode);h._c||(h._b=o((function(){h.hide()}),50)),h._c=!1},h._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,r=t;if(t){!n&&f(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),l(t,"change",h._onChange)));do{if(f(r,"pika-single")||r===d.trigger)return}while(r=r.parentNode);h._v&&t!==d.trigger&&r!==d.trigger&&h.hide()}},h.el=r.createElement("div"),h.el.className="pika-single"+(d.isRTL?" is-rtl":"")+(d.theme?" "+d.theme:""),l(h.el,"mousedown",h._onMouseDown,!0),l(h.el,"touchend",h._onMouseDown,!0),l(h.el,"change",h._onChange),d.keyboardInput&&l(r,"keydown",h._onKeyChange),d.field&&(d.container?d.container.appendChild(h.el):d.bound?r.body.appendChild(h.el):d.field.parentNode.insertBefore(h.el,d.field.nextSibling),l(d.field,"change",h._onInputChange),d.defaultDate||(t&&d.field.value?d.defaultDate=e(d.field.value,d.format).toDate():d.defaultDate=new Date(Date.parse(d.field.value)),d.setDefaultDate=!0));var y=d.defaultDate;m(y)?d.setDefaultDate?h.setDate(y,!0):h.gotoDate(y):h.gotoDate(new Date),d.bound?(this.hide(),h.el.className+=" is-bound",l(d.trigger,"click",h._onInputClick),l(d.trigger,"focus",h._onInputFocus),l(d.trigger,"blur",h._onInputBlur)):this.show()};return N.prototype={config:function(e){this._o||(this._o=R({},A,!0));var t=R(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,m(t.minDate)||(t.minDate=!1),m(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),v(t.yearRange)){var r=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||r,t.yearRange[1]=parseInt(t.yearRange[1],10)||r}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||A.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return n=n||this._o.format,m(this._d)?this._o.toString?this._o.toString(this._d,n):t?e(this._d).format(n):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,r){t&&e.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return m(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",E(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),m(e)){var n=this._o.minDate,r=this._o.maxDate;m(n)&&e<n?e=n:m(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),k(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),E(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(m(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=o<n.getTime()||r.getTime()<o}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,r=this.getDate()||new Date,o=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+o):"subtract"===e&&(n=new Date(r.valueOf()-o)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=T(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=T({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(k(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=A.minDate,this._o.minYear=A.minYear,this._o.minMonth=A.minMonth,this._o.startRange=A.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(k(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=A.maxDate,this._o.maxYear=A.maxYear,this._o.maxMonth=A.maxMonth,this._o.endRange=A.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,r=n.minYear,l=n.maxYear,c=n.minMonth,h=n.maxMonth,html="";this._y<=r&&(this._y=r,!isNaN(c)&&this._m<c&&(this._m=c)),this._y>=l&&(this._y=l,!isNaN(h)&&this._m>h&&(this._m=h)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var f=0;f<n.numberOfMonths;f++)html+='<div class="pika-lendar">'+j(this,f,this.calendars[f].year,this.calendars[f].month,this.calendars[0].year,t)+this.render(this.calendars[f].year,this.calendars[f].month,t)+"</div>";this.el.innerHTML=html,n.bound&&"hidden"!==n.field.type&&o((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var e,t,n,o,l,c,h,f,v,m,w,C;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,o=this.el.offsetHeight,l=window.innerWidth||r.documentElement.clientWidth,c=window.innerHeight||r.documentElement.clientHeight,h=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,w=!0,C=!0,"function"==typeof e.getBoundingClientRect)f=(m=e.getBoundingClientRect()).left+window.pageXOffset,v=m.bottom+window.pageYOffset;else for(f=t.offsetLeft,v=t.offsetTop+t.offsetHeight;t=t.offsetParent;)f+=t.offsetLeft,v+=t.offsetTop;(this._o.reposition&&f+n>l||this._o.position.indexOf("right")>-1&&f-n+e.offsetWidth>0)&&(f=f-n+e.offsetWidth,w=!1),(this._o.reposition&&v+o>c+h||this._o.position.indexOf("top")>-1&&v-o-e.offsetHeight>0)&&(v=v-o-e.offsetHeight,C=!1),this.el.style.left=f+"px",this.el.style.top=v+"px",d(this.el,w?"left-aligned":"right-aligned"),d(this.el,C?"bottom-aligned":"top-aligned"),y(this.el,w?"right-aligned":"left-aligned"),y(this.el,C?"top-aligned":"bottom-aligned")}},render:function(e,t,n){var r=this._o,o=new Date,l=S(e,t),c=new Date(e,t,1).getDay(),data=[],h=[];k(o),r.firstDay>0&&(c-=r.firstDay)<0&&(c+=7);for(var f=0===t?11:t-1,d=11===t?0:t+1,y=0===t?e-1:e,v=11===t?e+1:e,C=S(y,f),R=l+c,E=R;E>7;)E-=7;R+=7-E;for(var T=!1,i=0,A=0;i<R;i++){var x=new Date(e,t,i-c+1),I=!!m(this._d)&&O(x,this._d),H=O(x,o),j=-1!==r.events.indexOf(x.toDateString()),N=i<c||i>=l+c,L=i-c+1,B=t,V=e,F=r.startRange&&O(r.startRange,x),W=r.endRange&&O(r.endRange,x),U=r.startRange&&r.endRange&&r.startRange<x&&x<r.endRange;N&&(i<c?(L=C+L,B=f,V=y):(L-=l,B=d,V=v));var z={day:L,month:B,year:V,hasEvent:j,isSelected:I,isToday:H,isDisabled:r.minDate&&x<r.minDate||r.maxDate&&x>r.maxDate||r.disableWeekends&&w(x)||r.disableDayFn&&r.disableDayFn(x),isEmpty:N,isStartRange:F,isEndRange:W,isInRange:U,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&I&&(T=!0),h.push(M(z)),7==++A&&(r.showWeekNumber&&h.unshift(P(i-c,t,e)),data.push(_(h,r.isRTL,r.pickWholeWeek,T)),h=[],A=0,T=!1)}return D(r,data,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),y(this.el,"is-hidden"),this._o.bound&&(l(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&c(r,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",d(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),c(this.el,"mousedown",this._onMouseDown,!0),c(this.el,"touchend",this._onMouseDown,!0),c(this.el,"change",this._onChange),e.keyboardInput&&c(r,"keydown",this._onKeyChange),e.field&&(c(e.field,"change",this._onInputChange),e.bound&&(c(e.trigger,"click",this._onInputClick),c(e.trigger,"focus",this._onInputFocus),c(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},N}(o)}()},892:function(e,t,n){e.exports=function a(e,u,t){function s(r,o){if(!u[r]){if(!e[r]){if(n)return n(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var i=u[r]={exports:{}};e[r][0].call(i.exports,(function(t){return s(e[r][1][t]||t)}),i,i.exports,a,e,u,t)}return u[r].exports}for(var n=!1,r=0;r<t.length;r++)s(t[r]);return s}({1:[function(e,t,n){!function(e){"use strict";var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,l=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,d=14,y=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,w=1e9;function C(e){var t=0|e;return 0<e||e===t?t:t-1}function S(e){for(var t,n,r=1,i=e.length,a=e[0]+"";r<i;){for(t=e[r++]+"",n=d-t.length;n--;t="0"+t);a+=t}for(i=a.length;48===a.charCodeAt(--i););return a.slice(0,i+1||1)}function q(e,t){var n,r,i=e.c,a=t.c,o=e.s,u=t.s,l=e.e,s=t.e;if(!o||!u)return null;if(n=i&&!i[0],r=a&&!a[0],n||r)return n?r?0:-u:o;if(o!=u)return o;if(n=o<0,r=l==s,!i||!a)return r?0:!i^n?1:-1;if(!r)return s<l^n?1:-1;for(u=(l=i.length)<(s=a.length)?l:s,o=0;o<u;o++)if(i[o]!=a[o])return i[o]>a[o]^n?1:-1;return l==s?0:s<l^n?1:-1}function k(e,t,n,r){if(e<t||n<e||e!==(e<0?o(e):l(e)))throw Error(c+(r||"Argument")+("number"==typeof e?e<t||n<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function O(e){var t=e.c.length-1;return C(e.e/d)==t&&e.c[t]%2!=0}function R(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function E(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}(n=function e(t){var n,T,p,A,s,x,u,M,P,g,_=U.prototype={constructor:U,toString:null,valueOf:null},I=new U(1),b=20,H=4,j=-7,D=21,N=-1e7,L=1e7,B=!1,a=1,V=0,F={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz";function U(e,t){var n,o,i,a,c,u,f,s,v=this;if(!(v instanceof U))return new U(e,t);if(null==t){if(e instanceof U)return v.s=e.s,v.e=e.e,void(v.c=(e=e.c)?e.slice():e);if((u="number"==typeof e)&&0*e==0){if(v.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,c=e;10<=c;c/=10,a++);return v.e=a,void(v.c=[e])}s=String(e)}else{if(s=String(e),!r.test(s))return p(v,s,u);v.s=45==s.charCodeAt(0)?(s=s.slice(1),-1):1}-1<(a=s.indexOf("."))&&(s=s.replace(".","")),0<(c=s.search(/e/i))?(a<0&&(a=c),a+=+s.slice(c+1),s=s.substring(0,c)):a<0&&(a=s.length)}else{if(k(t,2,W.length,"Base"),s=String(e),10==t)return Y(v=new U(e instanceof U?e:s),b+v.e+1,H);if(u="number"==typeof e){if(0*e!=0)return p(v,s,u,t);if(v.s=1/e<0?(s=s.slice(1),-1):1,U.DEBUG&&15<s.replace(/^0\.0*|\./,"").length)throw Error(h+e);u=!1}else v.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1;for(n=W.slice(0,t),a=c=0,f=s.length;c<f;c++)if(n.indexOf(o=s.charAt(c))<0){if("."==o){if(a<c){a=f;continue}}else if(!i&&(s==s.toUpperCase()&&(s=s.toLowerCase())||s==s.toLowerCase()&&(s=s.toUpperCase()))){i=!0,c=-1,a=0;continue}return p(v,String(e),u,t)}-1<(a=(s=T(s,t,10,v.s)).indexOf("."))?s=s.replace(".",""):a=s.length}for(c=0;48===s.charCodeAt(c);c++);for(f=s.length;48===s.charCodeAt(--f););if(s=s.slice(c,++f)){if(f-=c,u&&U.DEBUG&&15<f&&(y<e||e!==l(e)))throw Error(h+v.s*e);if(L<(a=a-c-1))v.c=v.e=null;else if(a<N)v.c=[v.e=0];else{if(v.e=a,v.c=[],c=(a+1)%d,a<0&&(c+=d),c<f){for(c&&v.c.push(+s.slice(0,c)),f-=d;c<f;)v.c.push(+s.slice(c,c+=d));s=s.slice(c),c=d-s.length}else c-=f;for(;c--;s+="0");v.c.push(+s)}}else v.c=[v.e=0]}function i(e,t,n,r){var i,a,o,u,l;if(null==n?n=H:k(n,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)l=S(e.c),l=1==r||2==r&&(o<=j||D<=o)?R(l,o):E(l,o,"0");else if(a=(e=Y(new U(e),t,n)).e,u=(l=S(e.c)).length,1==r||2==r&&(t<=a||a<=j)){for(;u<t;l+="0",u++);l=R(l,a)}else if(t-=o,l=E(l,a,"0"),u<a+1){if(0<--t)for(l+=".";t--;l+="0");}else if(0<(t+=a-u))for(a+1==u&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function z(e,t){for(var n,r=1,i=new U(e[0]);r<e.length;r++){if(!(n=new U(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function G(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];10<=i;i/=10,r++);return(n=r+n*d-1)>L?e.c=e.e=null:e.c=n<N?[e.e=0]:(e.e=n,t),e}function Y(e,t,n,r){var i,a,c,u,h,s,y,m=e.c,p=v;if(m){e:{for(i=1,u=m[0];10<=u;u/=10,i++);if((a=t-i)<0)a+=d,c=t,y=(h=m[s=0])/p[i-c-1]%10|0;else if((s=o((a+1)/d))>=m.length){if(!r)break e;for(;m.length<=s;m.push(0));h=y=0,c=(a%=d)-d+(i=1)}else{for(h=u=m[s],i=1;10<=u;u/=10,i++);y=(c=(a%=d)-d+i)<0?0:h/p[i-c-1]%10|0}if(r=r||t<0||null!=m[s+1]||(c<0?h:h%p[i-c-1]),r=n<4?(y||r)&&(0==n||n==(e.s<0?3:2)):5<y||5==y&&(4==n||r||6==n&&(0<a?0<c?h/p[i-c]:0:m[s-1])%10&1||n==(e.s<0?8:7)),t<1||!m[0])return m.length=0,r?(t-=e.e+1,m[0]=p[(d-t%d)%d],e.e=-t||0):m[0]=e.e=0,e;if(0==a?(m.length=s,u=1,s--):(m.length=s+1,u=p[d-a],m[s]=0<c?l(h/p[i-c]%p[c])*u:0),r)for(;;){if(0==s){for(a=1,c=m[0];10<=c;c/=10,a++);for(c=m[0]+=u,u=1;10<=c;c/=10,u++);a!=u&&(e.e++,m[0]==f&&(m[0]=1));break}if(m[s]+=u,m[s]!=f)break;m[s--]=0,u=1}for(a=m.length;0===m[--a];m.pop());}e.e>L?e.c=e.e=null:e.e<N&&(e.c=[e.e=0])}return e}function K(e){var t,n=e.e;return null===n?e.toString():(t=S(e.c),t=n<=j||D<=n?R(t,n):E(t,n,"0"),e.s<0?"-"+t:t)}return U.clone=e,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(c+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(k(n=e[t],0,w,t),b=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(k(n=e[t],0,8,t),H=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(k(n[0],-w,0,t),k(n[1],0,w,t),j=n[0],D=n[1]):(k(n,-w,w,t),j=-(D=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)k(n[0],-w,-1,t),k(n[1],1,w,t),N=n[0],L=n[1];else{if(k(n,-w,w,t),!n)throw Error(c+t+" cannot be zero: "+n);N=-(L=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(c+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw B=!n,Error(c+"crypto unavailable");B=n}else B=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(k(n=e[t],0,9,t),a=n),e.hasOwnProperty(t="POW_PRECISION")&&(k(n=e[t],0,w,t),V=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(c+t+" not an object: "+n);F=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(c+t+" invalid: "+n);W=n}}return{DECIMAL_PLACES:b,ROUNDING_MODE:H,EXPONENTIAL_AT:[j,D],RANGE:[N,L],CRYPTO:B,MODULO_MODE:a,POW_PRECISION:V,FORMAT:F,ALPHABET:W}},U.isBigNumber=function(e){return e instanceof U||e&&!0===e._isBigNumber||!1},U.maximum=U.max=function(){return z(arguments,_.lt)},U.minimum=U.min=function(){return z(arguments,_.gt)},U.random=(A=9007199254740992,s=Math.random()*A&2097151?function(){return l(Math.random()*A)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,i,a,h=0,u=[],f=new U(I);if(null==e?e=b:k(e,0,w),i=o(e/d),B)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));h<i;)9e15<=(a=131072*t[h]+(t[h+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),t[h]=n[0],t[h+1]=n[1]):(u.push(a%1e14),h+=2);h=i/2}else{if(!crypto.randomBytes)throw B=!1,Error(c+"crypto unavailable");for(t=crypto.randomBytes(i*=7);h<i;)9e15<=(a=281474976710656*(31&t[h])+1099511627776*t[h+1]+4294967296*t[h+2]+16777216*t[h+3]+(t[h+4]<<16)+(t[h+5]<<8)+t[h+6])?crypto.randomBytes(7).copy(t,h):(u.push(a%1e14),h+=7);h=i/7}if(!B)for(;h<i;)(a=s())<9e15&&(u[h++]=a%1e14);for(i=u[--h],e%=d,i&&e&&(a=v[d-e],u[h]=l(i/a)*a);0===u[h];u.pop(),h--);if(h<0)u=[r=0];else{for(r=-1;0===u[0];u.splice(0,1),r-=d);for(h=1,a=u[0];10<=a;a/=10,h++);h<d&&(r-=d-h)}return f.e=r,f.c=u,f}),U.sum=function(){for(var e=1,t=arguments,n=new U(t[0]);e<t.length;)n=n.plus(t[e++]);return n},T=function(){var e="0123456789";function t(e,t,n,r){for(var i,a,o=[0],u=0,l=e.length;u<l;){for(a=o.length;a--;o[a]*=t);for(o[0]+=r.indexOf(e.charAt(u++)),i=0;i<o.length;i++)o[i]>n-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/n|0,o[i]%=n)}return o.reverse()}return function(r,o,l,c,i){var a,h,u,f,s,d,y,p,g=r.indexOf("."),v=b,m=H;for(0<=g&&(f=V,V=0,r=r.replace(".",""),d=(p=new U(o)).pow(r.length-g),V=f,p.c=t(E(S(d.c),d.e,"0"),10,l,e),p.e=p.c.length),u=f=(y=t(r,o,l,i?(a=W,e):(a=e,W))).length;0==y[--f];y.pop());if(!y[0])return a.charAt(0);if(g<0?--u:(d.c=y,d.e=u,d.s=c,y=(d=n(d,p,v,m,l)).c,s=d.r,u=d.e),g=y[h=u+v+1],f=l/2,s=s||h<0||null!=y[h+1],s=m<4?(null!=g||s)&&(0==m||m==(d.s<0?3:2)):f<g||g==f&&(4==m||s||6==m&&1&y[h-1]||m==(d.s<0?8:7)),h<1||!y[0])r=s?E(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(y.length=h,s)for(--l;++y[--h]>l;)y[h]=0,h||(++u,y=[1].concat(y));for(f=y.length;!y[--f];);for(g=0,r="";g<=f;r+=a.charAt(y[g++]));r=E(r,u,a.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,a,o,u=0,l=e.length,s=t%m,c=t/m|0;for(e=e.slice();l--;)u=((i=s*(a=e[l]%m)+(r=c*a+(o=e[l]/m|0)*s)%m*m+u)/n|0)+(r/m|0)+c*o,e[l]=i%n;return u&&(e=[u].concat(e)),e}function t(e,t,n,r){var i,a;if(n!=r)a=r<n?1:-1;else for(i=a=0;i<n;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&1<e.length;e.splice(0,1));}return function(r,o,c,h,i){var a,y,u,v,s,m,w,p,g,S,k,O,R,E,b,T,A,x=r.s==o.s?1:-1,M=r.c,P=o.c;if(!(M&&M[0]&&P&&P[0]))return new U(r.s&&o.s&&(M?!P||M[0]!=P[0]:P)?M&&0==M[0]||!P?0*x:x/0:NaN);for(g=(p=new U(x)).c=[],x=c+(y=r.e-o.e)+1,i||(i=f,y=C(r.e/d)-C(o.e/d),x=x/d|0),u=0;P[u]==(M[u]||0);u++);if(P[u]>(M[u]||0)&&y--,x<0)g.push(1),v=!0;else{for(E=M.length,T=P.length,x+=2,1<(s=l(i/(P[u=0]+1)))&&(P=e(P,s,i),M=e(M,s,i),T=P.length,E=M.length),R=T,k=(S=M.slice(0,T)).length;k<T;S[k++]=0);A=P.slice(),A=[0].concat(A),b=P[0],P[1]>=i/2&&b++;do{if(s=0,(a=t(P,S,T,k))<0){if(O=S[0],T!=k&&(O=O*i+(S[1]||0)),1<(s=l(O/b)))for(i<=s&&(s=i-1),w=(m=e(P,s,i)).length,k=S.length;1==t(m,S,w,k);)s--,n(m,T<w?A:P,w,i),w=m.length,a=1;else 0==s&&(a=s=1),w=(m=P.slice()).length;if(w<k&&(m=[0].concat(m)),n(S,m,k,i),k=S.length,-1==a)for(;t(P,S,T,k)<1;)s++,n(S,T<k?A:P,k,i),k=S.length}else 0===a&&(s++,S=[0]);g[u++]=s,S[0]?S[k++]=M[R]||0:(S=[M[R]],k=1)}while((R++<E||null!=S[0])&&x--);v=null!=S[0],g[0]||g.splice(0,1)}if(i==f){for(u=1,x=g[0];10<=x;x/=10,u++);Y(p,c+(p.e=u+y*d-1)+1,h,v)}else p.e=y,p.r=+v;return p}}(),x=/^(-?)0([xbo])(?=\w[\w.]*$)/i,u=/^([^.]+)\.$/,M=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,p=function(e,t,n,r){var i,a=n?t:t.replace(g,"");if(P.test(a))e.s=isNaN(a)?null:a<0?-1:1,e.c=e.e=null;else{if(!n&&(a=a.replace(x,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,a=a.replace(u,"$1").replace(M,"0.$1")),t!=a))return new U(a,i);if(U.DEBUG)throw Error(c+"Not a"+(r?" base "+r:"")+" number: "+t);e.c=e.e=e.s=null}},_.absoluteValue=_.abs=function(){var e=new U(this);return e.s<0&&(e.s=1),e},_.comparedTo=function(e,t){return q(this,new U(e,t))},_.decimalPlaces=_.dp=function(e,t){var n,r,i;if(null!=e)return k(e,0,w),null==t?t=H:k(t,0,8),Y(new U(this),e+this.e+1,t);if(!(n=this.c))return null;if(r=((i=n.length-1)-C(this.e/d))*d,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},_.dividedBy=_.div=function(e,t){return n(this,new U(e,t),b,H)},_.dividedToIntegerBy=_.idiv=function(e,t){return n(this,new U(e,t),0,1)},_.exponentiatedBy=_.pow=function(e,t){var n,r,i,a,h,u,f,s,y=this;if((e=new U(e)).c&&!e.isInteger())throw Error(c+"Exponent not an integer: "+K(e));if(null!=t&&(t=new U(t)),h=14<e.e,!y.c||!y.c[0]||1==y.c[0]&&!y.e&&1==y.c.length||!e.c||!e.c[0])return s=new U(Math.pow(+K(y),h?2-O(e):+K(e))),t?s.mod(t):s;if(u=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new U(NaN);(r=!u&&y.isInteger()&&t.isInteger())&&(y=y.mod(t))}else{if(9<e.e&&(0<y.e||y.e<-1||(0==y.e?1<y.c[0]||h&&24e7<=y.c[1]:y.c[0]<8e13||h&&y.c[0]<=9999975e7)))return a=y.s<0&&O(e)?-0:0,-1<y.e&&(a=1/a),new U(u?1/a:a);V&&(a=o(V/d+2))}for(f=h?(n=new U(.5),u&&(e.s=1),O(e)):(i=Math.abs(+K(e)))%2,s=new U(I);;){if(f){if(!(s=s.times(y)).c)break;a?s.c.length>a&&(s.c.length=a):r&&(s=s.mod(t))}if(i){if(0===(i=l(i/2)))break;f=i%2}else if(Y(e=e.times(n),e.e+1,1),14<e.e)f=O(e);else{if(0==(i=+K(e)))break;f=i%2}y=y.times(y),a?y.c&&y.c.length>a&&(y.c.length=a):r&&(y=y.mod(t))}return r?s:(u&&(s=I.div(s)),t?s.mod(t):a?Y(s,V,H,void 0):s)},_.integerValue=function(e){var t=new U(this);return null==e?e=H:k(e,0,8),Y(t,t.e+1,e)},_.isEqualTo=_.eq=function(e,t){return 0===q(this,new U(e,t))},_.isFinite=function(){return!!this.c},_.isGreaterThan=_.gt=function(e,t){return 0<q(this,new U(e,t))},_.isGreaterThanOrEqualTo=_.gte=function(e,t){return 1===(t=q(this,new U(e,t)))||0===t},_.isInteger=function(){return!!this.c&&C(this.e/d)>this.c.length-2},_.isLessThan=_.lt=function(e,t){return q(this,new U(e,t))<0},_.isLessThanOrEqualTo=_.lte=function(e,t){return-1===(t=q(this,new U(e,t)))||0===t},_.isNaN=function(){return!this.s},_.isNegative=function(){return this.s<0},_.isPositive=function(){return 0<this.s},_.isZero=function(){return!!this.c&&0==this.c[0]},_.minus=function(e,t){var n,r,i,a,o=this,u=o.s;if(t=(e=new U(e,t)).s,!u||!t)return new U(NaN);if(u!=t)return e.s=-t,o.plus(e);var l=o.e/d,s=e.e/d,c=o.c,h=e.c;if(!l||!s){if(!c||!h)return c?(e.s=-t,e):new U(h?o:NaN);if(!c[0]||!h[0])return h[0]?(e.s=-t,e):new U(c[0]?o:3==H?-0:0)}if(l=C(l),s=C(s),c=c.slice(),u=l-s){for((i=(a=u<0)?(u=-u,c):(s=l,h)).reverse(),t=u;t--;i.push(0));i.reverse()}else for(r=(a=(u=c.length)<(t=h.length))?u:t,u=t=0;t<r;t++)if(c[t]!=h[t]){a=c[t]<h[t];break}if(a&&(i=c,c=h,h=i,e.s=-e.s),0<(t=(r=h.length)-(n=c.length)))for(;t--;c[n++]=0);for(t=f-1;u<r;){if(c[--r]<h[r]){for(n=r;n&&!c[--n];c[n]=t);--c[n],c[r]+=f}c[r]-=h[r]}for(;0==c[0];c.splice(0,1),--s);return c[0]?G(e,c,s):(e.s=3==H?-1:1,e.c=[e.e=0],e)},_.modulo=_.mod=function(e,t){var r,o,i=this;return e=new U(e,t),!i.c||!e.s||e.c&&!e.c[0]?new U(NaN):!e.c||i.c&&!i.c[0]?new U(i):(9==a?(o=e.s,e.s=1,r=n(i,e,0,3),e.s=o,r.s*=o):r=n(i,e,0,a),(e=i.minus(r.times(e))).c[0]||1!=a||(e.s=i.s),e)},_.multipliedBy=_.times=function(e,t){var n,r,i,a,o,u,l,s,c,h,p,g,y,v,w,S=this,k=S.c,b=(e=new U(e,t)).c;if(!(k&&b&&k[0]&&b[0]))return!S.s||!e.s||k&&!k[0]&&!b||b&&!b[0]&&!k?e.c=e.e=e.s=null:(e.s*=S.s,k&&b?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=C(S.e/d)+C(e.e/d),e.s*=S.s,(l=k.length)<(h=b.length)&&(y=k,k=b,b=y,i=l,l=h,h=i),i=l+h,y=[];i--;y.push(0));for(v=f,w=m,i=h;0<=--i;){for(n=0,p=b[i]%w,g=b[i]/w|0,a=i+(o=l);i<a;)n=((s=p*(s=k[--o]%w)+(u=g*s+(c=k[o]/w|0)*p)%w*w+y[a]+n)/v|0)+(u/w|0)+g*c,y[a--]=s%v;y[a]=n}return n?++r:y.splice(0,1),G(e,y,r)},_.negated=function(){var e=new U(this);return e.s=-e.s||null,e},_.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new U(e,t)).s,!i||!t)return new U(NaN);if(i!=t)return e.s=-t,r.minus(e);var a=r.e/d,o=e.e/d,u=r.c,l=e.c;if(!a||!o){if(!u||!l)return new U(i/0);if(!u[0]||!l[0])return l[0]?e:new U(u[0]?r:0*i)}if(a=C(a),o=C(o),u=u.slice(),i=a-o){for((n=0<i?(o=a,l):(i=-i,u)).reverse();i--;n.push(0));n.reverse()}for((i=u.length)-(t=l.length)<0&&(n=l,l=u,u=n,t=i),i=0;t;)i=(u[--t]=u[t]+l[t]+i)/f|0,u[t]=f===u[t]?0:u[t]%f;return i&&(u=[i].concat(u),++o),G(e,u,o)},_.precision=_.sd=function(e,t){var n,r,i;if(null!=e&&e!==!!e)return k(e,1,w),null==t?t=H:k(t,0,8),Y(new U(this),e,t);if(!(n=this.c))return null;if(r=(i=n.length-1)*d+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];10<=i;i/=10,r++);}return e&&this.e+1>r&&(r=this.e+1),r},_.shiftedBy=function(e){return k(e,-y,y),this.times("1e"+e)},_.squareRoot=_.sqrt=function(){var e,t,r,o,i,a=this,l=a.c,u=a.s,c=a.e,s=b+4,h=new U("0.5");if(1!==u||!l||!l[0])return new U(!u||u<0&&(!l||l[0])?NaN:l?a:1/0);if((r=0==(u=Math.sqrt(+K(a)))||u==1/0?(((t=S(l)).length+c)%2==0&&(t+="0"),u=Math.sqrt(+t),c=C((c+1)/2)-(c<0||c%2),new U(t=u==1/0?"1e"+c:(t=u.toExponential()).slice(0,t.indexOf("e")+1)+c)):new U(u+"")).c[0])for((u=(c=r.e)+s)<3&&(u=0);;)if(i=r,r=h.times(i.plus(n(a,i,s,1))),S(i.c).slice(0,u)===(t=S(r.c)).slice(0,u)){if(r.e<c&&--u,"9999"!=(t=t.slice(u-3,u+1))&&(o||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Y(r,r.e+b+2,1),e=!r.times(r).eq(a));break}if(!o&&(Y(i,i.e+b+2,0),i.times(i).eq(a))){r=i;break}s+=4,u+=4,o=1}return Y(r,r.e+b+1,H,e)},_.toExponential=function(e,t){return null!=e&&(k(e,0,w),e++),i(this,e,t,1)},_.toFixed=function(e,t){return null!=e&&(k(e,0,w),e=e+this.e+1),i(this,e,t)},_.toFormat=function(e,t,n){var r;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=F;else if("object"!=typeof n)throw Error(c+"Argument not an object: "+n);if(r=this.toFixed(e,t),this.c){var i,a=r.split("."),o=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",s=a[0],h=a[1],f=this.s<0,p=f?s.slice(1):s,g=p.length;if(u&&(i=o,o=u,g-=u=i),0<o&&0<g){for(i=g%o||o,s=p.substr(0,i);i<g;i+=o)s+=l+p.substr(i,o);0<u&&(s+=l+p.slice(i)),f&&(s="-"+s)}r=h?s+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):s}return(n.prefix||"")+r+(n.suffix||"")},_.toFraction=function(e){var t,r,o,i,a,l,u,h,s,f,y,p,g=this,m=g.c;if(null!=e&&(!(u=new U(e)).isInteger()&&(u.c||1!==u.s)||u.lt(I)))throw Error(c+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+K(u));if(!m)return new U(g);for(t=new U(I),s=r=new U(I),o=h=new U(I),p=S(m),a=t.e=p.length-g.e-1,t.c[0]=v[(l=a%d)<0?d+l:l],e=!e||0<u.comparedTo(t)?0<a?t:s:u,l=L,L=1/0,u=new U(p),h.c[0]=0;f=n(u,t,0,1),1!=(i=r.plus(f.times(o))).comparedTo(e);)r=o,o=i,s=h.plus(f.times(i=s)),h=i,t=u.minus(f.times(i=t)),u=i;return i=n(e.minus(r),o,0,1),h=h.plus(i.times(s)),r=r.plus(i.times(o)),h.s=s.s=g.s,y=n(s,o,a*=2,H).minus(g).abs().comparedTo(n(h,r,a,H).minus(g).abs())<1?[s,o]:[h,r],L=l,y},_.toNumber=function(){return+K(this)},_.toPrecision=function(e,t){return null!=e&&k(e,1,w),i(this,e,t,2)},_.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(t=null==e?i<=j||D<=i?R(S(n.c),i):E(S(n.c),i,"0"):10===e?E(S((n=Y(new U(n),b+i+1,H)).c),n.e,"0"):(k(e,2,W.length,"Base"),T(E(S(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},_.valueOf=_.toJSON=function(){return K(this)},_._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(_[Symbol.toStringTag]="BigNumber",_[Symbol.for("nodejs.util.inspect.custom")]=_.valueOf),null!=t&&U.set(t),U}()).default=n.BigNumber=n,void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)},{}],2:[function(e,t,n){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("./globalState"),l=e("./validating"),u=e("./parsing"),c=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],h={general:{scale:1024,suffixes:c,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:c,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof t&&(t=u.parseFormat(t)),!l.validateFormat(t))return"ERROR: invalid format";var r=t.prefix||"",i=t.postfix||"",a=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){var r=n.currentCurrency(),i=Object.assign({},f,t),a=void 0,o="",u=!!i.totalLength||!!i.forceAverage||i.average,l=t.currencyPosition||r.position,s=t.currencySymbol||r.symbol;i.spaceSeparated&&(o=" "),"infix"===l&&(a=o+s+o);var c=v({instance:e,providedFormat:t,state:n,decimalSeparator:a});return"prefix"===l&&(c=e._value<0&&"sign"===i.negative?"-".concat(o).concat(s).concat(c.slice(1)):s+o+c),l&&"postfix"!==l||(c=c+(o=u?"":o)+s),c}(e,t=m(t,o.currentCurrencyDefaultFormat()),o);case"percent":return function(e,t,n,r){var i=t.prefixSymbol,a=v({instance:r(100*e._value),providedFormat:t,state:n}),o=Object.assign({},f,t);return i?"%".concat(o.spaceSeparated?" ":"").concat(a):"".concat(a).concat(o.spaceSeparated?" ":"","%")}(e,t=m(t,o.currentPercentageDefaultFormat()),o,n);case"byte":return t=m(t,o.currentByteDefaultFormat()),C=e,k=o,O=n,R=(S=t).base||"binary",b=h[R],T=(E=d(C._value,b.suffixes,b.scale)).value,A=E.suffix,x=v({instance:O(T),providedFormat:S,state:k,defaults:k.currentByteDefaultFormat()}),M=k.currentAbbreviations(),"".concat(x).concat(M.spaced?" ":"").concat(A);case"time":return t=m(t,o.currentTimeDefaultFormat()),y=e,w=Math.floor(y._value/60/60),p=Math.floor((y._value-60*w*60)/60),g=Math.round(y._value-60*w*60-60*p),"".concat(w,":").concat(p<10?"0":"").concat(p,":").concat(g<10?"0":"").concat(g);case"ordinal":return r=e,i=t=m(t,o.currentOrdinalDefaultFormat()),l=(a=o).currentOrdinal(),u=Object.assign({},f,i),c=v({instance:r,providedFormat:i,state:a}),s=l(r._value),"".concat(c).concat(u.spaceSeparated?" ":"").concat(s);default:return v({instance:e,providedFormat:t,numbro:n})}var r,i,a,l,u,c,s,y,w,p,g,C,S,k,O,R,b,E,T,A,x,M}(e,t,n);return(a=r+a)+i}function d(e,t,n){var r=t[0],i=Math.abs(e);if(n<=i){for(var a=1;a<t.length;++a){var o=Math.pow(n,a),u=Math.pow(n,a+1);if(o<=i&&i<u){r=t[a],e/=o;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function p(e){for(var t="",n=0;n<e;n++)t+="0";return t}function y(e,t){return-1!==e.toString().indexOf("e")?function(e,t){var n=e.toString(),o=r(n.split("e"),2),i=o[0],a=o[1],l=r(i.split("."),2),u=l[0],c=l[1],s=void 0===c?"":c;if(0<+a)n=u+s+p(a-s.length);else{var h=".";h=+u<0?"-0".concat(h):"0".concat(h);var f=(p(-a-1)+Math.abs(u)+s).substr(0,t);f.length<t&&(f+=p(t-f.length)),n=h+f}return 0<+a&&0<t&&(n+=".".concat(p(t))),n}(e,t):(Math.round(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function v(e){var t=e.instance,n=e.providedFormat,l=e.state,i=void 0===l?o:l,a=e.decimalSeparator,c=e.defaults,u=void 0===c?i.currentDefaults():c,h=t._value;if(0===h&&i.hasZeroFormat())return i.getZeroFormat();if(!isFinite(h))return h.toString();var s,d,v,p,g,m,w,C,S=Object.assign({},f,u,n),k=S.totalLength,b=k?0:S.characteristic,O=S.optionalCharacteristic,R=S.forceAverage,E=!!k||!!R||S.average,T=k?-1:E&&void 0===n.mantissa?0:S.mantissa,A=!k&&(void 0===n.optionalMantissa?-1===T:S.optionalMantissa),x=S.trimMantissa,M=S.thousandSeparated,P=S.spaceSeparated,_=S.negative,I=S.forceSign,H=S.exponential,j="";if(E){var D=function(e){var t=e.value,n=e.forceAverage,r=e.abbreviations,i=e.spaceSeparated,a=void 0!==i&&i,o=e.totalLength,u=void 0===o?0:o,l="",s=Math.abs(t),c=-1;if(s>=Math.pow(10,12)&&!n||"trillion"===n?(l=r.trillion,t/=Math.pow(10,12)):s<Math.pow(10,12)&&s>=Math.pow(10,9)&&!n||"billion"===n?(l=r.billion,t/=Math.pow(10,9)):s<Math.pow(10,9)&&s>=Math.pow(10,6)&&!n||"million"===n?(l=r.million,t/=Math.pow(10,6)):(s<Math.pow(10,6)&&s>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=r.thousand,t/=Math.pow(10,3)),l&&(l=(a?" ":"")+l),u){var h=t.toString().split(".")[0];c=Math.max(u-h.length,0)}return{value:t,abbreviation:l,mantissaPrecision:c}}({value:h,forceAverage:R,abbreviations:i.currentAbbreviations(),spaceSeparated:P,totalLength:k});h=D.value,j+=D.abbreviation,k&&(T=D.mantissaPrecision)}if(H){var N=(d=(s={value:h,characteristicPrecision:b}).value,p=void 0===(v=s.characteristicPrecision)?0:v,m=(g=r(d.toExponential().split("e"),2))[0],w=g[1],C=+m,p&&1<p&&(C*=Math.pow(10,p-1),w=0<=(w=+w-(p-1))?"+".concat(w):w),{value:C,abbreviation:"e".concat(w)});h=N.value,j=N.abbreviation+j}var L,B,V,F=function(e,t,n,o,i){if(-1===o)return e;var a=y(t,o),l=r(a.toString().split("."),2),u=l[0],c=l[1],s=void 0===c?"":c;if(s.match(/^0+$/)&&(n||i))return u;var h=s.match(/0+$/);return i&&h?"".concat(u,".").concat(s.toString().slice(0,h.index)):a.toString()}(h.toString(),h,A,T,x);return F=function(e,t,n,r,i){var a=r.currentDelimiters(),o=a.thousands;i=i||a.decimal;var u=a.thousandsSize||3,l=e.toString(),s=l.split(".")[0],c=l.split(".")[1];return n&&(t<0&&(s=s.slice(1)),function(e,t){for(var n=[],r=0,i=e;0<i;i--)r===t&&(n.unshift(i),r=0),r++;return n}(s.length,u).forEach((function(e,t){s=s.slice(0,e+t)+o+s.slice(e+t)})),t<0&&(s="-".concat(s))),c?s+i+c:s}(F=function(e,t,n,o){var i=e,a=r(i.toString().split("."),2),l=a[0],u=a[1];if(l.match(/^-?0$/)&&n)return u?"".concat(l.replace("0",""),".").concat(u):l.replace("0","");if(l.length<o)for(var c=o-l.length,s=0;s<c;s++)i="0".concat(i);return i.toString()}(F,0,O,b),h,M,i,a),(E||H)&&(F+=j),(I||h<0)&&(L=F,V=_,F=0===(B=h)?L:0==+L?L.replace("-",""):0<B?"+".concat(L):"sign"===V?L:"(".concat(L.replace("-",""),")")),F}function m(e,t){if(!e)return t;var n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}t.exports=function(e){return{format:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.apply(void 0,n.concat([e]))},getByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){var t=h.general;return d(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getBinaryByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){var t=h.binary;return d(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},getDecimalByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){var t=h.decimal;return d(e._value,t.suffixes,t.scale).suffix}.apply(void 0,n.concat([e]))},formatOrDefault:m}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,n){"use strict";var i=e("./en-US"),r=e("./validating"),a=e("./parsing"),o={},u=void 0,l={},s=null,c={};function h(e){u=e}function p(){return l[u]}o.languages=function(){return Object.assign({},l)},o.currentLanguage=function(){return u},o.currentCurrency=function(){return p().currency},o.currentAbbreviations=function(){return p().abbreviations},o.currentDelimiters=function(){return p().delimiters},o.currentOrdinal=function(){return p().ordinal},o.currentDefaults=function(){return Object.assign({},p().defaults,c)},o.currentOrdinalDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().ordinalFormat)},o.currentByteDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().byteFormat)},o.currentPercentageDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().percentageFormat)},o.currentCurrencyDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().currencyFormat)},o.currentTimeDefaultFormat=function(){return Object.assign({},o.currentDefaults(),p().timeFormat)},o.setDefaults=function(e){e=a.parseFormat(e),r.validateFormat(e)&&(c=e)},o.getZeroFormat=function(){return s},o.setZeroFormat=function(e){return s="string"==typeof e?e:null},o.hasZeroFormat=function(){return null!==s},o.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'.concat(e,'"'))}return p()},o.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!r.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&h(e.languageTag)},o.setLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!l[e]){var n=e.split("-")[0],r=Object.keys(l).find((function(e){return e.split("-")[0]===n}));return l[r]?void h(r):void h(t)}h(e)},o.registerLanguage(i),u=i.languageTag,t.exports=o},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,t,n){"use strict";t.exports=function(t){return{loadLanguagesInNode:function(n){return r=t,void n.forEach((function(t){var n=void 0;try{n=e("../languages/".concat(t))}catch(n){console.error('Unable to load "'.concat(t,'". No matching language file found.'))}n&&r.registerLanguage(n)}));var r}}}},{}],6:[function(e,t,n){"use strict";var r=e("bignumber.js");function a(e,t,n){var o=new r(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new r(i),e._value=o.minus(i).toNumber(),e}t.exports=function(u){return{add:function(e,t){return o=t,i=u,a=new r((n=e)._value),l=o,i.isNumbro(o)&&(l=o._value),l=new r(l),n._value=a.plus(l).toNumber(),n;var n,o,i,a,l},subtract:function(e,t){return a(e,t,u)},multiply:function(e,t){return o=t,i=u,a=new r((n=e)._value),l=o,i.isNumbro(o)&&(l=o._value),l=new r(l),n._value=a.times(l).toNumber(),n;var n,o,i,a,l},divide:function(e,t){return o=t,i=u,a=new r((n=e)._value),l=o,i.isNumbro(o)&&(l=o._value),l=new r(l),n._value=a.dividedBy(l).toNumber(),n;var n,o,i,a,l},set:function(e,t){return n=e,i=r=t,u.isNumbro(r)&&(i=r._value),n._value=i,n;var n,r,i},difference:function(e,t){return n=t,a(i=(r=u)(e._value),n,r),Math.abs(i._value);var n,r,i}}}},{"bignumber.js":1}],7:[function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=e("./globalState"),r=e("./validating"),o=e("./loading")(g),u=e("./unformatting"),l=e("./formatting")(g),s=e("./manipulating")(g),c=e("./parsing"),h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=t}var t,n,r;return t=e,(n=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=c.parseFormat(e)),(e=l.formatOrDefault(e,a.currentCurrencyDefaultFormat())).output="currency",l.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",l.format(this,e)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(e){return s.difference(this,e)}},{key:"add",value:function(e){return s.add(this,e)}},{key:"subtract",value:function(e){return s.subtract(this,e)}},{key:"multiply",value:function(e){return s.multiply(this,e)}},{key:"divide",value:function(e){return s.divide(this,e)}},{key:"set",value:function(e){return s.set(this,p(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(t.prototype,n),r&&i(t,r),e}();function p(e){var t=e;return g.isNumbro(e)?t=e._value:"string"==typeof e?t=g.unformat(e):isNaN(e)&&(t=NaN),t}function g(e){return new h(p(e))}g.version="2.1.2",g.isNumbro=function(e){return e instanceof h},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=r.validate,g.loadLanguagesInNode=o.loadLanguagesInNode,g.unformat=u.unformat,t.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,n){"use strict";t.exports={parseFormat:function(e){var t,n,r,i,a,o,u,l,s,c,h,p,g,f,d,y,v,m,b,w,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(n=C,a=C,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(o=(i=e=(r=(t=e).match(/^{([^}]*)}/))?(n.prefix=r[1],t.slice(r[0].length)):t).match(/{([^}]*)}$/))?(a.postfix=o[1],i.slice(0,-o[0].length)):i,C),u=C,(l=e.match(/[1-9]+[0-9]*/))&&(u.totalLength=+l[0]),s=C,(c=e.split(".")[0].match(/0+/))&&(s.characteristic=c[0].length),function(e,t){if(-1!==e.indexOf(".")){var n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,C),h=C,-1!==e.indexOf("a")&&(h.average=!0),g=C,-1!==(p=e).indexOf("K")?g.forceAverage="thousand":-1!==p.indexOf("M")?g.forceAverage="million":-1!==p.indexOf("B")?g.forceAverage="billion":-1!==p.indexOf("T")&&(g.forceAverage="trillion"),function(e,t){var n=e.split(".")[1];if(n){var r=n.match(/0+/);r&&(t.mantissa=r[0].length)}}(e,C),d=C,(f=e).match(/\[\.]/)?d.optionalMantissa=!0:f.match(/\./)&&(d.optionalMantissa=!1),y=C,-1!==e.indexOf(",")&&(y.thousandSeparated=!0),v=C,-1!==e.indexOf(" ")&&(v.spaceSeparated=!0),b=C,(m=e).match(/^\+?\([^)]*\)$/)&&(b.negative="parenthesis"),m.match(/^\+?-/)&&(b.negative="sign"),w=C,e.match(/^\+/)&&(w.forceSign=!0),C)}}},{}],9:[function(p,e,t){"use strict";var n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function r(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function g(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",l=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,c=6<arguments.length?arguments[6]:void 0;if(""!==e)return e===i?0:function e(t,o){var l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,c=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var h="",s=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(s!==t)return-1*e(s,o,l,i,a,c,u);for(var f=0;f<n.length;f++){var d=n[f];if((h=t.replace(d.key,""))!==t)return e(h,o,l,i,a,c,u)*d.factor}if((h=t.replace("%",""))!==t)return e(h,o,l,i,a,c,u)/100;var p=parseFloat(t);if(!isNaN(p)){var g=i(p);if(g&&"."!==g&&(h=t.replace(new RegExp("".concat(r(g),"$")),""))!==t)return e(h,o,l,i,a,c,u);var y={};Object.keys(c).forEach((function(e){y[c[e]]=e}));for(var v=Object.keys(y).sort().reverse(),m=v.length,w=0;w<m;w++){var C=v[w],b=y[C];if((h=t.replace(C,""))!==t){var S=void 0;switch(b){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return e(h,o,l,i,a,c,u)*S}}}}(function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=e.replace(n,"");return(o=o.replace(new RegExp("([0-9])".concat(r(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,o),t,o,l,i,a,c)}e.exports={unformat:function(e,t){var n,r,i,a=p("./globalState"),o=a.currentDelimiters(),u=a.currentCurrency().symbol,l=a.currentOrdinal(),s=a.getZeroFormat(),c=a.currentAbbreviations(),h=void 0;if("string"==typeof e)h=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;var n=e.split(":");if(3!==n.length)return!1;var r=+n[0],i=+n[1],a=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(a)}(e,o)?(r=+(n=e.split(":"))[0],i=+n[1],+n[2]+60*i+3600*r):g(e,o,u,l,s,c,t);else{if("number"!=typeof e)return;h=e}if(void 0!==h)return h}}},{"./globalState":4}],10:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=e("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,p={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function u(e){return!!i.unformat(e)}function g(e,s,t){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],l=Object.keys(e).map((function(n){if(!s[n])return console.error("".concat(t," Invalid key: ").concat(n)),!1;var r=e[n],l=s[n];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!g(r,p,"[Validate ".concat(n,"]"),!0))return!1}else if(o(r)!==l.type)return console.error("".concat(t," ").concat(n,' type mismatched: "').concat(l.type,'" expected, "').concat(o(r),'" provided')),!1;if(l.restrictions&&l.restrictions.length)for(var c=l.restrictions.length,i=0;i<c;i++){var a=l.restrictions[i],h=a.restriction,u=a.message;if(!h(r,e))return console.error("".concat(t," ").concat(n," invalid value: ").concat(u)),!1}return l.restriction&&!l.restriction(r,e)?(console.error("".concat(t," ").concat(n," invalid value: ").concat(l.message)),!1):l.validValues&&-1===l.validValues.indexOf(r)?(console.error("".concat(t," ").concat(n," invalid value: must be among ").concat(JSON.stringify(l.validValues),', "').concat(r,'" provided')),!1):!(l.children&&!g(r,l.children,"[Validate ".concat(n,"]")))}));return n||l.push.apply(l,r(Object.keys(s).map((function(n){var r=s[n];if("string"==typeof r&&(r={type:r}),r.mandatory){var o=r.mandatory;if("function"==typeof o&&(o=o(e)),o&&void 0===e[n])return console.error("".concat(t,' Missing mandatory key "').concat(n,'"')),!1}return!0})))),l.reduce((function(e,t){return e&&t}),!0)}function c(e){return g(e,p,"[Validate format]")}t.exports={validate:function(e,t){var n=u(e),r=c(t);return n&&r},validateFormat:c,validateInput:u,validateLanguage:function(e){return g(e,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},912:function(e,t,n){var r=n(16)(!1);r.push([e.i,'@charset "UTF-8";\n/*!\n * Copyright (c) HANDSONCODE sp. z o. o.\n * \n * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in\n * Gdynia, Poland, at Aleja Zwycięstwa 96-98, registered by the District Court in Gdansk under number\n * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.\n * \n * This software is protected by applicable copyright laws, including international treaties, and dual-\n * licensed – depending on whether your use for commercial purposes, meaning intended for or\n * resulting in commercial advantage or monetary compensation, or not.\n * \n * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing\n * the suitability, performance, and usefulness of this software outside the production environment,\n * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.\n * \n * Your use of this software for commercial purposes is subject to the terms included in an applicable\n * license agreement.\n * \n * In any case, you must not make any such use of this software as to develop software which may be\n * considered competitive with this software.\n * \n * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN &quot;AS IS&quot;\n * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO\n * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,\n * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM\n * USE OR INABILITY TO USE THIS SOFTWARE.\n * \n * Version: 12.0.1\n * Release date: 16/05/2022 (built at 13/05/2022 13:50:27)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-md-1.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{position:relative;width:0;height:auto}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:0}.handsontable table.htCore{border-collapse:separate;border-spacing:0;margin:0;border-width:0;table-layout:fixed;width:0;outline-width:0;cursor:default;max-width:none;max-height:none}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{border-top-width:0;border-left-width:0;border-right:1px solid #ccc;border-bottom:1px solid #ccc;height:22px;empty-cells:show;line-height:21px;padding:0 4px;background-color:#fff;vertical-align:top;overflow:hidden;outline-width:0;white-space:pre-wrap}[dir=rtl].handsontable td,[dir=rtl].handsontable th{border-right-width:0;border-left:1px solid #ccc}.handsontable th:last-child{border-left:none;border-right:1px solid #ccc;border-bottom:1px solid #ccc}[dir=rtl].handsontable th:last-child{border-right:none;border-left:1px solid #ccc}.handsontable td:first-of-type,.handsontable th:first-child,.handsontable th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child,[dir=rtl].handsontable th:nth-child(2){border-right:1px solid #ccc}.handsontable .ht_clone_top th:nth-child(2){border-left-width:0;border-right:1px solid #ccc}[dir=rtl].handsontable .ht_clone_top th:nth-child(2){border-right-width:0;border-left:1px solid #ccc}.handsontable.htRowHeaders thead tr th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2){border-right:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th{border-right-width:0;border-left:1px solid #ccc}[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top) thead tr th:first-child,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable tbody tr th{border-left-width:0;border-right:1px solid #ccc}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;text-align:center;font-weight:400;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{position:absolute;font-size:0}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{font-size:0;cursor:crosshair}.ht_clone_master{z-index:100}.ht_clone_inline_start{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_inline_start_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_inline_start_corner{z-index:180}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_inline_start thead,.handsontable .ht_master thead,.handsontable .ht_master tr th{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{touch-action:manipulation;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:13px;font-weight:400;color:#373737}.handsontable a{color:#104acc}.handsontable.htAutoSize{visibility:hidden;left:-99000px;position:absolute;top:-99000px}.handsontable td.htInvalid{background-color:#ff4c42!important}.handsontable td.htNoWrap{white-space:nowrap}#hot-display-license-info{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Helvetica Neue",Arial,sans-serif;font-size:10px;font-weight:400;color:#373737;padding:5px 0 3px;text-align:left}#hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .manualColumnResizer{position:absolute;top:0;cursor:col-resize;z-index:210;width:5px;height:25px}.handsontable .manualRowResizer{position:absolute;left:0;cursor:row-resize;z-index:210;height:5px;width:50px}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{position:absolute;right:unset;top:0;background-color:#34a9db;display:none;width:0;border-right:1px dashed #777;border-left:none;margin-left:5px;margin-right:unset}[dir=rtl].handsontable .manualColumnResizerGuide{left:unset;border-left:1px dashed #777;border-right:none;margin-right:5px;margin-left:unset}.handsontable .manualRowResizerGuide{position:absolute;left:0;bottom:0;background-color:#34a9db;display:none;height:0;border-bottom:1px dashed #777;margin-top:5px}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable .columnSorting{position:relative}.handsontable .columnSorting.sortAction:hover{text-decoration:underline;cursor:pointer}.handsontable span.colHeader.columnSorting:before{top:50%;margin-top:-6px;padding-left:8px;padding-right:0;position:absolute;right:-9px;left:unset;content:"";height:10px;width:5px;background-size:contain;background-repeat:no-repeat;background-position-x:right}[dir=rtl].handsontable span.colHeader.columnSorting:before{padding-right:8px;padding-left:0;left:-9px;right:unset;background-position-x:left}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC")}.handsontable span.colHeader.columnSorting.descending:before{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=")}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):after{content:"*";display:inline-block;position:relative;padding-right:20px}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;bottom:-100%\\9;background:#005eff}@media (-ms-high-contrast:none),screen and (-ms-high-contrast:active){.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{bottom:-100%}}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{border:none;outline-width:0;margin:0;padding:1px 5px 0;font-family:inherit;line-height:21px;font-size:inherit;box-shadow:inset 0 0 0 2px #5292f7;resize:none;display:block;color:#000;border-radius:0;background-color:#fff}.handsontableInput:focus{outline:none}.handsontableInputHolder{position:absolute;top:0;left:0}.htSelectEditor{-webkit-appearance:menulist-button!important;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{content:"▶";color:#777;position:absolute;right:5px;font-size:9px}[dir=rtl].handsontable .htSubmenu :after{content:""}[dir=rtl].handsontable .htSubmenu :before{content:"◀";color:#777;position:absolute;left:5px;font-size:9px}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{border:1px solid #ccc;border-collapse:separate;background:#fff}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent!important}.handsontable.listbox td,.handsontable.listbox th{white-space:nowrap;text-overflow:ellipsis}.handsontable.listbox td.htDimmed{cursor:default;color:inherit;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr:hover td,.handsontable.listbox tr td.current{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.handsontable .collapsibleIndicator{position:absolute;top:50%;transform:translateY(-50%);left:unset;right:5px;border:1px solid #a6a6a6;line-height:8px;color:#222;border-radius:10px;font-size:10px;width:10px;height:10px;cursor:pointer;box-shadow:0 0 0 6px #eee;background:#eee;text-align:center}[dir=rtl].handsontable .collapsibleIndicator{right:unset;left:5px}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.handsontable.mobile .handsontableInput:focus{box-shadow:inset 0 0 0 2px #5292f7;-webkit-appearance:none}.topSelectionHandle-HitArea:not(.ht_master .topSelectionHandle-HitArea),.topSelectionHandle:not(.ht_master .topSelectionHandle){z-index:9999}.bottomSelectionHandle,.bottomSelectionHandle-HitArea,.topSelectionHandle,.topSelectionHandle-HitArea{left:-10000px;top:-10000px}.handsontable.hide-tween{-webkit-animation:opacity-hide .3s;animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:opacity-show .3s;animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}\n/*!\n * Pikaday\n * Copyright © 2014 David Bushell | BSD & MIT license | https://dbushell.com/\n */.pika-single{z-index:9999;display:block;position:relative;color:#333;background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single{*zoom:1}.pika-single.is-hidden{display:none}.pika-single.is-bound{position:absolute;box-shadow:0 5px 15px -5px rgba(0,0,0,.5)}.pika-lendar{float:left;width:240px;margin:8px}.pika-title{position:relative;text-align:center}.pika-label{display:inline-block;*display:inline;position:relative;z-index:9999;overflow:hidden;margin:0;padding:5px 3px;font-size:14px;line-height:20px;font-weight:700;background-color:#fff}.pika-title select{cursor:pointer;position:absolute;z-index:9998;margin:0;left:0;top:5px;filter:alpha(opacity=0);opacity:0}.pika-next,.pika-prev{display:block;cursor:pointer;position:relative;outline:none;border:0;padding:0;width:20px;height:30px;text-indent:20px;white-space:nowrap;overflow:hidden;background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;opacity:.5;*position:absolute;*top:0}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{float:left;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==");*left:0}.is-rtl .pika-prev,.pika-next{float:right;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=");*right:0}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block;*display:inline}.pika-table{width:100%;border-collapse:collapse;border-spacing:0;border:0}.pika-table td,.pika-table th{width:14.2857142857%;padding:0}.pika-table th{color:#999;font-size:12px;line-height:25px;font-weight:700;text-align:center}.pika-button{cursor:pointer;display:block;box-sizing:border-box;-moz-box-sizing:border-box;outline:none;border:0;margin:0;width:100%;padding:5px;color:#666;font-size:12px;line-height:15px;text-align:right;background:#f5f5f5}.pika-week{font-size:11px;color:#999}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{color:#fff;font-weight:700;background:#3af;box-shadow:inset 0 1px 3px #178fe5;border-radius:3px}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{color:#fff;background:#6cb31d;box-shadow:none;border-radius:3px}.is-endrange .pika-button{color:#fff;background:#3af;box-shadow:none;border-radius:3px}.is-disabled .pika-button{pointer-events:none;cursor:default;color:#999;opacity:.3}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{pointer-events:none;cursor:default}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{color:#fff;background:#ff8000;box-shadow:none;border-radius:3px}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{float:right;font-size:10px;color:#eee;cursor:default;width:16px;text-align:center}[dir=rtl].handsontable .htAutocompleteArrow{float:left}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{font-size:inherit;vertical-align:middle;cursor:pointer;display:inline-block}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.handsontable .htCommentCell{position:relative}.handsontable .htCommentCell:after{content:"";position:absolute;top:0;right:0;left:unset;border-left:6px solid transparent;border-right:none;border-top:6px solid #000}[dir=rtl].handsontable .htCommentCell:after{left:0;right:unset;border-right:6px solid transparent;border-left:none}.htCommentsContainer .htComments{display:none;z-index:1059;position:absolute}.htCommentsContainer .htCommentTextArea{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216);box-sizing:border-box;border:none;border-left:3px solid #ccc;background-color:#fff;width:215px;height:90px;font-size:12px;padding:5px;outline:0!important;-webkit-appearance:none}[dir=rtl].htCommentsContainer .htCommentTextArea{border-right:3px solid #ccc;border-left:none}.htCommentsContainer .htCommentTextArea:focus{box-shadow:0 1px 3px rgba(0,0,0,.117647),0 1px 2px rgba(0,0,0,.239216),inset 0 0 0 1px #5292f7;border-left:3px solid #5292f7;border-right:none}[dir=rtl].htCommentsContainer .htCommentTextArea:focus{border-right:3px solid #5292f7;border-left:none}\n/*!\n * Handsontable ContextMenu\n */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htContextMenu .ht_master table.htCore{border-right-width:1px;border-left-width:2px}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htContextMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htContextMenu table tbody tr td:first-child{border-right-width:0;border-left-width:0}.htContextMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htContextMenu table tbody tr td.current,.htContextMenu table tbody tr td.zeroclipboard-is-hover{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}.htContextMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{position:fixed!important;top:0!important;right:100%!important;overflow:hidden;opacity:0;outline:0 none!important}\n/*!\n * Handsontable DropdownMenu\n */.handsontable .changeType{background:#eee;border-radius:2px;border:1px solid #bbb;color:#bbb;font-size:9px;line-height:9px;padding:2px;margin:3px 1px 0 5px;float:right}[dir=rtl].handsontable .changeType{float:left}.handsontable .changeType:before{content:"▼ "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner{display:none}.htDropdownMenu table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htDropdownMenu table.htCore{border-right-width:1px;border-left-width:2px}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htDropdownMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htDropdownMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htDropdownMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htDropdownMenu table tbody tr td.current,.htDropdownMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0;cursor:default}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}\n/*!\n * Handsontable Filters\n */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;padding:4px 6px 0;cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.htFiltersConditionsMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{font-style:normal;color:#323232}.htFiltersConditionsMenu table tbody tr td.current,.htFiltersConditionsMenu table tbody tr td.zeroclipboard-is-hover{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{margin-top:-2px;position:absolute;left:4px}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{text-align:center;padding-top:10px;padding-bottom:3px}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{font-family:inherit;font-size:.75em;padding:4px;box-sizing:border-box;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{border:1px solid #509272;color:#18804e;background-color:#d2e0d9}.handsontable .htUISelectAll{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUISelectAll{margin-right:0;margin-left:10px}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}[dir=rtl].handsontable .htUISelectionControls{text-align:left}.handsontable .htCheckboxRendererInput{margin:0 5px 0 0;vertical-align:middle;height:1em}[dir=rtl].handsontable .htCheckboxRendererInput{margin-left:5px;margin-right:0}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border-radius:2px;border:1px solid #d2d1d1}.handsontable .htUIInput input:focus{outline:0}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUIInput.htUIButtonOK{margin-right:0;margin-left:10px}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border-radius:2px;border:1px solid #d2d1d1;font-family:inherit;font-size:.75em;font-weight:700;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"▲";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"▼";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border-radius:2px;border:1px solid #d2d1d1;padding:3px}.handsontable .htUIRadio{display:inline-block;margin-left:0;margin-right:5px;height:100%}[dir=rtl].handsontable .htUIRadio{margin-right:0;margin-left:5px}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-left:0;margin-right:.5ex}[dir=rtl].handsontable .htUIRadio>input[type=radio]{margin-right:0;margin-left:.5ex}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;position:absolute;top:50%;font-size:5pt;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable th.beforeHiddenColumn:after{right:1px;content:"◀"}[dir=rtl].handsontable th.beforeHiddenColumn:after{right:auto;left:1px;content:"▶"}.handsontable th.afterHiddenColumn:before{left:1px;content:"▶"}[dir=rtl].handsontable th.afterHiddenColumn:before{right:1px;left:auto;content:"◀"}\n/*!\n * Handsontable HiddenRows\n */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;line-height:6pt;position:absolute;left:2px}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{content:"▲";bottom:2px}.handsontable th.afterHiddenRow:after{content:"▼";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{position:absolute;height:100%;display:none}[dir=ltr] .handsontable .ht__manualColumnMove--guideline{margin-left:-1px}[dir=rtl] .handsontable .ht__manualColumnMove--guideline{margin-right:-1px}[dir=ltr] .handsontable .ht__manualColumnMove--guideline{margin-right:0}[dir=rtl] .handsontable .ht__manualColumnMove--guideline{margin-left:0}.handsontable .ht__manualColumnMove--guideline{background:#757575;width:2px;top:0;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{position:absolute;width:100%;display:none}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;z-index:205;pointer-events:none}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable span.colHeader.columnSorting:after{top:50%;margin-top:-2px;position:absolute;right:-15px;left:unset;padding-left:5px;padding-right:unset;font-size:8px;height:8px;line-height:1.1;text-decoration:underline}[dir=rtl].handsontable span.colHeader.columnSorting:after{left:-15px;right:unset;padding-right:5px;padding-left:unset}.handsontable span.colHeader.columnSorting:after{text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{text-align:left;padding-left:7px}[dir=rtl].handsontable th.ht_nestingLevels{text-align:right;padding-right:7px}.handsontable th div.ht_nestingLevels{display:inline-block;position:absolute;left:11px;right:unset}[dir=rtl].handsontable th div.ht_nestingLevels{right:11px;left:unset}.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{right:10px;left:unset}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:10px;right:unset}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;width:10px;height:1px;float:left}[dir=rtl].handsontable th span.ht_nestingLevel_empty{float:right}.handsontable th span.ht_nestingLevel:after{content:"┐";font-size:9px;display:inline-block;position:relative;bottom:3px}.handsontable th div.ht_nestingButton{display:inline-block;position:absolute;right:-2px;left:unset;cursor:pointer}[dir=rtl].handsontable th div.ht_nestingButton{left:-2px;right:unset}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"+"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"-"}.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{right:0;left:unset}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:0;right:unset}',""]),e.exports=r}}]);